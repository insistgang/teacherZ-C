# Detecting Closer Surfaces via Convex Optimization
> **å¯è§è¡¨é¢æ£€æµ‹çš„å‡¸ä¼˜åŒ–æ–¹æ³•**
> **è¶…ç²¾è¯»ç¬”è®°** | 5-Agentè¾©è®ºåˆ†æç³»ç»Ÿ
> åˆ†ææ—¶é—´ï¼š2026-02-16
> æ¥æºï¼šIEEE TIP 2016

---

## ğŸ“„ è®ºæ–‡å…ƒä¿¡æ¯

| å±æ€§ | ä¿¡æ¯ |
|------|------|
| **æ ‡é¢˜** | Detecting Closer Surfaces via Convex Optimization |
| **ä½œè€…** | Xiaohao Cai, et al. |
| **å¹´ä»½** | 2016 |
| **æœŸåˆŠ** | IEEE Transactions on Image Processing |
| **å·æœŸ** | Vol. 25, No. 10, pp. 4489-4503 |
| **DOI** | 10.1109/TIP.2016.2585479 |
| **å…³é”®è¯** | å¤šå±‚è¡¨é¢æ£€æµ‹ã€é¡ºåºçº¦æŸã€å‡¸ä¼˜åŒ–ã€è§†ç½‘è†œOCTã€è¿ç»­å‡½æ•°è¡¨ç¤º |

### ğŸ“ æ‘˜è¦ç¿»è¯‘

æœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºå‡¸ä¼˜åŒ–çš„å¤šå±‚è¡¨é¢æ£€æµ‹æ–¹æ³•ï¼Œç”¨äºå¤„ç†è§†ç½‘è†œOCTç­‰åŒ»å­¦å›¾åƒä¸­çš„åˆ†å±‚ç»“æ„æ£€æµ‹é—®é¢˜ã€‚ä¼ ç»Ÿæ–¹æ³•å°†æ£€æµ‹è§†ä¸ºåƒç´ çº§åˆ†ç±»é—®é¢˜ï¼Œå¿½ç•¥äº†è¡¨é¢çš„è¿ç»­æ€§å’Œå±‚é—´é¡ºåºçº¦æŸã€‚æˆ‘ä»¬å¼•å…¥è¿ç»­å‡½æ•°è¡¨ç¤º $y = s_k(x)$ æ¥å»ºæ¨¡æ¯ä¸ªè¡¨é¢ï¼Œå¹¶æ–½åŠ ç¡¬çº¦æŸä¿è¯å±‚é—´é¡ºåº $s_1(x) < s_2(x) < ... < s_K(x)$ å’Œè·ç¦»çº¦æŸ $d_{min} < s_{k+1}(x) - s_k(x) < d_{max}$ã€‚è¯¥é—®é¢˜è¢«å»ºæ¨¡ä¸ºå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œä¿è¯å…¨å±€æœ€ä¼˜è§£ã€‚å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨è§†ç½‘è†œOCTæ•°æ®é›†ä¸Šä¼˜äºç°æœ‰åˆ†å‰²æ–¹æ³•ã€‚

**å…³é”®è¯**: è¡¨é¢æ£€æµ‹ã€é¡ºåºçº¦æŸã€å‡¸ä¼˜åŒ–ã€è§†ç½‘è†œæˆåƒã€å¤šå±‚åˆ†å‰²

---

## ğŸ¯ ä¸€å¥è¯æ€»ç»“

é€šè¿‡è¿ç»­å‡½æ•°è¡¨ç¤ºå’Œç¡¬çº¦æŸï¼ˆé¡ºåº+è·ç¦»ï¼‰ï¼Œå°†å¤šå±‚è¡¨é¢æ£€æµ‹å»ºæ¨¡ä¸ºå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå®ç°è§†ç½‘è†œOCTç­‰åˆ†å±‚ç»“æ„çš„å‡†ç¡®æ£€æµ‹ã€‚

---

## ğŸ”‘ æ ¸å¿ƒåˆ›æ–°ç‚¹

1. **è¿ç»­è¡¨é¢è¡¨ç¤º**ï¼šç”¨å‡½æ•° $y = s_k(x)$ è¡¨ç¤ºæ¯ä¸ªè¡¨é¢ï¼Œä¿æŒè¿ç»­æ€§
2. **ç¡¬é¡ºåºçº¦æŸ**ï¼š$s_1(x) < s_2(x) < ... < s_K(x)$ï¼Œä¿è¯ç‰©ç†åˆç†æ€§
3. **è·ç¦»çº¦æŸ**ï¼š$d_{min} < s_{k+1} - s_k < d_{max}$ï¼Œé˜²æ­¢å±‚é—´ç²˜è¿æˆ–è¿‡åº¦åˆ†ç¦»
4. **å‡¸ä¼˜åŒ–ä¿è¯**ï¼šå…¨å±€æœ€ä¼˜è§£ï¼Œéè¿­ä»£å¼å¯å‘å¼æ–¹æ³•

---

## ğŸ“Š èƒŒæ™¯ä¸åŠ¨æœº

### å¤šå±‚è¡¨é¢æ£€æµ‹çš„åº”ç”¨

**åŒ»å­¦æˆåƒ - è§†ç½‘è†œOCT**ï¼š
```
è§†ç½‘è†œå±‚æ¬¡ç»“æ„ï¼š
â”œâ”€â”€ ILM (å†…ç•Œè†œ)
â”œâ”€â”€ RNFL (ç¥ç»çº¤ç»´å±‚)
â”œâ”€â”€ IPL (å†…ä¸›çŠ¶å±‚)
â”œâ”€â”€ OPL (å¤–ä¸›çŠ¶å±‚)
â”œâ”€â”€ ONL (å¤–æ ¸å±‚)
â”œâ”€â”€ IS/OS (æ„Ÿå…‰ç»†èƒå±‚)
â””â”€â”€ RPE (è§†ç½‘è†œè‰²ç´ ä¸Šçš®)

æ¯å±‚æ˜¯ä¸€ä¸ªè¿ç»­æ›²é¢ï¼Œéœ€è¦å‡†ç¡®åˆ†ç¦»
```

**å·¥ä¸šæ£€æµ‹**ï¼š
- æ¶‚å±‚åšåº¦æµ‹é‡
- å±‚å‹ææ–™åˆ†æ
- è–„è†œå±‚æ£€æµ‹

### ç‰¹æ®ŠæŒ‘æˆ˜

| æŒ‘æˆ˜ | æè¿° | éš¾ç‚¹ |
|:---|:---|:---|
| å±‚é—´ç²˜è¿ | ç›¸é‚»å±‚ç°åº¦ç›¸ä¼¼ | å®¹æ˜“åˆå¹¶ä¸ºä¸€å±‚ |
| å±‚é—´è·ç¦»å˜åŒ– | ä¸åŒä½ç½®åšåº¦ä¸åŒ | å›ºå®šé—´è·å¤±æ•ˆ |
| æ›²é¢å½¢çŠ¶ | éå¹³é¢ï¼Œæœ‰èµ·ä¼ | ä¸èƒ½ç”¨ç›´çº¿æ‹Ÿåˆ |
| æ‹“æ‰‘å˜åŒ– | å­”æ´ã€æ–­è£‚ | ä¿æŒè¿ç»­æ€§ |

---

## ğŸ’¡ æ–¹æ³•è¯¦è§£ï¼ˆå«å…¬å¼æ¨å¯¼ï¼‰

### 3.1 è¿ç»­è¡¨é¢è¡¨ç¤º

**è¡¨ç¤ºæ–¹æ³•**ï¼š
$$y = s_k(x), \quad k = 1, ..., K$$

å…¶ä¸­ï¼š
- $x \in \mathbb{R}^2$ï¼šæ¨ªå‘åæ ‡
- $y \in \mathbb{R}$ï¼šçºµå‘åæ ‡ï¼ˆé«˜åº¦ï¼‰
- $s_k$ï¼šç¬¬ $k$ ä¸ªè¡¨é¢çš„é«˜åº¦å‡½æ•°

**vs åƒç´ çº§åˆ†å‰²**ï¼š
- åƒç´ çº§ï¼šæ¯ä¸ªåƒç´ ç‹¬ç«‹å†³å®šç±»åˆ«
- è¡¨é¢çº§ï¼šè¿ç»­å‡½æ•°ï¼Œç›¸é‚»ç‚¹ç›¸å…³

### 3.2 é¡ºåºçº¦æŸ

**å…³é”®çº¦æŸ**ï¼šå±‚é—´é¡ºåºä¸èƒ½é¢ å€’

$$s_1(x) < s_2(x) < ... < s_K(x), \quad \forall x$$

**ç‰©ç†æ„ä¹‰**ï¼š
- ç¬¬1å±‚åœ¨æœ€ä¸‹æ–¹
- ç¬¬Kå±‚åœ¨æœ€ä¸Šæ–¹
- ä¸èƒ½äº¤å‰

### 3.3 è·ç¦»çº¦æŸ

**æœ€å°/æœ€å¤§è·ç¦»**ï¼š
$$d_{min} < s_{k+1}(x) - s_k(x) < d_{max}$$

**æ„ä¹‰**ï¼š
- $d_{min}$ï¼šå±‚ä¸èƒ½å¤ªè¿‘ï¼ˆé¿å…ç²˜è¿ï¼‰
- $d_{max}$ï¼šå±‚ä¸èƒ½å¤ªè¿œï¼ˆç”Ÿç†é™åˆ¶ï¼‰

### 3.4 å‡¸ä¼˜åŒ–æ¨¡å‹

**èƒ½é‡æ³›å‡½**ï¼š

$$E(\{s_k\}) = \sum_{k=1}^K \left[ \int_\Omega (f(x, s_k(x)) - \mu_k)^2 dx + \lambda TV(s_k) \right]$$

**å„é¡¹å«ä¹‰**ï¼š

**æ•°æ®é¡¹** $(f - \mu_k)^2$ï¼š
- $f(x, y)$ï¼šå›¾åƒåœ¨ $(x,y)$ å¤„çš„ç°åº¦
- $\mu_k$ï¼šç¬¬ $k$ å±‚çš„æœŸæœ›ç°åº¦
- é¼“åŠ±è¡¨é¢ä½äºç‰¹å®šç°åº¦ä½ç½®

**TVæ­£åˆ™** $TV(s_k)$ï¼š
- $TV(s_k) = \int |\nabla s_k|$ï¼šè¡¨é¢å¹³æ»‘
- é¿å…é”¯é½¿çŠ¶è¡¨é¢

### 3.5 å®Œæ•´çº¦æŸä¼˜åŒ–

$$\min_{\{s_k\}} E(\{s_k\})$$

$$\text{s.t.} \quad s_k(x) + d_{min} \leq s_{k+1}(x) \leq s_k(x) + d_{max}$$

**å‡¸æ€§**ï¼š
- ç›®æ ‡å‡½æ•°æ˜¯å‡¸çš„ï¼ˆäºŒæ¬¡ + TVï¼‰
- çº¦æŸæ˜¯çº¿æ€§çš„
- æ•´ä½“æ˜¯å‡¸ä¼˜åŒ–é—®é¢˜ï¼

---

## ğŸ§ª å®éªŒä¸ç»“æœ

### æ•°æ®é›†

| æ•°æ®é›† | å›¾åƒæ•°é‡ | å±‚æ•° | åº”ç”¨ |
|-------|---------|-----|------|
| è§†ç½‘è†œOCT | 100 | 8å±‚ | çœ¼ç§‘è¯Šæ–­ |
| åˆæˆæ•°æ® | 500 | 3-5å±‚ | ç®—æ³•éªŒè¯ |

### ä¸»å®éªŒç»“æœ

| æ–¹æ³• | Diceåˆ†æ•° | å±‚é—´è·è¯¯å·® | è¿è¡Œæ—¶é—´(s) |
|------|---------|-----------|-----------|
| å›¾å‰² | 0.85 | 12.5 | 15.2 |
| éšæœºæ£®æ— | 0.87 | 10.3 | 2.1 |
| U-Net | 0.89 | 8.7 | 0.5 |
| **æœ¬æ–‡æ–¹æ³•** | **0.92** | **5.2** | **8.5** |

### æ¶ˆèå®éªŒ

| é…ç½® | Dice | åˆ†æ |
|-----|------|------|
| å®Œæ•´æ–¹æ³• | 0.92 | åŸºçº¿ |
| -é¡ºåºçº¦æŸ | 0.78 | å±‚äº¤å‰ä¸¥é‡ |
| -è·ç¦»çº¦æŸ | 0.85 | éƒ¨åˆ†å±‚ç²˜è¿ |
| -TVæ­£åˆ™ | 0.88 | è¡¨é¢ä¸å¹³æ»‘ |

---

## ğŸ“ˆ æŠ€æœ¯æ¼”è¿›è„‰ç»œ

```
[åƒç´ çº§åˆ†ç±»]
  â†“ ç‹¬ç«‹å¤„ç†æ¯ä¸ªåƒç´ 
[å›¾å‰²æ–¹æ³•]
  â†“ å¼•å…¥ç©ºé—´å¹³æ»‘
[æ°´å¹³é›†æ–¹æ³•]
  â†“ è¿ç»­ç•Œé¢è¡¨ç¤º
[æœ¬æ–‡: å‡¸ä¼˜åŒ–è¡¨é¢æ£€æµ‹]
  â†“ ç¡¬çº¦æŸ+å‡¸ä¼˜åŒ–
[åç»­: æ·±åº¦å­¦ä¹ +çº¦æŸ]
```

---

## âš™ï¸ å¯å¤ç°æ€§åˆ†æ

### ç®—æ³•å®ç°

```python
import numpy as np
from scipy.interpolate import RectBivariateSpline

def multilayer_surface_detection(image, K, mu_values, d_min, d_max, lambda_tv, max_iter=200):
    """
    å¤šå±‚è¡¨é¢æ£€æµ‹

    å‚æ•°:
        image: 2Då›¾åƒ (H, W)
        K: è¡¨é¢æ•°é‡
        mu_values: (K,) æ¯å±‚çš„æœŸæœ›ç°åº¦
        d_min, d_max: å±‚é—´è·çº¦æŸ
        lambda_tv: TVæ­£åˆ™æƒé‡
    """
    H, W = image.shape

    # åˆå§‹åŒ–è¡¨é¢
    s = np.linspace(d_min, H - d_min, K)
    s = np.tile(s[:, None], (1, W))  # (K, W)

    # æ’å€¼å›¾åƒ
    x_coords = np.arange(W)
    y_coords = np.arange(H)
    interp = RectBivariateSpline(y_coords, x_coords, image)

    lr = 0.1
    tol = 1e-4

    for iteration in range(max_iter):
        s_old = s.copy()

        # å¯¹æ¯ä¸ªè¡¨é¢è®¡ç®—æ¢¯åº¦
        for k in range(K):
            # æ•°æ®é¡¹æ¢¯åº¦
            for i in range(W):
                y = int(np.clip(s[k, i], 0, H - 1))
                f_val = image[y, i]
                grad_data = 2 * (f_val - mu_values[k])
                s[k, i] -= lr * grad_data

            # TVæ­£åˆ™æ¢¯åº¦
            grad_tv = np.zeros_like(s[k])
            grad_tv[1:-1] = np.sign(s[k, 1:-1] - s[k, :-2]) - np.sign(s[k, 2:] - s[k, 1:-1])
            s[k, :] -= lr * lambda_tv * grad_tv

        # æŠ•å½±åˆ°å¯è¡ŒåŸŸ
        s = project_surface_constraints(s, d_min, d_max)

        # æ”¶æ•›æ£€æŸ¥
        if np.max(np.abs(s - s_old)) < tol:
            break

    return s

def project_surface_constraints(s, d_min, d_max):
    """
    æŠ•å½±åˆ°æ»¡è¶³é¡ºåºå’Œè·ç¦»çº¦æŸçš„é›†åˆ
    ä½¿ç”¨å‰å‘-åå‘ä¼ æ’­
    """
    K, W = s.shape

    # å‰å‘ï¼šç¡®ä¿ s_{k+1} >= s_k + d_min
    for k in range(K - 1):
        s[k+1, :] = np.maximum(s[k+1, :], s[k, :] + d_min)

    # åå‘ï¼šç¡®ä¿ s_k <= s_{k+1} - d_min å’Œ s_{k+1} <= s_k + d_max
    for k in range(K - 1, 0, -1):
        if k > 0:
            s[k, :] = np.minimum(s[k, :], s[k-1, :] + d_max)
            s[k, :] = np.maximum(s[k, :], s[k-1, :] + d_min)

    return s
```

---

## ğŸ“š å…³é”®å‚è€ƒæ–‡çŒ®

1. Boykov, Y., et al. (2001). Fast approximate energy minimization via graph cuts.
2. Mumford, D., & Shah, J. (1989). Optimal approximations by piecewise smooth functions.
3. Cai, X., et al. (2016). Detecting closer surfaces via convex optimization. IEEE TIP.

---

## ğŸ’» ä»£ç å®ç°è¦ç‚¹

### åŠ¨æ€è§„åˆ’æ–¹æ³•ï¼ˆ1Dæƒ…å†µï¼‰

```python
def dp_surface_1d(column, K, mu_values, d_min, d_max):
    """
    ä¸€ç»´åŠ¨æ€è§„åˆ’æ±‚è§£å•åˆ—å¤šå±‚è¡¨é¢

    çŠ¶æ€: dp[k][y] = å‰kå±‚ï¼Œç¬¬kå±‚åœ¨yå¤„çš„æœ€å°èƒ½é‡
    """
    H = len(column)

    # åˆå§‹åŒ–
    dp = np.full((K, H), np.inf)
    parent = np.zeros((K, H), dtype=int)

    # ç¬¬ä¸€å±‚
    for y in range(H):
        dp[0, y] = (column[y] - mu_values[0])**2

    # åŠ¨æ€è§„åˆ’
    for k in range(1, K):
        for y in range(H):
            # å¯»æ‰¾å‰ä¸€å±‚æ»¡è¶³çº¦æŸçš„æœ€ä½³ä½ç½®
            y_prev_min = max(0, y - d_max)
            y_prev_max = min(H - 1, y - d_min)

            if y_prev_min > y_prev_max:
                continue

            # æœ€ä½³å‰é©±
            best_idx = np.argmin(dp[k-1, y_prev_min:y_prev_max+1])
            best_y_prev = y_prev_min + best_idx

            cost = dp[k-1, best_y_prev] + (column[y] - mu_values[k])**2

            if cost < dp[k, y]:
                dp[k, y] = cost
                parent[k, y] = best_y_prev

    # å›æº¯
    surfaces = np.zeros(K, dtype=int)
    surfaces[K-1] = np.argmin(dp[K-1, :])

    for k in range(K-1, 0, -1):
        surfaces[k-1] = parent[k, surfaces[k]]

    return surfaces
```

---

## ğŸŒŸ åº”ç”¨ä¸å½±å“

### åº”ç”¨åœºæ™¯

1. **è§†ç½‘è†œOCTåˆ†æ**
   - è‡ªåŠ¨åˆ†å±‚ç”¨äºç–¾ç—…è¯Šæ–­
   - é’å…‰çœ¼ã€é»„æ–‘å˜æ€§ç­‰çœ¼ç—…
   - åšåº¦æµ‹é‡ç”¨äºæ²»ç–—ç›‘æµ‹

2. **å·¥ä¸šææ–™æ£€æµ‹**
   - æ¶‚å±‚è´¨é‡è¯„ä¼°
   - å¤šå±‚ææ–™åšåº¦æµ‹é‡
   - ç¼ºé™·æ£€æµ‹

### å•†ä¸šä»·å€¼

- **åŒ»ç–—è®¾å¤‡**ï¼šOCTè®¾å¤‡å‚å•†é›†æˆ
- **å·¥ä¸šæ£€æµ‹**ï¼šæ— æŸæ£€æµ‹è§£å†³æ–¹æ¡ˆ

---

## â“ æœªè§£é—®é¢˜ä¸å±•æœ›

### å±€é™æ€§

1. **æ‰©å±•åˆ°3Då¤æ‚è¡¨é¢**ï¼šå½“å‰ä¸»è¦å¤„ç†1Då‡½æ•°
2. **æ‹“æ‰‘å˜åŒ–å¤„ç†**ï¼šå­”æ´ã€æ–­è£‚éœ€è¦é¢å¤–å¤„ç†
3. **å‚æ•°è°ƒä¼˜**ï¼š$\lambda, d_{min}, d_{max}$ éœ€è¦ç»éªŒ

### æœªæ¥æ–¹å‘

1. **è‡ªé€‚åº”å‚æ•°é€‰æ‹©**
2. **æ·±åº¦å­¦ä¹ ç»“åˆ**ï¼šå­¦ä¹ æ•°æ®é¡¹å’Œæ­£åˆ™åŒ–
3. **å®æ—¶å¤„ç†**ï¼šGPUåŠ é€Ÿ

---

## ğŸ“ åˆ†æç¬”è®°

```
æ ¸å¿ƒæ´å¯Ÿï¼š

1. è¿ç»­è¡¨ç¤º vs åƒç´ è¡¨ç¤ºï¼š
   - åƒç´ çº§ï¼šæ¯ä¸ªåƒç´ ç‹¬ç«‹åˆ†ç±»ï¼Œå¿½ç•¥ç©ºé—´å…³ç³»
   - è¿ç»­å‡½æ•°ï¼šç›¸é‚»ç‚¹ç›¸å…³ï¼Œè‡ªç„¶ä¿æŒå¹³æ»‘

2. ç¡¬çº¦æŸçš„é‡è¦æ€§ï¼š
   - é¡ºåºçº¦æŸï¼šsâ‚ < sâ‚‚ < sâ‚ƒï¼ˆç‰©ç†æ„ä¹‰ï¼‰
   - è·ç¦»çº¦æŸï¼šé˜²æ­¢ç²˜è¿å’Œè¿‡åº¦åˆ†ç¦»
   - è¿™äº›çº¦æŸåœ¨ä¼˜åŒ–ä¸­å¿…é¡»ä¸¥æ ¼æ»¡è¶³

3. å‡¸ä¼˜åŒ–çš„ä¼˜åŠ¿ï¼š
   - å…¨å±€æœ€ä¼˜ä¿è¯
   - ä¸ä¾èµ–åˆå§‹åŒ–
   - æ”¶æ•›æ€§å¯è¯æ˜

4. ä¸æ°´å¹³é›†æ–¹æ³•çš„å…³ç³»ï¼š
   - éƒ½ç”¨è¿ç»­è¡¨ç¤º
   - æ°´å¹³é›†ï¼šéšå¼è¡¨ç¤º Ï†(x,y) = 0
   - æœ¬æ–‡ï¼šæ˜¾å¼è¡¨ç¤º y = s(x)

5. åº”ç”¨æ‰©å±•ï¼š
   - é¡ºåºçº¦æŸå¯ç”¨äºåŒå¿ƒåœ†æ£€æµ‹ï¼ˆrâ‚ < râ‚‚ < râ‚ƒï¼‰
   - è·ç¦»çº¦æŸé€‚ç”¨äºä»»ä½•æœ‰ç‰©ç†é—´éš”çš„å±‚çŠ¶ç»“æ„
```

---

## ç»¼åˆè¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| ç†è®ºæ·±åº¦ | â˜…â˜…â˜…â˜…â˜… | å‡¸ä¼˜åŒ–ç†è®ºä¸¥è°¨ |
| æ–¹æ³•åˆ›æ–° | â˜…â˜…â˜…â˜…â˜† | ç¡¬çº¦æŸ+è¿ç»­è¡¨ç¤º |
| å®ç°éš¾åº¦ | â˜…â˜…â˜…â˜†â˜† | ä¸­ç­‰ |
| åº”ç”¨ä»·å€¼ | â˜…â˜…â˜…â˜…â˜… | åŒ»å­¦å½±åƒä»·å€¼é«˜ |
| è®ºæ–‡è´¨é‡ | â˜…â˜…â˜…â˜…â˜† | å®éªŒå……åˆ† |

**æ€»åˆ†ï¼šâ˜…â˜…â˜…â˜…â˜† (4.2/5.0)**

---

*æœ¬ç¬”è®°ç”±5-Agentè¾©è®ºåˆ†æç³»ç»Ÿç”Ÿæˆï¼Œç»“åˆè¯¦ç»†ç‰ˆç¬”è®°è¿›è¡Œæ·±å…¥åˆ†æã€‚*
