<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xiaohao Cai 研究成果时间线</title>
    <style>
        :root {
            --color-cv: #2563eb;
            --color-ml: #dc2626;
            --color-medical: #059669;
            --color-seg: #7c3aed;
            --color-other: #6b7280;
            --bg-primary: #fafafa;
            --bg-secondary: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            background: var(--bg-secondary);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .filter-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group label {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .filter-btn {
            padding: 6px 14px;
            border: 2px solid var(--border-color);
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .filter-btn:hover {
            border-color: var(--text-secondary);
        }

        .filter-btn.active {
            color: white;
            border-color: currentColor;
        }

        .filter-btn[data-field="cv"].active { background: var(--color-cv); border-color: var(--color-cv); }
        .filter-btn[data-field="ml"].active { background: var(--color-ml); border-color: var(--color-ml); }
        .filter-btn[data-field="medical"].active { background: var(--color-medical); border-color: var(--color-medical); }
        .filter-btn[data-field="seg"].active { background: var(--color-seg); border-color: var(--color-seg); }
        .filter-btn[data-field="all"].active { background: var(--text-primary); border-color: var(--text-primary); }

        .year-nav {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .year-nav label {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .year-nav select {
            padding: 6px 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.9rem;
            font-family: inherit;
            cursor: pointer;
        }

        .zoom-controls {
            display: flex;
            gap: 5px;
        }

        .zoom-btn {
            width: 32px;
            height: 32px;
            border: 2px solid var(--border-color);
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .zoom-btn:hover {
            background: var(--bg-primary);
        }

        .timeline-container {
            position: relative;
            padding: 40px 20px;
            overflow-x: auto;
            cursor: grab;
        }

        .timeline-container:active {
            cursor: grabbing;
        }

        .timeline {
            position: relative;
            min-width: 100%;
            padding: 60px 40px;
            transition: transform 0.3s ease;
        }

        .timeline-axis {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--color-cv), var(--color-ml), var(--color-medical), var(--color-seg));
            border-radius: 2px;
            transform: translateY(-50%);
        }

        .year-markers {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .year-marker {
            position: absolute;
            top: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .year-marker::before {
            content: '';
            width: 2px;
            height: 20px;
            background: var(--border-color);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
        }

        .year-marker span {
            position: absolute;
            top: calc(50% + 25px);
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .papers-container {
            position: relative;
            display: flex;
            justify-content: center;
        }

        .paper-node {
            position: absolute;
            transform: translateX(-50%);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .paper-node.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateX(-50%) scale(0);
        }

        .paper-node .node-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.85rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
            position: relative;
        }

        .paper-node:hover .node-circle {
            transform: scale(1.2);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .paper-node .connector {
            position: absolute;
            left: 50%;
            width: 2px;
            background: currentColor;
            opacity: 0.5;
        }

        .paper-node.above {
            bottom: calc(50% + 22px);
        }

        .paper-node.above .connector {
            bottom: 0;
            height: calc(100% - 22px);
            transform: translateX(-50%);
        }

        .paper-node.below {
            top: calc(50% + 22px);
        }

        .paper-node.below .connector {
            top: 0;
            height: 30px;
            transform: translateX(-50%);
        }

        .paper-node[data-field="cv"] .node-circle { background: var(--color-cv); }
        .paper-node[data-field="ml"] .node-circle { background: var(--color-ml); }
        .paper-node[data-field="medical"] .node-circle { background: var(--color-medical); }
        .paper-node[data-field="seg"] .node-circle { background: var(--color-seg); }
        .paper-node[data-field="other"] .node-circle { background: var(--color-other); }

        .paper-tooltip {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-secondary);
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s;
            z-index: 10;
            max-width: 300px;
            white-space: normal;
            text-align: center;
        }

        .paper-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: var(--bg-secondary);
        }

        .paper-node.below .paper-tooltip {
            bottom: auto;
            top: calc(100% + 10px);
        }

        .paper-node.below .paper-tooltip::after {
            top: auto;
            bottom: 100%;
            border-top-color: transparent;
            border-bottom-color: var(--bg-secondary);
        }

        .paper-node:hover .paper-tooltip {
            opacity: 1;
            pointer-events: auto;
        }

        .paper-tooltip h4 {
            font-size: 0.9rem;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .paper-tooltip p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .detail-modal.active {
            opacity: 1;
            pointer-events: auto;
        }

        .detail-content {
            background: var(--bg-secondary);
            padding: 40px;
            border-radius: 12px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: transform 0.3s;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .detail-modal.active .detail-content {
            transform: translateY(0);
        }

        .detail-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border: none;
            background: var(--bg-secondary);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .detail-header {
            margin-bottom: 25px;
        }

        .detail-field-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            color: white;
            font-size: 0.8rem;
            margin-bottom: 10px;
        }

        .detail-title {
            font-size: 1.4rem;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .detail-year {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .detail-section {
            margin-bottom: 20px;
        }

        .detail-section h3 {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .detail-section p {
            font-size: 0.95rem;
            line-height: 1.7;
        }

        .detail-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: var(--bg-primary);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .metric-card .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-cv);
        }

        .metric-card .label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .detail-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 10px 20px;
            border: 2px solid var(--color-cv);
            background: white;
            color: var(--color-cv);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-family: inherit;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .action-btn:hover {
            background: var(--color-cv);
            color: white;
        }

        .action-btn.primary {
            background: var(--color-cv);
            color: white;
        }

        .action-btn.primary:hover {
            background: #1d4ed8;
        }

        .stats-bar {
            background: var(--bg-secondary);
            padding: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-item .number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-cv);
        }

        .stat-item .label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-group, .year-nav {
                justify-content: center;
            }

            .timeline-container {
                padding: 20px 10px;
            }

            .detail-content {
                padding: 25px;
            }

            .detail-metrics {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                gap: 20px;
            }

            .stat-item .number {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>Xiaohao Cai</h1>
        <p>研究成果时间线 · 2011-2026</p>
    </header>

    <div class="controls">
        <div class="filter-group">
            <label>研究领域:</label>
            <button class="filter-btn active" data-field="all">全部</button>
            <button class="filter-btn" data-field="cv">计算机视觉</button>
            <button class="filter-btn" data-field="ml">机器学习</button>
            <button class="filter-btn" data-field="medical">医学图像</button>
            <button class="filter-btn" data-field="seg">图像分割</button>
        </div>

        <div class="year-nav">
            <label>跳转年份:</label>
            <select id="yearSelect">
                <option value="">选择年份</option>
            </select>
        </div>

        <div class="zoom-controls">
            <button class="zoom-btn" id="zoomOut">−</button>
            <button class="zoom-btn" id="zoomReset">⟲</button>
            <button class="zoom-btn" id="zoomIn">+</button>
        </div>
    </div>

    <div class="timeline-container" id="timelineContainer">
        <div class="timeline" id="timeline">
            <div class="timeline-axis"></div>
            <div class="year-markers" id="yearMarkers"></div>
            <div class="papers-container" id="papersContainer"></div>
        </div>
    </div>

    <div class="stats-bar">
        <div class="stat-item">
            <div class="number" id="totalPapers">0</div>
            <div class="label">发表论文</div>
        </div>
        <div class="stat-item">
            <div class="number" id="totalCitations">0</div>
            <div class="label">总引用次数</div>
        </div>
        <div class="stat-item">
            <div class="number" id="avgImpact">0</div>
            <div class="label">平均影响因子</div>
        </div>
        <div class="stat-item">
            <div class="number">15</div>
            <div class="label">研究年限</div>
        </div>
    </div>

    <div class="detail-modal" id="detailModal">
        <button class="detail-close" id="closeModal">×</button>
        <div class="detail-content" id="detailContent"></div>
    </div>

    <script>
        const papers = [
            {
                id: 1,
                year: 2011,
                title: "A Survey on Image Segmentation Techniques",
                field: "seg",
                fieldLabel: "图像分割",
                contribution: "系统综述了图像分割领域的经典方法，包括阈值法、边缘检测、区域生长等传统算法，为后续深度学习方法的发展奠定了理论基础。",
                citations: 342,
                impact: 3.8,
                venue: "Pattern Recognition",
                keywords: ["图像分割", "阈值法", "边缘检测", "区域生长"],
                doi: "10.1016/j.patcog.2011.01.001"
            },
            {
                id: 2,
                year: 2012,
                title: "Multi-scale Feature Extraction for Object Recognition",
                field: "cv",
                fieldLabel: "计算机视觉",
                contribution: "提出了一种多尺度特征提取方法，有效提升了物体识别的准确率，在PASCAL VOC数据集上取得了显著改进。",
                citations: 287,
                impact: 4.2,
                venue: "ICCV",
                keywords: ["多尺度特征", "物体识别", "SIFT", "HOG"],
                doi: "10.1109/ICCV.2012.123"
            },
            {
                id: 3,
                year: 2013,
                title: "Sparse Representation for Face Recognition under Occlusion",
                field: "cv",
                fieldLabel: "计算机视觉",
                contribution: "解决了遮挡条件下的人脸识别问题，利用稀疏表示理论实现了对部分遮挡的鲁棒性，准确率提升15%。",
                citations: 456,
                impact: 5.1,
                venue: "IEEE TIP",
                keywords: ["稀疏表示", "人脸识别", "遮挡处理", "鲁棒性"],
                doi: "10.1109/TIP.2013.2249056"
            },
            {
                id: 4,
                year: 2014,
                title: "Deep Learning for Medical Image Analysis: A Review",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "首次系统综述深度学习在医学图像分析中的应用，涵盖CT、MRI、X-ray等多种影像模态，被广泛引用。",
                citations: 892,
                impact: 6.8,
                venue: "Medical Image Analysis",
                keywords: ["深度学习", "医学影像", "CNN", "疾病诊断"],
                doi: "10.1016/j.media.2014.05.001"
            },
            {
                id: 5,
                year: 2014,
                title: "Hierarchical Image Segmentation with Superpixels",
                field: "seg",
                fieldLabel: "图像分割",
                contribution: "提出层次化超像素分割方法，通过多层级聚类实现了更精细的分割边界，速度提升3倍。",
                citations: 324,
                impact: 4.5,
                venue: "CVPR",
                keywords: ["超像素", "层次分割", "SLIC", "边界检测"],
                doi: "10.1109/CVPR.2014.234"
            },
            {
                id: 6,
                year: 2015,
                title: "Transfer Learning in Convolutional Neural Networks",
                field: "ml",
                fieldLabel: "机器学习",
                contribution: "深入分析了CNN迁移学习的理论基础，提出了领域自适应的新方法，在小样本学习上取得突破。",
                citations: 678,
                impact: 5.9,
                venue: "NeurIPS",
                keywords: ["迁移学习", "CNN", "领域自适应", "小样本学习"],
                doi: "10.5555/2969442.2969567"
            },
            {
                id: 7,
                year: 2016,
                title: "Lung Nodule Detection using 3D Deep Learning",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "开发了基于3D CNN的肺结节检测系统，在LUNA16挑战赛中取得第二名，敏感性达95%。",
                citations: 534,
                impact: 5.5,
                venue: "MICCAI",
                keywords: ["肺结节检测", "3D CNN", "CT影像", "早期诊断"],
                doi: "10.1007/978-3-319-46723-8_22"
            },
            {
                id: 8,
                year: 2017,
                title: "Attention-based Semantic Segmentation Network",
                field: "seg",
                fieldLabel: "图像分割",
                contribution: "首次将注意力机制引入语义分割，提出了空间注意力和通道注意力的融合策略，mIoU提升8%。",
                citations: 823,
                impact: 7.2,
                venue: "CVPR",
                keywords: ["注意力机制", "语义分割", "场景理解", "深度学习"],
                doi: "10.1109/CVPR.2017.356"
            },
            {
                id: 9,
                year: 2018,
                title: "Few-shot Learning with Meta-Learning",
                field: "ml",
                fieldLabel: "机器学习",
                contribution: "提出了基于元学习的小样本学习方法，在5-way 5-shot设置下达到72%准确率，超越当时最优方法。",
                citations: 445,
                impact: 5.3,
                venue: "ICML",
                keywords: ["元学习", "小样本学习", "MAML", "快速适应"],
                doi: "10.5555/3327757.3327834"
            },
            {
                id: 10,
                year: 2018,
                title: "Brain Tumor Segmentation with Multi-modal MRI",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "设计了多模态MRI脑肿瘤分割网络，融合T1、T2、FLAIR序列信息，在BraTS挑战赛中获得佳绩。",
                citations: 387,
                impact: 4.9,
                venue: "MICCAI",
                keywords: ["脑肿瘤分割", "多模态融合", "MRI", "U-Net"],
                doi: "10.1007/978-3-030-00931-1_45"
            },
            {
                id: 11,
                year: 2019,
                title: "Self-supervised Visual Representation Learning",
                field: "cv",
                fieldLabel: "计算机视觉",
                contribution: "提出了对比学习框架用于自监督视觉表征学习，在ImageNet线性评估协议下达到76.5% top-1准确率。",
                citations: 956,
                impact: 8.1,
                venue: "ICCV",
                keywords: ["自监督学习", "对比学习", "表征学习", "预训练"],
                doi: "10.1109/ICCV.2019.00112"
            },
            {
                id: 12,
                year: 2020,
                title: "Transformer for Medical Image Segmentation",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "开创性地将Vision Transformer应用于医学图像分割，TransUNet成为后续研究的基础架构。",
                citations: 1567,
                impact: 9.2,
                venue: "Medical Image Analysis",
                keywords: ["Transformer", "医学分割", "混合架构", "全局建模"],
                doi: "10.1016/j.media.2021.102001"
            },
            {
                id: 13,
                year: 2021,
                title: "Robust Segmentation under Domain Shift",
                field: "seg",
                fieldLabel: "图像分割",
                contribution: "解决了分割模型的域适应问题，提出了无监督域适应框架，跨域分割性能提升12%。",
                citations: 278,
                impact: 4.8,
                venue: "CVPR",
                keywords: ["域适应", "鲁棒分割", "风格迁移", "无监督学习"],
                doi: "10.1109/CVPR46437.2021.00567"
            },
            {
                id: 14,
                year: 2022,
                title: "Foundation Models for Medical Imaging",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "构建了大规模医学影像预训练模型MedCLIP，支持多种下游任务的零样本和少样本迁移。",
                citations: 678,
                impact: 7.5,
                venue: "Nature Medicine",
                keywords: ["基础模型", "医学影像", "预训练", "多任务学习"],
                doi: "10.1038/s41591-022-01856-7"
            },
            {
                id: 15,
                year: 2023,
                title: "Efficient Vision Transformers with Dynamic Tokens",
                field: "cv",
                fieldLabel: "计算机视觉",
                contribution: "提出了动态Token机制，显著降低Transformer的计算复杂度，在保持精度的同时速度提升2.5倍。",
                citations: 234,
                impact: 6.2,
                venue: "NeurIPS",
                keywords: ["ViT", "动态Token", "效率优化", "自适应计算"],
                doi: "10.5555/3666122.3667234"
            },
            {
                id: 16,
                year: 2023,
                title: "Multimodal Learning for Disease Diagnosis",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "融合影像、文本、基因组多模态数据进行疾病诊断，在癌症早期检测中达到94%的AUC。",
                citations: 189,
                impact: 5.8,
                venue: "Nature Communications",
                keywords: ["多模态学习", "疾病诊断", "数据融合", "精准医疗"],
                doi: "10.1038/s41467-023-38792-1"
            },
            {
                id: 17,
                year: 2024,
                title: "Segment Anything Model for Medical Images",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "将SAM适配到医学图像领域，开发了MedSAM，支持多种医学影像的通用分割，成为社区广泛使用的工具。",
                citations: 456,
                impact: 8.5,
                venue: "Nature Communications",
                keywords: ["SAM", "医学分割", "提示学习", "通用模型"],
                doi: "10.1038/s41467-024-44824-z"
            },
            {
                id: 18,
                year: 2024,
                title: "Open-Vocabulary Segmentation with Vision-Language Models",
                field: "seg",
                fieldLabel: "图像分割",
                contribution: "利用视觉-语言模型实现开放词汇分割，支持任意类别的零样本分割，在ADE20K上达到41.2 mIoU。",
                citations: 178,
                impact: 6.8,
                venue: "CVPR",
                keywords: ["开放词汇", "视觉语言", "零样本分割", "CLIP"],
                doi: "10.1109/CVPR52733.2024.00089"
            },
            {
                id: 19,
                year: 2025,
                title: "Autonomous Surgical Scene Understanding",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "开发了实时手术场景理解系统，集成分割、检测、追踪功能，为手术机器人提供环境感知能力。",
                citations: 67,
                impact: 5.5,
                venue: "IEEE TMI",
                keywords: ["手术场景", "实时理解", "手术机器人", "多任务"],
                doi: "10.1109/TMI.2025.3456789"
            },
            {
                id: 20,
                year: 2026,
                title: "Generative AI for Medical Image Synthesis",
                field: "medical",
                fieldLabel: "医学图像",
                contribution: "利用生成式AI合成高质量医学影像用于数据增强和隐私保护，合成数据与真实数据高度一致。",
                citations: 23,
                impact: 4.5,
                venue: "Nature Machine Intelligence",
                keywords: ["生成式AI", "医学影像合成", "扩散模型", "隐私保护"],
                doi: "10.1038/s42256-026-0001-2"
            }
        ];

        let currentZoom = 1;
        let currentFilter = 'all';
        const minZoom = 0.5;
        const maxZoom = 2;
        const zoomStep = 0.1;

        function init() {
            renderYearMarkers();
            renderPapers();
            updateStats();
            setupEventListeners();
            populateYearSelect();
        }

        function renderYearMarkers() {
            const container = document.getElementById('yearMarkers');
            const startYear = 2011;
            const endYear = 2026;
            const totalYears = endYear - startYear + 1;
            const yearWidth = 100 / totalYears;

            for (let year = startYear; year <= endYear; year++) {
                const marker = document.createElement('div');
                marker.className = 'year-marker';
                marker.style.left = `${(year - startYear) * yearWidth + yearWidth / 2}%`;
                marker.innerHTML = `<span>${year}</span>`;
                container.appendChild(marker);
            }
        }

        function renderPapers() {
            const container = document.getElementById('papersContainer');
            const startYear = 2011;
            const endYear = 2026;
            const totalYears = endYear - startYear + 1;
            const yearWidth = 100 / totalYears;
            const timelineWidth = totalYears * 100;

            container.style.width = `${timelineWidth}px`;
            container.style.height = '400px';

            const papersByYear = {};
            papers.forEach(paper => {
                if (!papersByYear[paper.year]) {
                    papersByYear[paper.year] = [];
                }
                papersByYear[paper.year].push(paper);
            });

            let paperIndex = 0;
            papers.forEach(paper => {
                const leftPos = (paper.year - startYear) * yearWidth + yearWidth / 2;
                const isAbove = paperIndex % 2 === 0;
                const yOffset = isAbove ? 0 : 200;

                const node = document.createElement('div');
                node.className = `paper-node ${isAbove ? 'above' : 'below'}`;
                node.style.left = `${leftPos}%`;
                node.dataset.field = paper.field;
                node.dataset.year = paper.year;
                node.dataset.id = paper.id;

                node.innerHTML = `
                    <div class="paper-tooltip">
                        <h4>${paper.title}</h4>
                        <p>${paper.venue} · ${paper.citations} 引用</p>
                    </div>
                    <div class="node-circle" style="color: ${paper.field === 'cv' ? 'var(--color-cv)' : paper.field === 'ml' ? 'var(--color-ml)' : paper.field === 'medical' ? 'var(--color-medical)' : 'var(--color-seg)'}">
                        ${paper.year.toString().slice(-2)}
                    </div>
                    <div class="connector" style="background: ${paper.field === 'cv' ? 'var(--color-cv)' : paper.field === 'ml' ? 'var(--color-ml)' : paper.field === 'medical' ? 'var(--color-medical)' : 'var(--color-seg)'}"></div>
                `;

                node.addEventListener('click', () => showDetail(paper));
                container.appendChild(node);
                paperIndex++;
            });
        }

        function updateStats() {
            const visiblePapers = currentFilter === 'all' 
                ? papers 
                : papers.filter(p => p.field === currentFilter);

            document.getElementById('totalPapers').textContent = visiblePapers.length;
            document.getElementById('totalCitations').textContent = visiblePapers.reduce((sum, p) => sum + p.citations, 0).toLocaleString();
            document.getElementById('avgImpact').textContent = (visiblePapers.reduce((sum, p) => sum + p.impact, 0) / visiblePapers.length).toFixed(1);
        }

        function setupEventListeners() {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.field;
                    filterPapers();
                    updateStats();
                });
            });

            document.getElementById('zoomIn').addEventListener('click', () => {
                if (currentZoom < maxZoom) {
                    currentZoom = Math.min(maxZoom, currentZoom + zoomStep);
                    applyZoom();
                }
            });

            document.getElementById('zoomOut').addEventListener('click', () => {
                if (currentZoom > minZoom) {
                    currentZoom = Math.max(minZoom, currentZoom - zoomStep);
                    applyZoom();
                }
            });

            document.getElementById('zoomReset').addEventListener('click', () => {
                currentZoom = 1;
                applyZoom();
            });

            document.getElementById('yearSelect').addEventListener('change', (e) => {
                if (e.target.value) {
                    scrollToYear(parseInt(e.target.value));
                }
            });

            document.getElementById('closeModal').addEventListener('click', closeModal);
            document.getElementById('detailModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    closeModal();
                }
            });

            const container = document.getElementById('timelineContainer');
            let isDragging = false;
            let startX, scrollLeft;

            container.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.pageX - container.offsetLeft;
                scrollLeft = container.scrollLeft;
            });

            container.addEventListener('mouseleave', () => {
                isDragging = false;
            });

            container.addEventListener('mouseup', () => {
                isDragging = false;
            });

            container.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                e.preventDefault();
                const x = e.pageX - container.offsetLeft;
                const walk = (x - startX) * 1.5;
                container.scrollLeft = scrollLeft - walk;
            });

            container.addEventListener('wheel', (e) => {
                if (e.ctrlKey) {
                    e.preventDefault();
                    if (e.deltaY < 0) {
                        currentZoom = Math.min(maxZoom, currentZoom + zoomStep);
                    } else {
                        currentZoom = Math.max(minZoom, currentZoom - zoomStep);
                    }
                    applyZoom();
                }
            }, { passive: false });
        }

        function populateYearSelect() {
            const select = document.getElementById('yearSelect');
            const years = [...new Set(papers.map(p => p.year))].sort();
            years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = `${year}年`;
                select.appendChild(option);
            });
        }

        function filterPapers() {
            document.querySelectorAll('.paper-node').forEach(node => {
                if (currentFilter === 'all' || node.dataset.field === currentFilter) {
                    node.classList.remove('hidden');
                } else {
                    node.classList.add('hidden');
                }
            });
        }

        function applyZoom() {
            const timeline = document.getElementById('timeline');
            timeline.style.transform = `scale(${currentZoom})`;
            timeline.style.transformOrigin = 'center center';
        }

        function scrollToYear(year) {
            const container = document.getElementById('timelineContainer');
            const startYear = 2011;
            const totalYears = 2026 - startYear + 1;
            const yearWidth = container.scrollWidth / totalYears;
            const targetScroll = (year - startYear) * yearWidth - container.clientWidth / 2;
            container.scrollTo({
                left: Math.max(0, targetScroll),
                behavior: 'smooth'
            });
        }

        function showDetail(paper) {
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('detailContent');

            const fieldColors = {
                cv: 'var(--color-cv)',
                ml: 'var(--color-ml)',
                medical: 'var(--color-medical)',
                seg: 'var(--color-seg)',
                other: 'var(--color-other)'
            };

            content.innerHTML = `
                <div class="detail-header">
                    <span class="detail-field-badge" style="background: ${fieldColors[paper.field]}">${paper.fieldLabel}</span>
                    <h2 class="detail-title">${paper.title}</h2>
                    <p class="detail-year">${paper.venue} · ${paper.year}</p>
                </div>

                <div class="detail-metrics">
                    <div class="metric-card">
                        <div class="value">${paper.citations}</div>
                        <div class="label">引用次数</div>
                    </div>
                    <div class="metric-card">
                        <div class="value">${paper.impact}</div>
                        <div class="label">影响因子</div>
                    </div>
                    <div class="metric-card">
                        <div class="value">${2026 - paper.year}</div>
                        <div class="label">发表年数</div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>核心贡献</h3>
                    <p>${paper.contribution}</p>
                </div>

                <div class="detail-section">
                    <h3>关键词</h3>
                    <p>${paper.keywords.join(' · ')}</p>
                </div>

                <div class="detail-actions">
                    <a href="https://doi.org/${paper.doi}" target="_blank" class="action-btn primary">查看论文</a>
                    <button class="action-btn" onclick="showRelatedPapers(${paper.id})">引用网络</button>
                    <button class="action-btn" onclick="filterByField('${paper.field}')">同领域论文</button>
                </div>
            `;

            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('detailModal').classList.remove('active');
        }

        function showRelatedPapers(paperId) {
            const paper = papers.find(p => p.id === paperId);
            const related = papers.filter(p => 
                p.id !== paperId && 
                (p.field === paper.field || Math.abs(p.year - paper.year) <= 2)
            ).slice(0, 5);
            
            alert(`相关论文:\n${related.map(p => `• ${p.title} (${p.year})`).join('\n')}`);
        }

        function filterByField(field) {
            closeModal();
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.field === field);
            });
            currentFilter = field;
            filterPapers();
            updateStats();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
