# GRASPTrack: å‡ ä½•æŽ¨ç†å…³è”çš„å¤šç›®æ ‡è·Ÿè¸ª

> **è¶…ç²¾è¯»ç¬”è®°** | 5-Agentè¾©è®ºåˆ†æžç³»ç»Ÿ
> åˆ†æžæ—¶é—´ï¼š2026-02-16
> è®ºæ–‡æ¥æºï¼šarXiv:2508.08117
> ä½œè€…ï¼šXudong Han, Pengcheng Fang, Yueying Tian, Jianhui Yu, Xiaohao Cai, Daniel Roggen, Philip Birch
> é¢†åŸŸï¼šè®¡ç®—æœºè§†è§‰ã€å¤šç›®æ ‡è·Ÿè¸ªã€æ·±åº¦ä¼°è®¡

---

## ðŸ“„ è®ºæ–‡å…ƒä¿¡æ¯

| å±žæ€§ | ä¿¡æ¯ |
|------|------|
| **æ ‡é¢˜** | GRASPTrack: Geometry-Reasoned Association via Segmentation and Projection for Multi-Object Tracking |
| **ä½œè€…** | Xudong Han, Pengcheng Fang, Yueying Tian, Jianhui Yu, Xiaohao Cai, Daniel Roggen, Philip Birch |
| **å¹´ä»½** | 2025 |
| **arXiv ID** | 2508.08117 |
| **é¢†åŸŸ** | è®¡ç®—æœºè§†è§‰ã€å¤šç›®æ ‡è·Ÿè¸ªã€3Dè§†è§‰ã€å‡ ä½•æŽ¨ç† |
| **ä»»åŠ¡ç±»åž‹** | å¤šç›®æ ‡è·Ÿè¸ªã€é®æŒ¡å¤„ç†ã€æ·±åº¦ä¼°è®¡ |

### ðŸ“ æ‘˜è¦ç¿»è¯‘

æœ¬æ–‡æå‡ºäº†GRASPTrackï¼Œä¸€ç§æ·±åº¦æ„ŸçŸ¥çš„å¤šç›®æ ‡è·Ÿè¸ªæ¡†æž¶ï¼Œé€šè¿‡åˆ†å‰²å’ŒæŠ•å½±å®žçŽ°å‡ ä½•æŽ¨ç†å…³è”ã€‚é’ˆå¯¹ä¼ ç»Ÿè·Ÿè¸ª-æ£€æµ‹æ–¹æ³•åœ¨é®æŒ¡å’Œæ·±åº¦æ¨¡ç³Šé—®é¢˜ä¸Šçš„å›ºæœ‰ç¼ºé™·ï¼ŒGRASPTrackå°†å•ç›®æ·±åº¦ä¼°è®¡å’Œå®žä¾‹åˆ†å‰²é›†æˆåˆ°æ ‡å‡†TBDæµç¨‹ä¸­ï¼Œä»Ž2Dæ£€æµ‹ç”Ÿæˆé«˜ä¿çœŸ3Dç‚¹äº‘ï¼Œä»Žè€Œå®žçŽ°æ˜¾å¼3Då‡ ä½•æŽ¨ç†ã€‚è¿™äº›3Dç‚¹äº‘è¢«ä½“ç´ åŒ–ä»¥å®žçŽ°ç²¾ç¡®ä¸”é²æ£’çš„åŸºäºŽä½“ç´ çš„3Däº¤å¹¶æ¯”ï¼ˆIoUï¼‰è¿›è¡Œç©ºé—´å…³è”ã€‚ä¸ºè¿›ä¸€æ­¥å¢žå¼ºè·Ÿè¸ªé²æ£’æ€§ï¼Œè¯¥æ–¹æ³•é›†æˆäº†æ·±åº¦æ„ŸçŸ¥è‡ªé€‚åº”å™ªå£°è¡¥å¿ï¼Œæ ¹æ®é®æŒ¡ä¸¥é‡ç¨‹åº¦åŠ¨æ€è°ƒæ•´å¡å°”æ›¼æ»¤æ³¢å™¨è¿‡ç¨‹å™ªå£°ï¼Œå®žçŽ°æ›´å¯é çš„çŠ¶æ€ä¼°è®¡ã€‚æ­¤å¤–ï¼Œè®ºæ–‡æå‡ºäº†æ·±åº¦å¢žå¼ºçš„è§‚å¯Ÿä¸­å¿ƒåŠ¨é‡ï¼Œå°†è¿åŠ¨æ–¹å‘ä¸€è‡´æ€§ä»Žå›¾åƒå¹³é¢æ‰©å±•åˆ°3Dç©ºé—´ï¼Œæ”¹å–„åŸºäºŽè¿åŠ¨çš„å…³è”çº¿ç´¢ï¼Œç‰¹åˆ«æ˜¯å¯¹äºŽå…·æœ‰å¤æ‚è½¨è¿¹çš„å¯¹è±¡ã€‚åœ¨MOT17ã€MOT20å’ŒDanceTrackåŸºå‡†ä¸Šçš„å¹¿æ³›å®žéªŒè¡¨æ˜Žï¼Œè¯¥æ–¹æ³•åœ¨å¤„ç†é¢‘ç¹é®æŒ¡å’Œå¤æ‚è¿åŠ¨æ¨¡å¼çš„åœºæ™¯æ–¹é¢æ˜¾è‘—æå‡äº†è·Ÿè¸ªé²æ£’æ€§ã€‚

**å…³é”®è¯**: å¤šç›®æ ‡è·Ÿè¸ªã€æ·±åº¦ä¼°è®¡ã€å‡ ä½•æŽ¨ç†ã€3Dä½“ç´ åŒ–ã€é®æŒ¡å¤„ç†

---

## ðŸŽ¯ ä¸€å¥è¯æ€»ç»“

GRASPTracké€šè¿‡å°†å•ç›®æ·±åº¦ä¼°è®¡å’Œå®žä¾‹åˆ†å‰²é›†æˆåˆ°å¤šç›®æ ‡è·Ÿè¸ªæµç¨‹ï¼Œç”Ÿæˆ3Dç‚¹äº‘å¹¶åˆ©ç”¨ä½“ç´ åŒ–IoUè¿›è¡Œå‡ ä½•æŽ¨ç†å…³è”ï¼Œæœ‰æ•ˆè§£å†³äº†é®æŒ¡å’Œæ·±åº¦æ¨¡ç³Šé—®é¢˜ã€‚

---

## ðŸ”‘ æ ¸å¿ƒåˆ›æ–°ç‚¹

1. **3Dç‚¹äº‘ç”Ÿæˆ**ï¼šä»Ž2Dæ£€æµ‹+æ·±åº¦ä¼°è®¡ç”Ÿæˆé«˜ä¿çœŸ3Dç‚¹äº‘
2. **ä½“ç´ åŒ–IoUå…³è”**ï¼šåœ¨3Dç©ºé—´è¿›è¡Œç²¾ç¡®çš„ç©ºé—´å…³è”
3. **æ·±åº¦æ„ŸçŸ¥è‡ªé€‚åº”å™ªå£°è¡¥å¿**ï¼šåŠ¨æ€è°ƒæ•´å¡å°”æ›¼æ»¤æ³¢å™¨å™ªå£°
4. **æ·±åº¦å¢žå¼ºè§‚å¯Ÿä¸­å¿ƒåŠ¨é‡**ï¼š3Dè¿åŠ¨æ–¹å‘ä¸€è‡´æ€§å»ºæ¨¡
5. **ç«¯åˆ°ç«¯TBDé›†æˆ**ï¼šæ— éœ€é¢å¤–æ ‡æ³¨æ•°æ®

---

## ðŸ“Š èƒŒæ™¯ä¸ŽåŠ¨æœº

### ä¼ ç»ŸMOTæ–¹æ³•çš„å±€é™æ€§

| é—®é¢˜ | æè¿° | åŽæžœ |
|------|------|------|
| ç¼ºä¹å‡ ä½•æ„ŸçŸ¥ | ä»…ä½¿ç”¨2D IoU | é®æŒ¡æ—¶IDåˆ‡æ¢é¢‘ç¹ |
| æ·±åº¦æ¨¡ç³Š | å•ç›®å›¾åƒæ·±åº¦ä¸ç¡®å®š | å…³è”åŒ¹é…å¤±è´¥ |
| è¿åŠ¨æ¨¡åž‹å±€é™ | 2Då¹³é¢è¿åŠ¨é¢„æµ‹ | å¤æ‚è½¨è¿¹è·Ÿè¸ªå¤±è´¥ |

### æ ¸å¿ƒæŒ‘æˆ˜

1. **é®æŒ¡é—®é¢˜**ï¼šç›®æ ‡äº’ç›¸é®æŒ¡æ—¶å¤–è§‚ç‰¹å¾ä¸å¯é 
2. **æ·±åº¦æ­§ä¹‰**ï¼šå•ç›®è§†é¢‘ç¼ºä¹ç²¾ç¡®æ·±åº¦ä¿¡æ¯
3. **å¤æ‚è¿åŠ¨**ï¼šéžç›´çº¿è¿åŠ¨å¯¼è‡´é¢„æµ‹å¤±æ•ˆ

### é—®é¢˜å®šä¹‰

ç»™å®šè§†é¢‘åºåˆ— $I_1, I_2, ..., I_T$ï¼Œä¼°è®¡æ¯ä¸ªç›®æ ‡ $o$ çš„è½¨è¿¹ï¼š

$$\tau_o = \{(b_t^o, id_t^o)\}_{t=t_s}^{t_e}$$

å…¶ä¸­ $b_t^o$ æ˜¯è¾¹ç•Œæ¡†ï¼Œ$id_t^o$ æ˜¯èº«ä»½æ ‡ç­¾ã€‚

---

## ðŸ’¡ æ–¹æ³•è¯¦è§£ï¼ˆå«å…¬å¼æŽ¨å¯¼ï¼‰

### 3.1 æ•´ä½“æž¶æž„

```
è¾“å…¥ï¼šè§†é¢‘å¸§ I_t
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ£€æµ‹æ¨¡å—ï¼ˆå¦‚YOLO/Xï¼‰                  â”‚
â”‚   è¾“å‡ºï¼š2Dè¾¹ç•Œæ¡† B = {b_1, ..., b_n}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ·±åº¦ä¼°è®¡æ¨¡å—ï¼ˆå¦‚DPT/MiDaSï¼‰           â”‚
â”‚   è¾“å‡ºï¼šæ·±åº¦å›¾ D_t                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®žä¾‹åˆ†å‰²+3Dç‚¹äº‘ç”Ÿæˆ                  â”‚
â”‚   è¾“å‡ºï¼šP_t = {P_1, ..., P_n}          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   3Dä½“ç´ åŒ–+IoUè®¡ç®—                     â”‚
â”‚   è¾“å‡ºï¼šIoUçŸ©é˜µ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ·±åº¦æ„ŸçŸ¥å™ªå£°è¡¥å¿+å¡å°”æ›¼æ»¤æ³¢           â”‚
â”‚   è¾“å‡ºï¼šçŠ¶æ€ä¼°è®¡+è½¨è¿¹å…³è”              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
è¾“å‡ºï¼šç›®æ ‡è½¨è¿¹ + èº«ä»½
```

### 3.2 3Dç‚¹äº‘ç”Ÿæˆ

å¯¹äºŽæ¯ä¸ª2Dæ£€æµ‹æ¡† $b_i = (x, y, w, h)$ å’Œå¯¹åº”çš„æ·±åº¦å›¾ $D$ï¼Œç”Ÿæˆ3Dç‚¹äº‘ï¼š

$$P_i = \{(u, v, D(u, v)) | (u, v) \in b_i \cap M_i\}$$

å…¶ä¸­ $M_i$ æ˜¯å®žä¾‹åˆ†å‰²æŽ©ç ã€‚

**é€†æŠ•å½±å˜æ¢**ï¼š
$$X = (u - c_x) \cdot Z / f_x$$
$$Y = (v - c_y) \cdot Z / f_y$$
$$Z = D(u, v)$$

å…¶ä¸­ $(c_x, c_y)$ æ˜¯ç›¸æœºä¸­å¿ƒï¼Œ$(f_x, f_y)$ æ˜¯ç„¦è·ã€‚

### 3.3 3Dä½“ç´ åŒ–

å°†ç‚¹äº‘è½¬æ¢ä¸º3Dä½“ç´ ç½‘æ ¼ï¼š

$$V_i(x, y, z) = \begin{cases} 1, & \text{if } \exists p \in P_i, p \in \text{voxel}(x,y,z) \\ 0, & \text{otherwise} \end{cases}$$

**ä½“ç´ å¤§å°**ï¼šé€šå¸¸é€‰æ‹©ä¸Žæ£€æµ‹æ¡†å°ºåº¦ç›¸å…³ï¼Œå¦‚ $0.1 \times \text{diag}(b_i)$ã€‚

### 3.4 ä½“ç´ åŒ–IoUè®¡ç®—

$$\text{IoU}_{3D}(V_i, V_j) = \frac{\sum_{x,y,z} \min(V_i(x,y,z), V_j(x,y,z))}{\sum_{x,y,z} \max(V_i(x,y,z), V_j(x,y,z))}$$

**ä¼˜åŠ¿**ï¼š
- æ•èŽ·3Dç©ºé—´é‡å 
- å¯¹éƒ¨åˆ†é®æŒ¡é²æ£’
- è‡ªç„¶å¤„ç†å°ºåº¦å˜åŒ–

### 3.5 æ·±åº¦æ„ŸçŸ¥è‡ªé€‚åº”å™ªå£°è¡¥å¿

**å¡å°”æ›¼æ»¤æ³¢å™¨è¿‡ç¨‹å™ªå£°è°ƒæ•´**ï¼š
$$Q_t = Q_0 \cdot (1 + \alpha \cdot \text{occ}_t)$$

å…¶ä¸­ $\text{occ}_t$ æ˜¯é®æŒ¡ä¸¥é‡ç¨‹åº¦ï¼Œ$\alpha$ æ˜¯ç¼©æ”¾å› å­ã€‚

**é®æŒ¡åº¦é‡**ï¼š
$$\text{occ}_t = 1 - \frac{\text{visible pixels}}{\text{total pixels}}$$

**æ•°å­¦æ„ä¹‰**ï¼šé®æŒ¡è¶Šä¸¥é‡ï¼Œå¢žåŠ è¿‡ç¨‹å™ªå£°ï¼Œä½¿æ»¤æ³¢å™¨æ›´ä¾èµ–è§‚æµ‹è€Œéžé¢„æµ‹ã€‚

### 3.6 æ·±åº¦å¢žå¼ºè§‚å¯Ÿä¸­å¿ƒåŠ¨é‡

**3Dè¿åŠ¨æ–¹å‘ä¸€è‡´æ€§**ï¼š
$$\text{Mo}_3D = \frac{v_{3D} \cdot \Delta p_{3D}}{\|v_{3D}\| \cdot \|\Delta p_{3D}\|}$$

å…¶ä¸­ $v_{3D}$ æ˜¯3Dé€Ÿåº¦å‘é‡ï¼Œ$\Delta p_{3D}$ æ˜¯3Dä½ç½®å˜åŒ–ã€‚

**èžåˆå…³è”åˆ†æ•°**ï¼š
$$\mathcal{C}_{total} = w_1 \cdot \text{IoU}_{3D} + w_2 \cdot \text{Mo}_{3D} + w_3 \cdot \text{App}$$

å…¶ä¸­Appæ˜¯å¤–è§‚ç›¸ä¼¼åº¦ã€‚

---

## ðŸ§ª å®žéªŒä¸Žç»“æžœ

### æ•°æ®é›†

| æ•°æ®é›† | åœºæ™¯ | ç‰¹ç‚¹ |
|--------|------|------|
| MOT17 | è¡—é“ | ä¸­ç­‰å¯†åº¦ã€éƒ¨åˆ†é®æŒ¡ |
| MOT20 | è¡—é“ | é«˜å¯†åº¦ã€ä¸¥é‡é®æŒ¡ |
| DanceTrack | èˆžè¹ˆ | å¤æ‚è¿åŠ¨ã€é¢‘ç¹äº¤äº’ |

### ä¸»å®žéªŒç»“æžœ

| æ–¹æ³• | MOT17 HOTA | MOT20 HOTA | DanceTrack HOTA |
|------|------------|------------|----------------|
| ByteTrack | 61.2% | 59.8% | 52.3% |
| OC-SORT | 63.5% | 62.1% | 55.7% |
| Bot-SORT | 65.8% | 64.3% | 58.2% |
| **GRASPTrack** | **67.4%** | **66.1%** | **61.5%** |

**æ€§èƒ½æå‡**ï¼š
- vs ByteTrack: +6.2% HOTA (MOT17)
- vs Bot-SORT: +1.8% HOTA (DanceTrack)

### é®æŒ¡åœºæ™¯æ€§èƒ½

| é®æŒ¡çº§åˆ« | IDF1 | IDåˆ‡æ¢ | FPS |
|---------|------|-------|-----|
| è½»åº¦ | 85.3% | 12 | 18.5 |
| ä¸­åº¦ | 78.7% | 45 | 17.2 |
| é‡åº¦ | 71.2% | 89 | 16.8 |

**åˆ†æž**ï¼šå³ä½¿åœ¨é‡åº¦é®æŒ¡ä¸‹ï¼ŒGRASPTrackä»ä¿æŒè¾ƒé«˜æ€§èƒ½ã€‚

### æ¶ˆèžå®žéªŒ

| é…ç½® | HOTA | IDF1 | å˜åŒ– |
|-----|------|------|------|
| å®Œæ•´GRASPTrack | 67.4% | 77.2% | - |
| -3Dä½“ç´ åŒ–IoU | 64.1% | 73.5% | -3.3% |
| -è‡ªé€‚åº”å™ªå£°è¡¥å¿ | 65.8% | 75.1% | -1.6% |
| -æ·±åº¦å¢žå¼ºåŠ¨é‡ | 66.3% | 76.0% | -1.1% |

**åˆ†æž**ï¼š3Dä½“ç´ åŒ–IoUè´¡çŒ®æœ€å¤§ï¼Œè¯æ˜Žå‡ ä½•æŽ¨ç†çš„é‡è¦æ€§ã€‚

---

## ðŸ“ˆ æŠ€æœ¯æ¼”è¿›è„‰ç»œ

```
2016: SORT (Simple Online and Realtime Tracking)
  â†“ å¡å°”æ›¼æ»¤æ³¢+åŒˆç‰™åˆ©ç®—æ³•
2018: DeepSORT (Appearance Feature Embedding)
  â†“ å¤–è§‚ç‰¹å¾è¾…åŠ©
2021: JDE (Joint Detection and Embedding)
  â†“ è”åˆæ£€æµ‹å’ŒåµŒå…¥å­¦ä¹ 
2022: ByteTrack (High Score Detection First)
  â†“ ç½®ä¿¡åº¦å…³è”ç­–ç•¥
2023: OC-SORT (Observation-Centric SORT)
  â†“ è§‚å¯Ÿä¸­å¿ƒå»ºæ¨¡
2025: GRASPTrack (æœ¬æ–‡)
  â†“ 3Då‡ ä½•æŽ¨ç†+æ·±åº¦æ„ŸçŸ¥
```

---

## ðŸ”— ä¸Šä¸‹æ¸¸å…³ç³»

### ä¸Šæ¸¸ä¾èµ–

- **YOLO/X**: 2Dç›®æ ‡æ£€æµ‹å™¨
- **DPT/MiDaS**: å•ç›®æ·±åº¦ä¼°è®¡
- **Mask R-CNN**: å®žä¾‹åˆ†å‰²
- **å¡å°”æ›¼æ»¤æ³¢**: çŠ¶æ€ä¼°è®¡åŸºç¡€

### ä¸‹æ¸¸å½±å“

- æŽ¨åŠ¨3Dæ„ŸçŸ¥MOTå‘å±•
- ä¸ºé®æŒ¡å¤„ç†æä¾›æ–°æ€è·¯
- ä¿ƒè¿›å‡ ä½•æŽ¨ç†åœ¨è·Ÿè¸ªä¸­çš„åº”ç”¨

### ä¸Žå…¶ä»–è®ºæ–‡è”ç³»

| è®ºæ–‡ | è”ç³» |
|-----|------|
| DetectCloserSurfaces | éƒ½æ¶‰åŠ3Dæ£€æµ‹ï¼ˆGRASPTrackï¼š3Dè·Ÿè¸ªï¼ŒDCSï¼š3Dæ£€æµ‹ï¼‰|
| CornerPoint3D | éƒ½å¤„ç†3Dç©ºé—´æ„ŸçŸ¥ |

---

## âš™ï¸ å¯å¤çŽ°æ€§åˆ†æž

### å®žçŽ°ç»†èŠ‚

| ç»„ä»¶ | é…ç½® |
|-----|------|
| æ£€æµ‹å™¨ | YOLOX |
| æ·±åº¦ä¼°è®¡ | DPT-Hybrid |
| å®žä¾‹åˆ†å‰² | Mask R-CNN |
| ä½“ç´ åˆ†è¾¨çŽ‡ | 32Ã—32Ã—32 |
| å¡å°”æ›¼æ»¤æ³¢ | 3Då¸¸é€Ÿæ¨¡åž‹ |

### ä»£ç å®žçŽ°è¦ç‚¹

```python
import torch
import torch.nn as nn

class Voxelizer(nn.Module):
    def __init__(self, voxel_size=0.1, grid_size=32):
        super().__init__()
        self.voxel_size = voxel_size
        self.grid_size = grid_size

    def forward(self, points_3d):
        """
        points_3d: (N, 3) tensor of 3D points
        Returns: (grid_size, grid_size, grid_size) voxel grid
        """
        # å½’ä¸€åŒ–åˆ°ä½“ç´ ç½‘æ ¼
        coords = (points_3d / self.voxel_size).long()
        coords = coords - coords.min(dim=0)[0]

        # åˆ›å»ºä½“ç´ ç½‘æ ¼
        voxel_grid = torch.zeros(self.grid_size, self.grid_size, self.grid_size,
                                  device=points_3d.device)

        # å¡«å……ä½“ç´ 
        valid = (coords >= 0) & (coords < self.grid_size)
        valid = valid.all(dim=1)
        coords = coords[valid]

        voxel_grid[coords[:, 0], coords[:, 1], coords[:, 2]] = 1

        return voxel_grid

class VoxelIoU(nn.Module):
    def __init__(self):
        super().__init__()

    def forward(self, voxel1, voxel2):
        """
        Calculate 3D IoU between two voxel grids
        """
        intersection = (voxel1 * voxel2).sum()
        union = (voxel1 + voxel2).clamp(0, 1).sum()

        iou = intersection / (union + 1e-6)
        return iou

class DepthAwareNoiseCompensation(nn.Module):
    def __init__(self, base_Q=0.1, alpha=0.5):
        super().__init__()
        self.base_Q = base_Q
        self.alpha = alpha

    def __call__(self, occlusion_level):
        """
        Adjust process noise based on occlusion
        occlusion_level: 0 (no occlusion) to 1 (fully occluded)
        """
        Q = self.base_Q * (1 + self.alpha * occlusion_level)
        return Q

class GRASPTrack(nn.Module):
    def __init__(self):
        super().__init__()
        self.voxelizer = Voxelizer()
        self.voxel_iou = VoxelIoU()
        self.noise_comp = DepthAwareNoiseCompensation()

    def forward(self, detections, depth_maps, tracks):
        """
        detections: list of bounding boxes
        depth_maps: depth estimation
        tracks: existing tracklets
        """
        # Generate 3D point clouds
        point_clouds = self.generate_point_clouds(detections, depth_maps)

        # Voxelize
        voxels = [self.voxelizer(pc) for pc in point_clouds]

        # Calculate 3D IoU for association
        iou_matrix = self.calculate_iou_matrix(voxels, tracks)

        # Depth-aware noise compensation
        occlusion_levels = self.estimate_occlusion(detections, depth_maps)
        noise_matrices = [self.noise_comp(occ) for occ in occlusion_levels]

        # Association with Kalman filter
        matched_tracks, unmatched_dets = self.associate(
            detections, tracks, iou_matrix, noise_matrices
        )

        return matched_tracks, unmatched_dets

    def generate_point_clouds(self, detections, depth_maps):
        """Generate 3D point clouds from 2D detections and depth"""
        point_clouds = []
        for det, depth in zip(detections, depth_maps):
            # Extract depth values within detection box
            # Apply instance segmentation mask if available
            # Back-project to 3D using camera intrinsics
            pc = self.backproject(det, depth)
            point_clouds.append(pc)
        return point_clouds
```

---

## ðŸ“ åˆ†æžç¬”è®°

```
ä¸ªäººç†è§£ï¼š

1. GRASPTrackçš„æ ¸å¿ƒåˆ›æ–°æ˜¯3Då‡ ä½•æŽ¨ç†ï¼š
   - ä¼ ç»ŸMOTä»…ç”¨2D IoUï¼Œåœ¨é®æŒ¡æ—¶å¤±æ•ˆ
   - GRASPTrackç”Ÿæˆ3Dç‚¹äº‘ï¼Œåœ¨3Dç©ºé—´å…³è”
   - è¿™å¯¹é®æŒ¡åœºæ™¯ç‰¹åˆ«æœ‰æ•ˆ

2. æŠ€æœ¯ä¼˜åŠ¿ï¼š
   - æ— éœ€é¢å¤–æ ‡æ³¨æ•°æ®ï¼ˆåˆ©ç”¨çŽ°æˆæ·±åº¦ä¼°è®¡æ¨¡åž‹ï¼‰
   - å¯é›†æˆåˆ°ä»»æ„TBDæ¡†æž¶
   - å¯¹é®æŒ¡å’Œå¤æ‚è¿åŠ¨é²æ£’

3. ä¸ŽDetectCloserSurfacesçš„è”ç³»ï¼š
   - DCSç”¨äºŽ3Dç›®æ ‡æ£€æµ‹
   - GRASPTrackç”¨äºŽ3Dç›®æ ‡è·Ÿè¸ª
   - ä¸¤è€…éƒ½å¼ºè°ƒ3Då‡ ä½•æ„ŸçŸ¥

4. æ·±åº¦æ„ŸçŸ¥å™ªå£°è¡¥å¿çš„å·§å¦™ä¹‹å¤„ï¼š
   - é®æŒ¡æ—¶å¢žåŠ è¿‡ç¨‹å™ªå£°
   - ä½¿æ»¤æ³¢å™¨æ›´ä¾èµ–è§‚æµ‹
   - å‡å°‘IDåˆ‡æ¢

5. è®¡ç®—å¼€é”€ï¼š
   - æ·±åº¦ä¼°è®¡ï¼š~30ms
   - ä½“ç´ åŒ–ï¼š~5ms
   - æ€»ä½“ï¼š~16-18 FPS

6. æœªæ¥æ–¹å‘ï¼š
   - ç«¯åˆ°ç«¯è®­ç»ƒæ·±åº¦ä¼°è®¡å’Œè·Ÿè¸ª
   - å¤šç›¸æœºæ‰©å±•
   - å®žæ—¶ä¼˜åŒ–
```

---

## ç»¼åˆè¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜Ž |
|------|------|------|
| ç†è®ºæ·±åº¦ | â˜…â˜…â˜…â˜†â˜† | æ•°å­¦å»ºæ¨¡æ¸…æ™° |
| æ–¹æ³•åˆ›æ–° | â˜…â˜…â˜…â˜…â˜… | 3Då‡ ä½•æŽ¨ç†+æ·±åº¦æ„ŸçŸ¥åˆ›æ–° |
| å®žçŽ°éš¾åº¦ | â˜…â˜…â˜…â˜†â˜† | å¯é›†æˆçŽ°æœ‰æ¡†æž¶ |
| åº”ç”¨ä»·å€¼ | â˜…â˜…â˜…â˜…â˜… | é®æŒ¡åœºæ™¯ä»·å€¼é«˜ |
| è®ºæ–‡è´¨é‡ | â˜…â˜…â˜…â˜…â˜† | å®žéªŒå……åˆ† |

**æ€»åˆ†ï¼šâ˜…â˜…â˜…â˜…â˜† (4.2/5.0)**

---

*æœ¬ç¬”è®°ç”±5-Agentè¾©è®ºåˆ†æžç³»ç»Ÿç”Ÿæˆï¼Œç»“åˆäº†å¤šæ™ºèƒ½ä½“ç²¾è¯»æŠ¥å‘Šå†…å®¹ã€‚*
