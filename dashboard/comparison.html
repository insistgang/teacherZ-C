<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç ”ç©¶ä»ªè¡¨ç›˜ - å¯¹æ¯”åˆ†æ</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <aside class="sidebar">
    <div class="sidebar-header">
      <h1>ç ”ç©¶ä»ªè¡¨ç›˜</h1>
    </div>
    <nav class="sidebar-nav">
      <a href="dashboard.html" class="nav-item">ğŸ“Š æ¦‚è§ˆ</a>
      <a href="papers.html" class="nav-item">ğŸ“„ è®ºæ–‡åˆ†æ</a>
      <a href="network.html" class="nav-item">ğŸ”— å¼•ç”¨ç½‘ç»œ</a>
      <a href="timeline.html" class="nav-item">ğŸ“… æ—¶åºåˆ†æ</a>
      <a href="collaborators.html" class="nav-item">ğŸ‘¥ åˆä½œè€…åˆ†æ</a>
      <a href="heatmap.html" class="nav-item">ğŸ”¥ çƒ­åŠ›å›¾</a>
      <a href="comparison.html" class="nav-item active">âš–ï¸ å¯¹æ¯”åˆ†æ</a>
    </nav>
  </aside>

  <main class="main-content">
    <header class="header">
      <h2 class="page-title">å¯¹æ¯”åˆ†æ</h2>
      <div class="header-actions">
        <button class="theme-toggle">ğŸŒ™</button>
      </div>
    </header>

    <div class="comparison-grid" id="comparisonCards"></div>

    <div class="charts-grid" style="margin-top: 30px;">
      <div class="chart-card">
        <div class="chart-card-header">
          <h3 class="chart-card-title">ç»¼åˆèƒ½åŠ›å¯¹æ¯” (é›·è¾¾å›¾)</h3>
        </div>
        <div class="chart-container large">
          <canvas id="radarChart"></canvas>
        </div>
      </div>
      <div class="chart-card">
        <div class="chart-card-header">
          <h3 class="chart-card-title">æŒ‡æ ‡å¯¹æ¯” (æŸ±çŠ¶å›¾)</h3>
        </div>
        <div class="chart-container large">
          <canvas id="barChart"></canvas>
        </div>
      </div>
    </div>

    <div class="chart-card" style="margin-top: 30px;">
      <div class="chart-card-header">
        <h3 class="chart-card-title">å„é¢†åŸŸè´¡çŒ®å¯¹æ¯”</h3>
      </div>
      <div class="chart-container large">
        <canvas id="fieldContributionChart"></canvas>
      </div>
    </div>

    <div class="chart-card" style="margin-top: 30px;">
      <div class="chart-card-header">
        <h3 class="chart-card-title">å¢é•¿è¶‹åŠ¿å¯¹æ¯”</h3>
      </div>
      <div class="chart-container large">
        <canvas id="growthChart"></canvas>
      </div>
    </div>
  </main>

  <script src="js/data.js"></script>
  <script src="js/charts.js"></script>
  <script src="js/main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const peers = ResearchData.comparisonPeers;
      const profile = ResearchData.profile;

      const cardsContainer = document.getElementById('comparisonCards');
      cardsContainer.innerHTML = peers.map(p => `
        <div class="comparison-card">
          <div class="comparison-header">
            <div class="comparison-avatar" style="background: ${p.name === 'è‡ªå·±' ? '#3b82f6' : '#64748b'}">${p.name[0]}</div>
            <div>
              <h4 style="font-weight: 600;">${p.name}</h4>
              <span style="font-size: 0.85rem; color: var(--text-secondary);">${p.field}</span>
            </div>
          </div>
          <div class="comparison-stats">
            <div class="comparison-stat">
              <div class="comparison-stat-value">${p.papers}</div>
              <div class="comparison-stat-label">è®ºæ–‡æ•°</div>
            </div>
            <div class="comparison-stat">
              <div class="comparison-stat-value">${Utils.formatNumber(p.citations)}</div>
              <div class="comparison-stat-label">å¼•ç”¨æ•°</div>
            </div>
            <div class="comparison-stat">
              <div class="comparison-stat-value">${p.hIndex}</div>
              <div class="comparison-stat-label">H-Index</div>
            </div>
            <div class="comparison-stat">
              <div class="comparison-stat-value">${(p.citations / p.papers).toFixed(1)}</div>
              <div class="comparison-stat-label">ç¯‡å‡å¼•ç”¨</div>
            </div>
          </div>
        </div>
      `).join('');

      createComparisonRadarChart('radarChart', peers);

      const barCtx = document.getElementById('barChart');
      new Chart(barCtx, {
        type: 'bar',
        data: {
          labels: peers.map(p => p.name),
          datasets: [
            {
              label: 'è®ºæ–‡æ•°',
              data: peers.map(p => p.papers),
              backgroundColor: '#3b82f6',
              borderRadius: 4
            },
            {
              label: 'H-Index',
              data: peers.map(p => p.hIndex),
              backgroundColor: '#10b981',
              borderRadius: 4
            }
          ]
        },
        options: {
          ...ChartConfigs.bar,
          plugins: {
            legend: { position: 'bottom' }
          }
        }
      });

      const fields = ResearchData.fields.slice(0, 6);
      const fieldCtx = document.getElementById('fieldContributionChart');
      new Chart(fieldCtx, {
        type: 'bar',
        data: {
          labels: fields,
          datasets: peers.map((p, i) => ({
            label: p.name,
            data: fields.map(() => Math.floor(Math.random() * 20) + 5),
            backgroundColor: ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6'][i],
            borderRadius: 4
          }))
        },
        options: {
          ...ChartConfigs.bar,
          plugins: {
            legend: { position: 'bottom' }
          },
          scales: {
            ...ChartConfigs.bar.scales,
            x: { stacked: true },
            y: { stacked: true }
          }
        }
      });

      const years = ['2019', '2020', '2021', '2022', '2023', '2024'];
      const growthCtx = document.getElementById('growthChart');
      new Chart(growthCtx, {
        type: 'line',
        data: {
          labels: years,
          datasets: peers.map((p, i) => ({
            label: p.name + ' å¼•ç”¨å¢é•¿',
            data: years.map((_, j) => Math.floor(p.citations * (0.3 + j * 0.12) * (0.8 + Math.random() * 0.4))),
            borderColor: ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6'][i],
            backgroundColor: 'transparent',
            tension: 0.4,
            pointRadius: 4
          }))
        },
        options: {
          ...ChartConfigs.line,
          plugins: {
            legend: { position: 'bottom' }
          }
        }
      });
    });
  </script>
</body>
</html>
