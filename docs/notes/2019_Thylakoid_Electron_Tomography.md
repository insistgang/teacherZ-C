# Thylakoid Membrane Architecture in 3D: Electron Tomography Analysis

> **è¶…ç²¾è¯»ç¬”è®°** | è®ºæ–‡ç²¾è¯»ç³»ç»Ÿ
> **çŠ¶æ€**: å·²å®Œæˆè¡¥å……
> **è¡¥å……æ—¶é—´**: 2026-02-19

---

## ğŸ“‹ åŸºæœ¬ä¿¡æ¯

| å±æ€§ | ä¿¡æ¯ |
|------|------|
| **æ ‡é¢˜** | Thylakoid Membrane Architecture in 3D: Electron Tomography Analysis |
| **ä¸­æ–‡æ ‡é¢˜** | å¶ç»¿ä½“ç±»å›Šä½“è†œ3Dç»“æ„ï¼šç”µå­æ–­å±‚æ‰«æåˆ†æ |
| **ä½œè€…** | Xiaohao Cai, E.J. Boekema, et al. |
| **å¹´ä»½** | 2019 |
| **æœŸåˆŠ** | Frontiers in Plant Science |
| **é¢†åŸŸ** | ç”Ÿç‰©æˆåƒ / ç»†èƒç”Ÿç‰©å­¦ / å›¾åƒå¤„ç† |
| **XCè§’è‰²** | ç¬¬ä¸€ä½œè€… (First Author) / å…±åŒç¬¬ä¸€ä½œè€… |

---

## æ‘˜è¦

å¶ç»¿ä½“ä¸­çš„ç±»å›Šä½“è†œæ˜¯å…‰åˆä½œç”¨å‘ç”Ÿçš„åœºæ‰€ï¼Œå…¶3Dç»“æ„å¯¹äºç†è§£å…‰åˆä½œç”¨æœºåˆ¶è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œç”±äºç±»å›Šä½“è†œç»“æ„çš„å¤æ‚æ€§å’Œçº³ç±³å°ºåº¦ï¼Œä¼ ç»Ÿçš„äºŒç»´ç”µå­æ˜¾å¾®é•œæŠ€æœ¯éš¾ä»¥æ­ç¤ºå…¶å®Œæ•´çš„ä¸‰ç»´ç»“æ„ã€‚

æœ¬æ–‡é‡‡ç”¨**ç”µå­æ–­å±‚æ‰«ææŠ€æœ¯ï¼ˆElectron Tomography, ETï¼‰**ç»“åˆå…ˆè¿›çš„å›¾åƒå¤„ç†ç®—æ³•ï¼Œé¦–æ¬¡åœ¨3Dç©ºé—´ä¸­å®Œæ•´é‡å»ºäº†é«˜ç­‰æ¤ç‰©å¶ç»¿ä½“ç±»å›Šä½“è†œçš„è¶…å¾®ç»“æ„ã€‚ç ”ç©¶æ­ç¤ºäº†åŸºç²’å †å ï¼ˆgrana stacksï¼‰ä¸åŸºè´¨ç‰‡å±‚ï¼ˆstroma lamellaeï¼‰ä¹‹é—´çš„å¤æ‚è¿æ¥æ–¹å¼ï¼Œå‘ç°äº†ä¸€äº›å‰æ‰€æœªè§çš„ç»“æ„ç‰¹å¾ã€‚è¿™äº›å‘ç°ä¸ºç†è§£å…‰ç³»ç»Ÿåœ¨ç±»å›Šä½“è†œä¸­çš„ç©ºé—´ç»„ç»‡å’ŒåŠŸèƒ½è°ƒæ§æä¾›äº†é‡è¦çº¿ç´¢ã€‚

---

## æ ¸å¿ƒè´¡çŒ®ï¼ˆ3å¥è¯ä»¥å†…ï¼‰

1. **è§£å†³çš„é—®é¢˜**ï¼šä¼ ç»ŸäºŒç»´ç”µé•œæ— æ³•å®Œæ•´å‘ˆç°ç±»å›Šä½“è†œå¤æ‚3Dç»“æ„çš„éš¾é¢˜
2. **æå‡ºçš„æ–¹æ³•**ï¼šç”µå­æ–­å±‚æ‰«æç»“åˆæ”¹è¿›çš„å¯¹é½ä¸é‡å»ºç®—æ³•ï¼Œå®ç°ç±»å›Šä½“è†œé«˜åˆ†è¾¨ç‡3Då¯è§†åŒ–
3. **è¾¾åˆ°çš„æ•ˆæœ**ï¼šé¦–æ¬¡å®Œæ•´æ­ç¤ºåŸºç²’-åŸºè´¨ç‰‡å±‚è¿æ¥çš„å¤æ‚æ‹“æ‰‘ç»“æ„ï¼Œåˆ†è¾¨ç‡è¾¾åˆ°4çº³ç±³

---

## æ–¹æ³•è®ºæ‹†è§£

### è¾“å…¥è¾“å‡ºå®šä¹‰

**è¾“å…¥ï¼š**
- å€¾æ–œç³»åˆ—ç”µå­æ˜¾å¾®é•œå›¾åƒ $I_1, I_2, ..., I_n$
- å€¾æ–œè§’åº¦èŒƒå›´ï¼š-60Â° åˆ° +60Â°
- å€¾æ–œè§’åº¦é—´éš”ï¼š1Â°-2Â°
- å›¾åƒåˆ†è¾¨ç‡ï¼š4096Ã—4096 åƒç´ 

**è¾“å‡ºï¼š**
- 3Dé‡å»ºä½“ç§¯ $V(x, y, z) \in \mathbb{R}^{N_x \times N_y \times N_z}$
- ç±»å›Šä½“è†œåˆ†å‰²ç»“æœ
- ç»“æ„å®šé‡åˆ†æå‚æ•°

### æ ¸å¿ƒæ¨¡å—

#### 1. æ ·å“åˆ¶å¤‡ä¸æ•°æ®é‡‡é›†

**é«˜å‹å†·å†»å›ºå®šï¼ˆHigh-Pressure Freezingï¼‰ï¼š**
```
æ ·å“å‡†å¤‡
    â†“
é«˜å‹å†·å†»ï¼ˆ2100 bar, -196Â°Cï¼‰
    â†“
å†·å†»æ›¿ä»£ï¼ˆç”²é†‡+ OsOâ‚„ï¼‰
    â†“
ç¯æ°§æ ‘è„‚åŒ…åŸ‹
    â†“
è¶…è–„åˆ‡ç‰‡ï¼ˆ200-300 nmï¼‰
```

**å€¾æ–œç³»åˆ—é‡‡é›†ï¼š**
- æ˜¾å¾®é•œï¼šFEI Tecnai 20/30
- åŠ é€Ÿç”µå‹ï¼š200 kV
- CCDç›¸æœºï¼š4096Ã—4096
- åƒç´ å°ºå¯¸ï¼š1-2 nm
- å€¾æ–œèŒƒå›´ï¼šÂ±60Â°
- å€¾æ–œå¢é‡ï¼š1Â°æˆ–2Â°

#### 2. å›¾åƒé¢„å¤„ç†ä¸å¯¹é½

**é‡‘é¢—ç²’æ ‡è®°å¯¹é½ï¼ˆFiducial Marker Alignmentï¼‰ï¼š**

è®¾é‡‘é¢—ç²’ä¸­å¿ƒåæ ‡ä¸º $c_i^{(j)}$ï¼Œç¬¬ $j$ å¼ å›¾åƒä¸­ç¬¬ $i$ ä¸ªé‡‘é¢—ç²’

**å˜æ¢æ¨¡å‹ï¼š**
$$T_j = R_j \cdot S_j \cdot t_j$$

å…¶ä¸­ï¼š
- $R_j$ï¼šæ—‹è½¬çŸ©é˜µ
- $S_j$ï¼šç¼©æ”¾çŸ©é˜µ
- $t_j$ï¼šå¹³ç§»å‘é‡

**å¯¹é½ä¼˜åŒ–ç›®æ ‡ï¼š**
$$\min_{T_1,...,T_n} \sum_{j=1}^{n} \sum_{i=1}^{m} ||T_j(c_i^{(j)}) - c_i^{(1)}||^2$$

#### 3. ç”µå­æ–­å±‚é‡å»º

**åŠ æƒåæŠ•å½±æ³•ï¼ˆWeighted Back Projection, WBPï¼‰ï¼š**

$$f(x,y,z) = \int_{-\pi/2}^{\pi/2} p_\theta(x \cos\theta + z \sin\theta, y) \cdot w(\theta) d\theta$$

å…¶ä¸­ï¼š
- $p_\theta$ï¼šè§’åº¦ $\theta$ ä¸Šçš„æŠ•å½±
- $w(\theta) = |\cos\theta|$ï¼šæƒé‡å‡½æ•°

**åŒæ­¥è¿­ä»£é‡å»ºæŠ€æœ¯ï¼ˆSIRTï¼‰ï¼š**

è¿­ä»£å…¬å¼ï¼š
$$f^{(k+1)} = f^{(k)} + \lambda \cdot \sum_{\theta} \frac{p_\theta - R_\theta f^{(k)}}{R_\theta 1}$$

å…¶ä¸­ï¼š
- $R_\theta$ï¼šRadonå˜æ¢ç®—å­
- $\lambda$ï¼šæ¾å¼›å‚æ•°

#### 4. å»å™ªä¸å¢å¼º

**å„å‘å¼‚æ€§æ‰©æ•£æ»¤æ³¢ï¼š**

$$\frac{\partial I}{\partial t} = \text{div}(c(x,y,t) \nabla I)$$

æ‰©æ•£ç³»æ•°ï¼š
$$c(||\nabla I||) = \frac{1}{1 + (||\nabla I||/K)^2}$$

å…¶ä¸­ $K$ æ˜¯æ¢¯åº¦é˜ˆå€¼å‚æ•°ã€‚

#### 5. è†œç»“æ„åˆ†å‰²

**æ°´å¹³é›†æ–¹æ³•ï¼ˆLevel Set Methodï¼‰ï¼š**

å®šä¹‰æ°´å¹³é›†å‡½æ•° $\phi(x,y,z)$ï¼š
$$\begin{cases}
\phi > 0 & \text{ç›®æ ‡å†…éƒ¨} \\
\phi = 0 & \text{è¾¹ç•Œ} \\
\phi < 0 & \text{ç›®æ ‡å¤–éƒ¨}
\end{cases}$$

æ¼”åŒ–æ–¹ç¨‹ï¼š
$$\frac{\partial \phi}{\partial t} = \delta(\phi) \left[ \mu \text{div}\left(\frac{\nabla \phi}{|\nabla \phi|}\right) + \nu + \lambda_1(I - c_1)^2 - \lambda_2(I - c_2)^2 \right]$$

#### 6. å®šé‡åˆ†æ

**è†œæ›²ç‡è®¡ç®—ï¼š**

ä¸»æ›²ç‡ $\kappa_1, \kappa_2$ é€šè¿‡HessiançŸ©é˜µç‰¹å¾å€¼è®¡ç®—ï¼š
$$H = \begin{bmatrix}
\frac{\partial^2 f}{\partial x^2} & \frac{\partial^2 f}{\partial x \partial y} & \frac{\partial^2 f}{\partial x \partial z} \\
\frac{\partial^2 f}{\partial y \partial x} & \frac{\partial^2 f}{\partial y^2} & \frac{\partial^2 f}{\partial y \partial z} \\
\frac{\partial^2 f}{\partial z \partial x} & \frac{\partial^2 f}{\partial z \partial y} & \frac{\partial^2 f}{\partial z^2}
\end{bmatrix}$$

**é«˜æ–¯æ›²ç‡ï¼š** $K = \kappa_1 \cdot \kappa_2$
**å¹³å‡æ›²ç‡ï¼š** $H = \frac{\kappa_1 + \kappa_2}{2}$

### åˆ›æ–°ç‚¹ vs å·²æœ‰å·¥ä½œ

| ç»´åº¦ | ä¼ ç»Ÿæ–¹æ³• | æœ¬æ–‡æ–¹æ³• |
|------|----------|----------|
| æˆåƒç»´åº¦ | 2Dåˆ‡ç‰‡ | 3Dæ–­å±‚æ‰«æ |
| å¯¹é½ç²¾åº¦ | äº¤å‰ç›¸å…³ | å¤šç§å¯¹é½æ–¹æ³•ç»„åˆ |
| å»å™ªæ–¹æ³• | é«˜æ–¯æ»¤æ³¢ | å„å‘å¼‚æ€§æ‰©æ•£ |
| åˆ†å‰²æ–¹æ³• | æ‰‹åŠ¨è¿½è¸ª | åŠè‡ªåŠ¨æ°´å¹³é›† |
| åˆ†è¾¨ç‡ | ~5-10 nm | ~4 nm |

---

## å®éªŒè®¾è®¡

### æ•°æ®é›†

**æ ·å“æ¥æºï¼š**
- æ¤ç‰©ææ–™ï¼šè èœï¼ˆSpinacia oleraceaï¼‰
- ç”Ÿé•¿æ¡ä»¶ï¼š8å°æ—¶å…‰ç…§/16å°æ—¶é»‘æš—
- å¶ç»¿ä½“åˆ†ç¦»ï¼šå·®é€Ÿç¦»å¿ƒæ³•
- æ ·å“æ•°é‡ï¼š15ä¸ªå®Œæ•´å¶ç»¿ä½“æ•°æ®é›†

**æˆåƒå‚æ•°ï¼š**
| å‚æ•° | å€¼ |
|------|-----|
| åŠ é€Ÿç”µå‹ | 200 kV |
| æ”¾å¤§å€æ•° | 30,000Ã— - 50,000Ã— |
| åƒç´ å°ºå¯¸ | 1.2 - 2.0 nm |
| å€¾æ–œèŒƒå›´ | Â±60Â° |
| å€¾æ–œå¢é‡ | 1Â°æˆ–2Â° |
| æ€»å›¾åƒæ•°/æ ·å“ | 61-121å¼  |

### å¯¹æ¯”æ–¹æ³•

1. **ä¼ ç»Ÿ2D TEM**ï¼šé€å°„ç”µå­æ˜¾å¾®é•œ
2. **Serial Section TEM**ï¼šè¿ç»­åˆ‡ç‰‡é€å°„ç”µé•œ
3. **ä¼ ç»ŸWBPé‡å»º**ï¼šæ ‡å‡†åŠ æƒåæŠ•å½±
4. **SIRTé‡å»º**ï¼šåŒæ­¥è¿­ä»£é‡å»ºæŠ€æœ¯
5. **IMODè½¯ä»¶**ï¼šæ ‡å‡†ç”µé•œæ–­å±‚é‡å»ºè½¯ä»¶

### è¯„ä¼°æŒ‡æ ‡

| æŒ‡æ ‡ | å®šä¹‰ | è¯´æ˜ |
|------|------|------|
| åˆ†è¾¨ç‡ | FFTåˆ†æç¡®å®š | 3Dç©ºé—´åˆ†è¾¨ç‡ |
| SNR | ä¿¡å™ªæ¯” | å›¾åƒè´¨é‡è¡¡é‡ |
| è†œè¿ç»­æ€§ | å¯è§†åŒ–è¯„åˆ† | ç»“æ„å®Œæ•´æ€§ |
| æ›²ç‡åˆ†å¸ƒ | ç»Ÿè®¡åˆ†æ | ç»“æ„å‡ ä½•ç‰¹å¾ |

### å…³é”®ç»“æœæ•°å­—

**åˆ†è¾¨ç‡å¯¹æ¯”ï¼š**

| æ–¹æ³• | æ¨ªå‘åˆ†è¾¨ç‡ | çºµå‘åˆ†è¾¨ç‡ | SNR |
|------|-----------|-----------|-----|
| 2D TEM | 2 nm | N/A | 12.5 |
| Serial Section | 3 nm | 50 nm | 8.2 |
| WBP | 4.2 nm | 6.8 nm | 6.8 |
| SIRT | 4.8 nm | 7.2 nm | 9.5 |
| **æœ¬æ–‡æ–¹æ³•** | **4.0 nm** | **6.5 nm** | **11.2** |

**ç»“æ„å‘ç°ï¼š**

| ç»“æ„ç‰¹å¾ | ä¼ ç»Ÿè®¤è¯† | æœ¬æ–‡å‘ç° |
|----------|----------|----------|
| åŸºç²’ç›´å¾„ | 300-600 nm | 420 Â± 85 nm |
| åŸºç²’å±‚æ•° | 2-20å±‚ | 8.3 Â± 3.1å±‚ |
| è†œé—´è· | 2-4 nm | 3.2 Â± 0.6 nm |
| è¿æ¥é¢‘ç‡ | ç¨€ç– | æ¯10Â°ä¸€ä¸ªè¿æ¥ |

**å¤„ç†æ—¶é—´å¯¹æ¯”ï¼š**

| æ–¹æ³• | é¢„å¤„ç† | é‡å»º | åå¤„ç† | æ€»æ—¶é—´ |
|------|--------|------|--------|--------|
| ä¼ ç»Ÿæµç¨‹ | 30min | 2h | 1h | 3.5h |
| ä¼˜åŒ–æµç¨‹ | 15min | 45min | 30min | 1.5h |

---

## å±€é™æ€§ä¸æœªæ¥å·¥ä½œ

### å±€é™æ€§

1. **ç¼ºå¤±æ¥”ï¼ˆMissing Wedgeï¼‰é—®é¢˜**ï¼š
   - å€¾æ–œè§’åº¦é™åˆ¶ï¼ˆÂ±60Â°ï¼‰å¯¼è‡´Zè½´åˆ†è¾¨ç‡ä½äºXYå¹³é¢
   - éƒ¨åˆ†ç»“æ„ä¿¡æ¯ä¸¢å¤±

2. **è¾å°„æŸä¼¤**ï¼š
   - ç”µå­æŸç…§å°„å¯¼è‡´æ ·å“ç»“æ„å˜åŒ–
   - é™åˆ¶äº†æ€»æ›å…‰å‰‚é‡

3. **æ ·å“åšåº¦é™åˆ¶**ï¼š
   - æ ·å“åšåº¦éœ€ < 500 nm
   - æ›´åšæ ·å“éœ€è¿›è¡Œåˆ‡ç‰‡

4. **å¤„ç†æ—¶é—´**ï¼š
   - å•ä¸ªæ ·å“å®Œæ•´å¤„ç†éœ€1.5å°æ—¶
   - å¤§è§„æ¨¡æ•°æ®å¤„ç†æ•ˆç‡æœ‰å¾…æå‡

### æœªæ¥å·¥ä½œ

1. **æ·±åº¦å­¦ä¹ å¢å¼º**ï¼š
   - ä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œç¼ºå¤±æ¥”è¡¥å¿
   - AIè¾…åŠ©çš„è‡ªåŠ¨åˆ†å‰²

2. **å¤šå°ºåº¦æ•´åˆ**ï¼š
   - ç»“åˆå…‰å­¦æ˜¾å¾®é•œæ•°æ®
   - è·¨å°ºåº¦ç»“æ„å…³è”

3. **æ—¶é—´åˆ†è¾¨ç‡**ï¼š
   - æ´»ä½“æˆåƒæŠ€æœ¯æ¢ç´¢
   - åŠ¨æ€ç»“æ„å˜åŒ–è§‚å¯Ÿ

4. **åŠŸèƒ½å…³è”**ï¼š
   - è¶…å¾®ç»“æ„ä¸å…‰åˆåŠŸèƒ½å…³è”
   - ä¸åŒç”Ÿç†æ¡ä»¶ä¸‹çš„ç»“æ„å˜åŒ–

---

## ä¸XCå…¶ä»–è®ºæ–‡çš„å…³è”

### æ‰¿æ¥å…³ç³»

1. **å›¾åƒå¤„ç†æŠ€æœ¯æ‰¿æ¥**ï¼š
   - ä¸ã€ŠTight-Frame Vessel Segmentationã€‹ï¼ˆ2011ï¼‰å…±äº«å˜åˆ†åˆ†å‰²æ€æƒ³
   - å»å™ªç®—æ³•å€Ÿé‰´ã€ŠMumford-Shah and ROF Linkageã€‹ï¼ˆ2018ï¼‰

2. **3Då¤„ç†æŠ€æœ¯å»¶ç»­**ï¼š
   - ä¸ºåç»­ã€Š3D Orientation Field Transformã€‹ï¼ˆ2020ï¼‰æä¾›åŸºç¡€
   - ä¸ã€Š3D Tree Segmentationã€‹ï¼ˆ2019ï¼‰å…±äº«3Dåˆ†å‰²æ¡†æ¶

### è¢«å¼•ç”¨æƒ…å†µ

æœ¬æ–‡åœ¨åç»­XCå·¥ä½œä¸­è¢«å¼•ç”¨ï¼š
- ã€Š3D Growth Trajectory Reconstructionã€‹ï¼ˆ2025ï¼‰
- åŒ»å­¦å½±åƒé‡å»ºç›¸å…³è®ºæ–‡

### å…±äº«æ•°æ®é›†/æ–¹æ³•

- å›¾åƒé¢„å¤„ç†æµç¨‹ä¸XCå…¶ä»–ç”Ÿç‰©å½±åƒè®ºæ–‡ä¸€è‡´
- å®šé‡åˆ†ææ–¹æ³•è¢«åç»­å·¥ä½œé‡‡ç”¨

---

## å¯¹ä½ è®ºæ–‡çš„å¯ç¤ºï¼ˆè¿å»ºæ£€æµ‹/äº•ç›–æ£€æµ‹æ–¹å‘ï¼‰

### å¯å€Ÿé‰´ç‚¹

1. **3Dé‡å»ºæŠ€æœ¯**ï¼š
   - **åº”ç”¨åœºæ™¯**ï¼šä»å«æ˜Ÿ2Då›¾åƒé‡å»ºå»ºç­‘ç‰©3Dç»“æ„
   - **å€Ÿé‰´æ–¹æ³•**ï¼šå¤šè§’åº¦å›¾åƒåºåˆ—çš„3Dé‡å»ºç®—æ³•
   - **å®ç°æ–¹å¼**ï¼š
     ```python
     # ä»å¤šè§†è§’å«æ˜Ÿå›¾åƒè¿›è¡Œ3Dé‡å»º
     class MultiViewReconstruction:
         def __init__(self):
             self.views = []  # å­˜å‚¨ä¸åŒè§’åº¦å›¾åƒ

         def add_view(self, image, angle):
             """æ·»åŠ æ–°è§†è§’å›¾åƒ"""
             self.views.append((image, angle))

         def reconstruct_3d(self):
             """3Dä½“ç´ é‡å»º"""
             voxel_grid = np.zeros((H, W, D))
             for img, angle in self.views:
                 projection = self.project_to_voxel(img, angle)
                 voxel_grid += projection
             return voxel_grid
     ```

2. **ç¼ºå¤±ä¿¡æ¯è¡¥å¿**ï¼š
   - **åº”ç”¨åœºæ™¯**ï¼šå«æ˜Ÿå›¾åƒè¢«äº‘é®æŒ¡æˆ–è§†è§’å—é™
   - **å€Ÿé‰´æ–¹æ³•**ï¼šç±»ä¼¼"ç¼ºå¤±æ¥”"é—®é¢˜çš„è¡¥å¿ç­–ç•¥
   - **æŠ€æœ¯è·¯çº¿**ï¼š
     - å¤šæ—¶ç›¸æ•°æ®èåˆ
     - å…ˆéªŒå‡ ä½•çº¦æŸ
     - æ·±åº¦å­¦ä¹ å¡«å……

3. **å„å‘å¼‚æ€§æ‰©æ•£æ»¤æ³¢**ï¼š
   - **åº”ç”¨åœºæ™¯**ï¼šå»é™¤å™ªå£°åŒæ—¶ä¿æŒå»ºç­‘ç‰©è¾¹ç•Œ
   - **å€Ÿé‰´æ–¹æ³•**ï¼šè¾¹ç¼˜ä¿æŒçš„å„å‘å¼‚æ€§æ‰©æ•£
   - **å…¬å¼å®ç°**ï¼š
     ```python
     def anisotropic_diffusion(image, iterations=50, kappa=50, gamma=0.1):
         """å„å‘å¼‚æ€§æ‰©æ•£æ»¤æ³¢"""
         img = image.copy()
         for _ in range(iterations):
             # è®¡ç®—æ¢¯åº¦
             grad_n = np.roll(img, -1, axis=0) - img
             grad_s = np.roll(img, 1, axis=0) - img
             grad_e = np.roll(img, -1, axis=1) - img
             grad_w = np.roll(img, 1, axis=1) - img

             # è®¡ç®—æ‰©æ•£ç³»æ•°
             c_n = np.exp(-(grad_n/kappa)**2)
             c_s = np.exp(-(grad_s/kappa)**2)
             c_e = np.exp(-(grad_e/kappa)**2)
             c_w = np.exp(-(grad_w/kappa)**2)

             # æ›´æ–°å›¾åƒ
             img += gamma * (c_n*grad_n + c_s*grad_s + c_e*grad_e + c_w*grad_w)

         return img
     ```

4. **æ°´å¹³é›†åˆ†å‰²**ï¼š
   - **åº”ç”¨åœºæ™¯**ï¼šä¸è§„åˆ™å½¢çŠ¶è¿å»º/äº•ç›–çš„ç²¾ç¡®åˆ†å‰²
   - **å€Ÿé‰´æ–¹æ³•**ï¼šåŸºäºæ°´å¹³é›†çš„ä¸»åŠ¨è½®å»“æ¨¡å‹
   - **ä¼˜åŠ¿**ï¼šå¤„ç†æ‹“æ‰‘ç»“æ„å˜åŒ–ï¼Œæ— éœ€é¢„è®¾å½¢çŠ¶

5. **æ›²ç‡åˆ†æ**ï¼š
   - **åº”ç”¨åœºæ™¯**ï¼šå»ºç­‘ç‰©è½®å»“æ›²ç‡åˆ†æï¼Œè¯†åˆ«è§„åˆ™vsä¸è§„åˆ™å½¢çŠ¶
   - **å€Ÿé‰´æ–¹æ³•**ï¼šä»3Dé‡å»ºè®¡ç®—è¡¨é¢æ›²ç‡
   - **åº”ç”¨**ï¼š
     - æ›²ç‡å¼‚å¸¸æ£€æµ‹å¯ç–‘è¿å»º
     - è§„åˆ™å»ºç­‘ç‰©é€šå¸¸å…·æœ‰æ’å®šæ›²ç‡
     - è¿å»ºå¾€å¾€è¡¨ç°å‡ºä¸è§„åˆ™æ›²ç‡åˆ†å¸ƒ

### è¿å»ºæ£€æµ‹åº”ç”¨æ¡†æ¶

```python
class IllegalBuildingDetector:
    """å€Ÿé‰´ç”µå­æ–­å±‚æ‰«ææŠ€æœ¯çš„è¿å»ºæ£€æµ‹ç³»ç»Ÿ"""

    def __init__(self):
        self.reconstructor = MultiViewReconstruction()
        self.denoiser = AnisotropicDiffusion()
        self.segmenter = LevelSetSegmentation()
        self.analyzer = CurvatureAnalyzer()

    def process_satellite_images(self, image_sequence, angles):
        """å¤„ç†å«æ˜Ÿå›¾åƒåºåˆ—"""
        # 1. 3Dé‡å»º
        volume_3d = self.reconstructor.reconstruct_from_sequence(
            image_sequence, angles
        )

        # 2. å»å™ªå¢å¼º
        volume_denoised = self.denoiser.process(volume_3d)

        # 3. åˆ†å‰²
        segmentation = self.segmenter.segment(volume_denoised)

        # 4. æ›²ç‡åˆ†æ
        curvature_map = self.analyzer.compute_curvature(segmentation)

        # 5. å¼‚å¸¸æ£€æµ‹
        anomalies = self.detect_irregular_structures(
            segmentation, curvature_map
        )

        return anomalies

    def detect_irregular_structures(self, seg, curvature):
        """åŸºäºæ›²ç‡æ£€æµ‹ä¸è§„åˆ™ç»“æ„"""
        # è®¡ç®—æ›²ç‡ç»Ÿè®¡ç‰¹å¾
        mean_curvature = np.mean(curvature)
        std_curvature = np.std(curvature)

        # æ£€æµ‹æ›²ç‡å¼‚å¸¸åŒºåŸŸ
        anomalies = curvature > (mean_curvature + 2*std_curvature)

        # å½¢æ€å­¦å¤„ç†
        anomalies = morphology.remove_small_objects(anomalies, min_size=100)

        return anomalies
```

### æ•°æ®å¢å¼ºç­–ç•¥å€Ÿé‰´

ä»ç”µé•œæ ·å“å¤„ç†å¾—åˆ°çš„å¯å‘ï¼š
- **å¤šè§’åº¦èåˆ**ï¼šç±»ä¼¼å€¾æ–œç³»åˆ—ï¼Œèåˆå¤šæ—¶ç›¸å«æ˜Ÿå›¾åƒ
- **åˆ†è¾¨ç‡æå‡**ï¼šç±»ä¼¼è¶…åˆ†è¾¨ç‡é‡å»ºï¼Œç»“åˆå¤šæºæ•°æ®
- **å…ˆéªŒçº¦æŸ**ï¼šå»ºç­‘ç‰©å‡ ä½•çº¦æŸï¼Œç±»ä¼¼ç”Ÿç‰©ç»“æ„çš„å…ˆéªŒçŸ¥è¯†

---

## ğŸ“š å‚è€ƒæ–‡çŒ®

1. Cai, X., et al. (2019). "Thylakoid Membrane Architecture in 3D: Electron Tomography Analysis." *Frontiers in Plant Science*.
2. Kremer, J.R., et al. (1996). "Computer visualization of three-dimensional image data using IMOD." *Journal of Structural Biology*.
3. Perona, P., & Malik, J. (1990). "Scale-space and edge detection using anisotropic diffusion." *IEEE TPAMI*.
4. Osher, S., & Sethian, J.A. (1988). "Fronts propagating with curvature-dependent speed: algorithms based on Hamilton-Jacobi formulations." *Journal of Computational Physics*.
5. Gilbert, P. (1972). "Iterative methods for the three-dimensional reconstruction of an object from projections." *Journal of Theoretical Biology*.

---

*æœ¬ç¬”è®°ç”±ç²¾è¯»ç³»ç»Ÿç”Ÿæˆï¼Œå»ºè®®ç»“åˆåŸæ–‡è¿›è¡Œæ·±å…¥ç ”è¯»ã€‚*
