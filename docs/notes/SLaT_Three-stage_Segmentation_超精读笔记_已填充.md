# SLaT: Smoothing, Lifting and Thresholding for Color Image Segmentation

> **è¶…ç²¾è¯»ç¬”è®°** | 5-Agentè¾©è®ºåˆ†æç³»ç»Ÿ
> åˆ†ææ—¶é—´ï¼š2026-02-16
> arXiv: 1506.00060

---

## ğŸ“‹ è®ºæ–‡å…ƒæ•°æ®

| å±æ€§ | ä¿¡æ¯ |
|------|------|
| **æ ‡é¢˜** | A Three-stage Approach for Segmenting Degraded Color Images: Smoothing, Lifting and Thresholding (SLaT) |
| **ä½œè€…** | Xiaohao Cai, Raymond Chan, Mila Nikolova, Tieyong Zeng |
| **å¹´ä»½** | 2015 |
| **arXiv ID** | 1506.00060 |
| **æœŸåˆŠ** | IEEE Transactions on Image Processing (ç›¸å…³) |

### ğŸ“ æ‘˜è¦ç¿»è¯‘

æœ¬æ–‡æå‡ºäº†ä¸€ç§åä¸ºSLaTï¼ˆå¹³æ»‘ã€æå‡å’Œé˜ˆå€¼åŒ–ï¼‰çš„ä¸‰é˜¶æ®µæ–¹æ³•ï¼Œç”¨äºå—ä¸åŒé€€åŒ–å½±å“çš„å½©è‰²å›¾åƒå¤šç›¸åˆ†å‰²ï¼šå™ªå£°ã€ä¿¡æ¯ä¸¢å¤±å’Œæ¨¡ç³Šã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œå¯¹æ¯ä¸ªé€šé“åº”ç”¨Mumford-Shahæ¨¡å‹çš„å‡¸å˜ä½“ä»¥è·å¾—å¹³æ»‘å›¾åƒã€‚æˆ‘ä»¬è¯æ˜äº†è¯¥æ¨¡å‹åœ¨ä¸åŒé€€åŒ–æ¡ä»¶ä¸‹å…·æœ‰å”¯ä¸€è§£ã€‚ä¸ºäº†æ­£ç¡®å¤„ç†é¢œè‰²ä¿¡æ¯ï¼Œç¬¬äºŒé˜¶æ®µæ˜¯ç»´åº¦æå‡ï¼šæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ–°çš„å‘é‡å€¼å›¾åƒï¼Œç”±æ¢å¤çš„å›¾åƒåŠå…¶åœ¨å…·æœ‰é™„åŠ ä¿¡æ¯çš„æ¬¡è¦é¢œè‰²ç©ºé—´ä¸­çš„å˜æ¢ç»„æˆã€‚è¿™ç¡®ä¿äº†å³ä½¿ç¬¬ä¸€ä¸ªé¢œè‰²ç©ºé—´å…·æœ‰é«˜åº¦ç›¸å…³çš„é€šé“ï¼Œæˆ‘ä»¬ä»ç„¶æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç»™å‡ºè‰¯å¥½çš„åˆ†å‰²ç»“æœã€‚åœ¨æœ€åé˜¶æ®µï¼Œæˆ‘ä»¬å¯¹ç»„åˆçš„å‘é‡å€¼å›¾åƒåº”ç”¨å¤šé€šé“é˜ˆå€¼åŒ–ä»¥æ‰¾åˆ°åˆ†å‰²ã€‚ç›¸ä½çš„æ•°é‡ä»…åœ¨æœ€åé˜¶æ®µéœ€è¦ï¼Œå› æ­¤ç”¨æˆ·å¯ä»¥é€‰æ‹©æˆ–æ›´æ”¹å®ƒï¼Œè€Œæ— éœ€å†æ¬¡æ±‚è§£å‰é¢çš„é˜¶æ®µã€‚å®éªŒè¡¨æ˜ï¼Œæˆ‘ä»¬çš„SLaTæ–¹æ³•åœ¨åˆ†å‰²è´¨é‡å’ŒCPUæ—¶é—´æ–¹é¢éƒ½ç»™å‡ºäº†ä¼˜ç§€çš„ç»“æœï¼Œä¸å…¶ä»–æœ€å…ˆè¿›çš„åˆ†å‰²æ–¹æ³•ç›¸æ¯”ã€‚

**å…³é”®è¯**: Mumford-Shahæ¨¡å‹ã€å‡¸å˜åˆ†æ¨¡å‹ã€å¤šç›¸å½©è‰²å›¾åƒåˆ†å‰²ã€é¢œè‰²ç©ºé—´

---

## ğŸ”¢ 1. æ•°å­¦å®¶Agentï¼šç†è®ºåˆ†æ

### 1.1 æ ¸å¿ƒæ•°å­¦æ¡†æ¶

**å˜åˆ†æ³•ä¸å‡¸ä¼˜åŒ–ç†è®º**

æœ¬æ–‡ä½¿ç”¨çš„æ•°å­¦å·¥å…·ï¼š
- å˜åˆ†æ³•ï¼šé€šè¿‡æœ€å°åŒ–èƒ½é‡æ³›å‡½æ±‚è§£å›¾åƒåˆ†å‰²é—®é¢˜
- å‡¸ä¼˜åŒ–ï¼šé¿å…éå‡¸ä¼˜åŒ–é—®é¢˜çš„å±€éƒ¨æœ€å°å€¼
- å‘é‡å€¼å‡½æ•°ç©ºé—´ï¼šå¤„ç†å½©è‰²å›¾åƒ

**å…³é”®æ•°å­¦å®šä¹‰ï¼š**

è®¾ Î© âŠ‚ RÂ² æ˜¯æœ‰ç•Œå¼€è¿é€šé›†ï¼Œf: Î© â†’ Ráµˆ æ˜¯ç»™å®šå‘é‡å€¼å›¾åƒ
- d = 1ï¼šç°åº¦å›¾åƒ
- d = 3ï¼šRGBå½©è‰²å›¾åƒ
- d > 3ï¼šé«˜å…‰è°±å›¾åƒæˆ–åŒ»å­¦å›¾åƒ

**1. Mumford-Shahæ¨¡å‹ (1989)**
```
EMS(g, Î“) = (Î»/2)âˆ«_Î© (f-g)Â²dx + (Î¼/2)âˆ«_{Î©\Î“} |âˆ‡g|Â²dx + Length(Î“)
```

**2. PCMSæ¨¡å‹ (åˆ†æ®µå¸¸æ•°Mumford-Shah)**
```
E_PCMS({Î©_i, c_i}_{i=1}^K) = (Î»/2)Î£âˆ«_{Î©_i} (f-c_i)Â²dx + Î£Per(Î©_i)
```

### 1.2 å…³é”®å…¬å¼æ¨å¯¼

**æ ¸å¿ƒå…¬å¼1ï¼šSLaTç¬¬ä¸€é˜¶æ®µçš„èƒ½é‡æ³›å‡½**

```
E(g_i) = (Î¼/2)âˆ«_Î© Ï‰_iÂ·Î¦(f_i, g_i)dx + (Î»/2)âˆ«_Î© |âˆ‡g_i|Â²dx + âˆ«_Î© |âˆ‡g_i|dx
```

å…¶ä¸­ï¼š
- i = 1, ..., d (d=3 for RGB)
- Ï‰_i æ˜¯å·²çŸ¥åŒºåŸŸ Î©_iâ° çš„ç‰¹å¾å‡½æ•°
- Î¦ æœ‰ä¸¤ç§é€‰æ‹©ï¼š
  - i) Î¦(f,g) = (f - Ag)Â² (é«˜æ–¯å™ªå£°)
  - ii) Î¦(f,g) = Ag - f log(Ag) (æ³Šæ¾å™ªå£°)

**ç¦»æ•£å½¢å¼ï¼š**
```
E(g_i) = (Î»/2)Î¨(f_i, g_i) + (Î¼/2)||âˆ‡g_i||Â²_F + ||âˆ‡g_i||â‚‚,â‚
```

å…¶ä¸­ï¼š
- ||âˆ‡g_i||Â²_F = Î£[(âˆ‡_x g_i)Â²â±¼ + (âˆ‡_y g_i)Â²â±¼] (FrobeniusèŒƒæ•°)
- ||âˆ‡g_i||â‚‚,â‚ = Î£âˆš[(âˆ‡_x g_i)Â²â±¼ + (âˆ‡_y g_i)Â²â±¼] (TVåŠèŒƒ)

**æ ¸å¿ƒå®šç† (Theorem III.1): å­˜åœ¨æ€§å’Œå”¯ä¸€æ€§**

**æ¡ä»¶**ï¼š
- Î© æ˜¯æœ‰ç•Œè¿é€šå¼€é›†ï¼ŒLipschitzè¾¹ç•Œ
- A: LÂ²(Î©) â†’ LÂ²(Î©) æ˜¯æœ‰ç•Œçº¿æ€§ç®—å­
- Ker(Ï‰_iA) âŠ• Ker(âˆ‡) = {0} (æ¸©å’Œæ¡ä»¶ï¼šKer(Ï‰_iA)ä¸åŒ…å«å¸¸å€¼å›¾åƒ)

**ç»“è®º**ï¼š
æ³›å‡½ E(g_i) åœ¨ W^{1,2}(Î©) ä¸­å­˜åœ¨å”¯ä¸€æœ€å°åŒ–å™¨ gÌ„_i

**å…¬å¼è§£æï¼š**

1. **ä¸‰é¡¹ç»“æ„**ï¼š
   - æ•°æ®ä¿çœŸé¡¹ï¼šä¿æŒä¸è§‚æµ‹å›¾åƒçš„ä¸€è‡´æ€§
   - å¹³æ»‘é¡¹ (||âˆ‡g||Â²_F)ï¼šHÂ¹åŠèŒƒï¼Œå¼ºåˆ¶å¹³æ»‘æ€§
   - TVé¡¹ (||âˆ‡g||â‚‚,â‚)ï¼šä¿æŒè¾¹ç¼˜

2. **ç»´åº¦æå‡ (Stage 2)**ï¼š
   ```
   gÌ„* = (gÌ„â‚, gÌ„â‚‚, gÌ„â‚ƒ, gÌ„â‚áµ—, gÌ„â‚‚áµ—, gÌ„â‚ƒáµ—)
   ```
   å…¶ä¸­ gÌ„ æ˜¯RGBç©ºé—´ï¼ŒgÌ„áµ— æ˜¯Labç©ºé—´çš„å˜æ¢

3. **å¤šé€šé“é˜ˆå€¼åŒ– (Stage 3)**ï¼š
   ```
   c_k = âˆ«_{Î£_k} gÌ„*dx / âˆ«_{Î£_k}dx, k = 1, ..., K
   ```
   ```
   Î©_k = {x âˆˆ Î©: ||gÌ„*(x) - c_k||â‚‚ = min_{1â‰¤jâ‰¤K} ||gÌ„*(x) - c_j||â‚‚}
   ```

### 1.3 ç†è®ºæ€§è´¨åˆ†æ

**æ”¶æ•›æ€§åˆ†æï¼š**
- Primal-Dualç®—æ³•æ”¶æ•›æ€§å·²çŸ¥ï¼ˆChambolle-Pock 2011ï¼‰
- Split-Bregmanç®—æ³•æ”¶æ•›æ€§å·²çŸ¥ï¼ˆGoldstein-Osher 2009ï¼‰

**ç¨³å®šæ€§è®¨è®ºï¼š**
- å”¯ä¸€è§£ä¿è¯å¯é‡å¤æ€§
- å‚æ•°Î¼å¯ä»¥å›ºå®šä¸º1
- å‚æ•°Î»éœ€è¦æ ¹æ®å›¾åƒç‰¹æ€§è°ƒæ•´

**å¤æ‚åº¦ç•Œï¼š**
- Stage 1: dä¸ªç‹¬ç«‹é—®é¢˜ï¼Œå¯å¹¶è¡Œæ±‚è§£
- Stage 2: é¢œè‰²ç©ºé—´å˜æ¢ O(N)
- Stage 3: K-meansèšç±» O(NKÂ·iter)

### 1.4 æ•°å­¦åˆ›æ–°ç‚¹

**æ–°çš„æ•°å­¦å·¥å…·ï¼š**
1. **ç»´åº¦æå‡æ¦‚å¿µ**ï¼šç»“åˆä¸¤ä¸ªé¢œè‰²ç©ºé—´çš„ä¿¡æ¯
2. **å‘é‡å€¼å›¾åƒçš„å‡¸å˜åˆ†æ¨¡å‹**ï¼šä»ç°åº¦æ‰©å±•åˆ°å½©è‰²
3. **å¤šé€šé“é˜ˆå€¼åŒ–**ï¼šä½¿ç”¨â„“â‚‚è·ç¦»è¿›è¡Œå‘é‡èšç±»

**ç†è®ºæ”¹è¿›ï¼š**
1. è¯æ˜äº†å‘é‡å€¼æ¨¡å‹è§£çš„å”¯ä¸€æ€§
2. æ‰©å±•äº†[8,12]çš„ä¸¤é˜¶æ®µæ–¹æ³•åˆ°å½©è‰²å›¾åƒ
3. é¦–æ¬¡åœ¨å˜åˆ†åˆ†å‰²æ–¹æ³•ä¸­è”åˆä½¿ç”¨ä¸¤ä¸ªé¢œè‰²ç©ºé—´

---

## ğŸ”§ 2. å·¥ç¨‹å¸ˆAgentï¼šå®ç°åˆ†æ

### 2.1 ç®—æ³•æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SLaT ä¸‰é˜¶æ®µåˆ†å‰²ç®—æ³•                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  è¾“å…¥: å½©è‰²å›¾åƒ f âˆˆ RGBÂ³, é€€åŒ–ç±»å‹, ç›¸ä½æ•° K                     â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Stage 1: å¹³æ»‘ (Smoothing)                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ å¯¹æ¯ä¸ªé€šé“ i=1,2,3 å¹¶è¡Œæ±‚è§£:                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ min E(g_i) = æ•°æ®é¡¹ + å¹³æ»‘é¡¹ + TVé¡¹               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ ä½¿ç”¨ Primal-Dual æˆ– Split-Bregman                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  è¾“å‡º: æ¢å¤çš„å¹³æ»‘å›¾åƒ gÌ„ = (gÌ„â‚, gÌ„â‚‚, gÌ„â‚ƒ)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Stage 2: ç»´åº¦æå‡ (Lifting)                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 1. RGB â†’ Lab å˜æ¢: gÌ„ â†’ gÌ„áµ—                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ 2. é‡æ–°ç¼©æ”¾Labåˆ°[0,1]                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ 3. æ‹¼æ¥: gÌ„* = (gÌ„â‚, gÌ„â‚‚, gÌ„â‚ƒ, gÌ„â‚áµ—, gÌ„â‚‚áµ—, gÌ„â‚ƒáµ—)    â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  è¾“å‡º: 6ç»´å‘é‡å€¼å›¾åƒ gÌ„*                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Stage 3: é˜ˆå€¼åŒ– (Thresholding)                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ 1. åº”ç”¨K-meansåˆ° {gÌ„*(x): xâˆˆÎ©}                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ 2. è®¡ç®—èšç±»ä¸­å¿ƒ c_k âˆˆ Râ¶                           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ 3. â„“â‚‚è·ç¦»åˆ†é…åƒç´ åˆ°åŒºåŸŸ                            â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  è¾“å‡º: åˆ†å‰² {Î©_k}_{k=1}^K                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  ä¼˜åŠ¿: æ›´æ”¹Kæ— éœ€é‡æ–°è®¡ç®—Stage 1å’Œ2                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å…³é”®å®ç°è¦ç‚¹

**ç®—æ³•ä¼ªä»£ç ï¼š**

```
ALGORITHM SLaT Color Image Segmentation
INPUT: Degraded color image f âˆˆ RGBÂ³, Number of phases K
OUTPUT: Segments {Î©_k}_{k=1}^K

STAGE 1: Smoothing (å¹¶è¡Œå¤„ç†3ä¸ªé€šé“)
FOR i = 1 TO 3 DO:
    1. Initialize g_i = f_i
    2. Solve using Primal-Dual algorithm:

       // Primal-Dual for Gaussian noise
       REPEAT until convergence OR max_iter:
           // Dual update
           p = (p + Ïƒâˆ‡gÌ„) / (1 + Ïƒ|p|)

           // Primal update
           gÌ„ = (g + Ï„(Î¼Ï‰_i(f - Ag) + div(p))) / (1 + Ï„)

           // Extrapolation
           g = 2gÌ„ - g

       3. Rescale gÌ„_i to [0, 1]
END FOR

STAGE 2: Lifting
1. Transform gÌ„ from RGB to Lab color space
2. Rescale Lab channels to [0, 1]: gÌ„áµ—
3. Concatenate: gÌ„* = [gÌ„_RGB, gÌ„_Lab]  // 6 channels

STAGE 3: Thresholding
1. Collect pixel vectors: {gÌ„*(x) : x âˆˆ Î©} âŠ‚ Râ¶
2. Apply K-means clustering:
   - Initialize K centers
   - Alternate: assign pixels to nearest center
               update centers as mean of assigned pixels
3. Compute segment means c_k âˆˆ Râ¶
4. Final segmentation:
   Î©_k = {x: ||gÌ„*(x) - c_k||â‚‚ = min_j ||gÌ„*(x) - c_j||â‚‚}

RETURN {Î©_k}_{k=1}^K
```

**æ•°æ®ç»“æ„è®¾è®¡ï¼š**

```python
import numpy as np
from sklearn.cluster import KMeans
import cv2

class SLATSegmentation:
    def __init__(self, lambda_param=0.1, mu=1.0, max_iter=200, tol=1e-4):
        self.lambda_param = lambda_param  # æ•°æ®ä¿çœŸé¡¹æƒé‡
        self.mu = mu                      # TVæƒé‡ (è®ºæ–‡å›ºå®šä¸º1)
        self.max_iter = max_iter
        self.tol = tol
        self.g_smooth = None              # Stage 1è¾“å‡º
        self.g_lifted = None              # Stage 2è¾“å‡º

    def stage1_smoothing(self, f, noise_type='gaussian'):
        """
        Stage 1: æ¢å¤å¹³æ»‘å›¾åƒ
        å¯¹æ¯ä¸ªé€šé“ç‹¬ç«‹æ±‚è§£
        """
        d = f.shape[2] if f.ndim == 3 else 1
        g_smooth = np.zeros_like(f)

        for i in range(d):
            if noise_type == 'gaussian':
                g_smooth[:,:,i] = self._solve_rof(f[:,:,i])
            elif noise_type == 'poisson':
                g_smooth[:,:,i] = self._solve_poisson_rof(f[:,:,i])

        # å½’ä¸€åŒ–åˆ°[0,1]
        g_smooth = np.clip(g_smooth, 0, 1)
        self.g_smooth = g_smooth
        return g_smooth

    def _solve_rof(self, f):
        """ä½¿ç”¨Primal-Dualç®—æ³•æ±‚è§£ROFæ¨¡å‹"""
        # Chambolle-Pockç®—æ³•
        u = f.copy()
        p = np.zeros((2, *f.shape))
        tau = 0.1
        sigma = 0.1
        theta = 1

        for k in range(self.max_iter):
            # å¯¹å¶å˜é‡æ›´æ–°
            grad_u = np.gradient(u)
            p_new = p + sigma * np.array(grad_u)
            p_norm = np.sqrt(np.sum(p_new**2, axis=0))
            p = p_new / np.maximum(1, p_norm[None,:,:])

            # åŸå§‹å˜é‡æ›´æ–°
            div_p = -np.sum(np.gradient(p, axis=(1,2)), axis=0)
            u_bar = (u + tau * (self.mu * f + div_p)) / (1 + tau)

            # å¤–æ¨
            u = u_bar + theta * (u_bar - u)
            u = np.clip(u, 0, 1)

        return u

    def stage2_lifting(self, g_rgb):
        """
        Stage 2: ç»´åº¦æå‡
        RGB â†’ Labï¼Œç„¶åæ‹¼æ¥
        """
        # RGBè½¬Lab
        g_lab = cv2.cvtColor((g_rgb * 255).astype(np.uint8),
                             cv2.COLOR_RGB2LAB).astype(np.float32) / 255

        # å½’ä¸€åŒ–Labåˆ°[0,1]
        g_lab_norm = (g_lab - g_lab.min()) / (g_lab.max() - g_lab.min() + 1e-8)

        # æ‹¼æ¥RGBå’ŒLab: (H, W, 6)
        g_lifted = np.concatenate([g_rgb, g_lab_norm], axis=2)
        self.g_lifted = g_lifted
        return g_lifted

    def stage3_thresholding(self, g_lifted, K):
        """
        Stage 3: å¤šé€šé“K-meansé˜ˆå€¼åŒ–
        """
        H, W, C = g_lifted.shape
        pixels = g_lifted.reshape(-1, C)

        # K-meansèšç±»
        kmeans = KMeans(n_clusters=K, random_state=0, n_init=10)
        labels = kmeans.fit_predict(pixels)

        # è·å–èšç±»ä¸­å¿ƒ
        centers = kmeans.cluster_centers_

        # æœ€ç»ˆåˆ†å‰²
        segmentation = labels.reshape(H, W)

        return segmentation, centers

    def segment(self, f, K, noise_type='gaussian'):
        """
        å®Œæ•´SLaTåˆ†å‰²æµç¨‹
        """
        # Stage 1
        g_smooth = self.stage1_smoothing(f, noise_type)

        # Stage 2
        g_lifted = self.stage2_lifting(g_smooth)

        # Stage 3
        segmentation, centers = self.stage3_thresholding(g_lifted, K)

        return segmentation, g_smooth, g_lifted

    def change_K(self, new_K):
        """
        æ›´æ”¹ç›¸ä½æ•°K - æ— éœ€é‡æ–°è®¡ç®—Stage 1å’Œ2
        """
        if self.g_lifted is None:
            raise ValueError("éœ€è¦å…ˆè¿è¡Œsegment()æ–¹æ³•")
        return self.stage3_thresholding(self.g_lifted, new_K)
```

### 2.3 è®¡ç®—å¤æ‚åº¦

| é¡¹ç›® | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| Stage 1 (å•é€šé“ROF) | O(NÂ·iter) | Næ˜¯åƒç´ æ•°ï¼Œiterçº¦100 |
| Stage 1 (ä¸‰é€šé“å¹¶è¡Œ) | O(NÂ·iter) | å¯å¹¶è¡Œï¼Œå®é™…æ—¶é—´ç›¸åŒ |
| Stage 2 (RGBâ†’Lab) | O(N) | é¢œè‰²ç©ºé—´å˜æ¢ |
| Stage 3 (K-means) | O(NÂ·KÂ·iter_k) | iter_kçº¦10-20 |
| **æ€»å¤æ‚åº¦** | O(NÂ·(iter+KÂ·iter_k)) | ä¸»å¯¼æ˜¯Stage 1 |
| **å¹¶è¡ŒåŠ é€Ÿ** | ~3x | ä¸‰é€šé“å¹¶è¡Œ |

### 2.4 å®ç°å»ºè®®

**æ¨èç¼–ç¨‹è¯­è¨€/æ¡†æ¶ï¼š**
- Python + OpenCV (é¢œè‰²ç©ºé—´å˜æ¢)
- Python + scikit-learn (K-means)
- PyTorch (GPUåŠ é€ŸROFæ±‚è§£)

**å…³é”®ä¼˜åŒ–æŠ€å·§ï¼š**

1. **å¹¶è¡ŒåŒ–Stage 1**ï¼š
```python
from multiprocessing import Pool
def process_channel(args):
    f_i, noise_type = args
    return solve_rof(f_i, noise_type)

with Pool(3) as pool:
    results = pool.map(process_channel,
                      [(f[:,:,i], 'gaussian') for i in range(3)])
```

2. **GPUåŠ é€ŸTVè®¡ç®—**ï¼š
```python
import torch

def tv_gradient_gpu(u):
    """GPUåŠ é€Ÿçš„TVæ¢¯åº¦"""
    u_torch = torch.from_numpy(u).cuda()
    grad_x = torch.diff(u_torch, dim=-1, padding=-1)
    grad_y = torch.diff(u_torch, dim=-2, padding=-1)
    return grad_x.cpu().numpy(), grad_y.cpu().numpy()
```

3. **ç¼“å­˜Stage 2ç»“æœ**ï¼š
```python
# ç”±äºæ›´æ”¹Kä¸éœ€è¦é‡ç®—Stage 1å’Œ2ï¼Œå¯ä»¥ç¼“å­˜
@lru_cache(maxsize=1)
def get_lifted_features(self, f_hash):
    return self.stage2_lifting(self.stage1_smoothing(f))
```

---

## ğŸ’¼ 3. åº”ç”¨ä¸“å®¶Agentï¼šä»·å€¼åˆ†æ

### 3.1 åº”ç”¨åœºæ™¯

**æ ¸å¿ƒé¢†åŸŸï¼š**
- [âœ“] åŒ»å­¦å½±åƒ
- [âœ“] é¥æ„Ÿå›¾åƒ
- [âœ“] è‡ªç„¶å›¾åƒåˆ†å‰²
- [ ] é›·è¾¾
- [ ] NLP

**å…·ä½“åº”ç”¨åœºæ™¯ï¼š**

1. **é€€åŒ–åŒ»å­¦å›¾åƒåˆ†å‰²**
   - åœºæ™¯ï¼šä½å‰‚é‡CTã€MRIå»å™ªååˆ†å‰²
   - æŒ‘æˆ˜ï¼šå™ªå£°å¼ºã€ä¿¡æ¯ä¸¢å¤±
   - SLaTä¼˜åŠ¿ï¼šStage 1ä¸“é—¨å¤„ç†é€€åŒ–

2. **é¥æ„Ÿå›¾åƒåˆ†å‰²**
   - åœºæ™¯ï¼šåœŸåœ°è¦†ç›–åˆ†ç±»
   - æŒ‘æˆ˜ï¼šå¤§æ°”æ¨¡ç³Šã€ä¼ æ„Ÿå™¨å™ªå£°
   - SLaTä¼˜åŠ¿ï¼šå¤šé¢œè‰²ç©ºé—´èåˆ

3. **è‡ªç„¶å›¾åƒç‰©ä½“åˆ†å‰²**
   - åœºæ™¯ï¼šå›¾åƒç¼–è¾‘ã€èƒŒæ™¯æ›¿æ¢
   - æŒ‘æˆ˜ï¼šå…‰ç…§å˜åŒ–ã€é¢œè‰²ç›¸è¿‘
   - SLaTä¼˜åŠ¿ï¼šLabç©ºé—´æ„ŸçŸ¥é¢œè‰²å·®å¼‚

### 3.2 æŠ€æœ¯ä»·å€¼

**è§£å†³çš„é—®é¢˜ï¼š**

| é—®é¢˜ | ä¼ ç»Ÿæ–¹æ³• | SLaTè§£å†³æ–¹æ¡ˆ |
|------|----------|-------------|
| å½©è‰²é€šé“ç›¸å…³æ€§ | åªç”¨RGBï¼Œæ˜“å—ç›¸å…³å½±å“ | RGB+LabåŒé‡ä¿¡æ¯ |
| é€€åŒ–å›¾åƒåˆ†å‰² | å…ˆä¿®å¤å†åˆ†å‰²ï¼Œæµç¨‹åˆ†ç¦» | ç»Ÿä¸€å˜åˆ†æ¡†æ¶ |
| æ›´æ”¹ç›¸ä½æ•°K | éœ€è¦é‡æ–°ä¼˜åŒ– | åªéœ€é‡è¿è¡ŒStage 3 |
| éå‡¸ä¼˜åŒ– | å±€éƒ¨æœ€å°å€¼ | å‡¸æ¾å¼›+é˜ˆå€¼åŒ– |

**æ€§èƒ½æå‡ï¼ˆåŸºäºè®ºæ–‡å®éªŒï¼‰ï¼š**

| æ•°æ®é›† | SLaTå‡†ç¡®ç‡ | æœ€ä¼˜å¯¹æ¯”æ–¹æ³• | æå‡ |
|--------|-----------|-------------|------|
| 6ç›¸åˆæˆå›¾ | 99.21% | Pock[39] 71.68% | +38.4% |
| ä¿¡æ¯ä¸¢å¤± | 99.25% | Storath[44] 85.04% | +16.7% |
| æ¨¡ç³Š+å™ªå£° | 98.88% | Pock[39] 98.58% | +0.3% |

**é€Ÿåº¦å¯¹æ¯”ï¼ˆCPUæ—¶é—´ï¼‰ï¼š**
- SLaTå¹³å‡: 2.5-40ç§’
- Li[31]å¹³å‡: 5-44ç§’
- Pock[39]å¹³å‡: 4-66ç§’
- Storath[44]å¹³å‡: 4-110ç§’

### 3.3 è½åœ°å¯è¡Œæ€§

| å› ç´  | è¯„ä¼° | è¯´æ˜ |
|------|------|------|
| æ•°æ®éœ€æ±‚ | ä½ | åªéœ€åŸå›¾ï¼Œæ— éœ€æ ‡æ³¨ |
| è®¡ç®—èµ„æº | ä¸­ | å¯å¹¶è¡Œï¼ŒGPUå¯é€‰ |
| éƒ¨ç½²éš¾åº¦ | ä½ | ä¾èµ–æ ‡å‡†åº“ |
| å‚æ•°è°ƒä¼˜ | ä½ | Î¼å›ºå®šï¼ŒÎ»ç¨³å®š |

### 3.4 å•†ä¸šæ½œåŠ›

**ç›®æ ‡å¸‚åœºï¼š**
- åŒ»å­¦å½±åƒè½¯ä»¶
- å«æ˜Ÿå›¾åƒåˆ†æ
- å›¾åƒç¼–è¾‘å·¥å…·

**ç«äº‰ä¼˜åŠ¿ï¼š**
1. ç†è®ºä¿è¯ï¼ˆå”¯ä¸€è§£ï¼‰
2. çµæ´»æ€§ï¼ˆæ›´æ”¹Kæ— éœ€é‡ç®—ï¼‰
3. é²æ£’æ€§ï¼ˆå¤„ç†å¤šç§é€€åŒ–ï¼‰

---

## ğŸ¤¨ 4. è´¨ç–‘è€…Agentï¼šæ‰¹åˆ¤åˆ†æ

### 4.1 æ–¹æ³•è®ºè´¨ç–‘

**ç†è®ºå‡è®¾ï¼š**
1. å‡è®¾é¢œè‰²ç©ºé—´å˜æ¢ä¸å¼•å…¥é¢å¤–è¯¯å·® â†’ å®é™…ä¸ŠRGBâ†’Labå¯èƒ½æœ‰æŸå¤±
2. å‡è®¾K-meansèƒ½æ‰¾åˆ°å¥½çš„åˆå§‹èšç±» â†’ å¯¹å¤æ‚å›¾åƒå¯èƒ½ä¸æˆç«‹

**æ•°å­¦ä¸¥è°¨æ€§ï¼š**
- Theorem III.1çš„è¯æ˜ä¾èµ–äºæ¸©å’Œæ¡ä»¶
- K-meansçš„æ”¶æ•›æ€§æ˜¯åˆ°å±€éƒ¨æœ€ä¼˜

### 4.2 å®éªŒè¯„ä¼°æ‰¹åˆ¤

**æ•°æ®é›†é—®é¢˜ï¼š**
- åˆæˆå›¾åƒè¿‡äºç†æƒ³åŒ–
- çœŸå®å›¾åƒæ•°é‡æœ‰é™ï¼ˆ7å¼ ï¼‰
- ç¼ºä¹å¤§è§„æ¨¡åŸºå‡†æµ‹è¯•

**è¯„ä¼°æŒ‡æ ‡ï¼š**
- åªç”¨äº†åƒç´ å‡†ç¡®ç‡
- ç¼ºä¹è¾¹ç•Œç²¾åº¦è¯„ä¼°

### 4.3 å±€é™æ€§åˆ†æ

**æ–¹æ³•é™åˆ¶ï¼š**
1. å¯¹çº¹ç†å›¾åƒæ•ˆæœå¯èƒ½ä¸ä½³
2. K-meanså¯¹åˆå§‹åŒ–æ•æ„Ÿ
3. è®¡ç®—å¤æ‚åº¦ä»è¾ƒé«˜

### 4.4 æ”¹è¿›å»ºè®®

1. çŸ­æœŸï¼šæ·»åŠ æ›´å¤šé¢œè‰²ç©ºé—´é€‰é¡¹
2. é•¿æœŸï¼šç»“åˆæ·±åº¦å­¦ä¹ ç‰¹å¾
3. è¡¥å……ï¼šåœ¨æ ‡å‡†æ•°æ®é›†ä¸Šæµ‹è¯•
4. ç†è®ºï¼šåˆ†æé¢œè‰²ç©ºé—´é€‰æ‹©çš„å½±å“

---

## ğŸ¯ 5. ç»¼åˆç†è§£ï¼šæ ¸å¿ƒåˆ›æ–°ä¸æ„ä¹‰

### 5.1 æ ¸å¿ƒåˆ›æ–°ç‚¹

| ç»´åº¦ | åˆ›æ–°å†…å®¹ | è¯„åˆ† |
| ç†è®º | å‘é‡å€¼å›¾åƒå˜åˆ†æ¨¡å‹å”¯ä¸€æ€§ | â˜…â˜…â˜…â˜…â˜† |
| æ–¹æ³• | ä¸‰é˜¶æ®µSLaTæ¡†æ¶ | â˜…â˜…â˜…â˜…â˜… |
| åº”ç”¨ | ç»´åº¦æå‡æ¦‚å¿µ | â˜…â˜…â˜…â˜…â˜… |

### 5.2 ç ”ç©¶æ„ä¹‰

**å­¦æœ¯è´¡çŒ®ï¼š**
- é¦–æ¬¡åœ¨å˜åˆ†æ–¹æ³•ä¸­è”åˆä½¿ç”¨å¤šä¸ªé¢œè‰²ç©ºé—´
- è¯æ˜äº†è§£çš„å”¯ä¸€æ€§
- æ‰©å±•äº†ä¸¤é˜¶æ®µæ–¹æ³•åˆ°å½©è‰²å›¾åƒ

**å®é™…ä»·å€¼ï¼š**
- å¤„ç†é€€åŒ–å›¾åƒèƒ½åŠ›å¼º
- æ›´æ”¹Kæ— éœ€é‡ç®—
- å¯å¹¶è¡Œå®ç°

### 5.3 æŠ€æœ¯æ¼”è¿›ä½ç½®

```
Mumford-Shah (1989) â†’ PCMS â†’ Chan-Vese (2001) â†’
Convex Relaxation (2006) â†’ Two-Stage (2013) â†’
SLaT (2015) â†’ T-ROF (2018)
```

### 5.4 ç»¼åˆè¯„åˆ†

| ç»´åº¦ | è¯„åˆ† |
| ç†è®ºæ·±åº¦ | â˜…â˜…â˜…â˜…â˜† |
| æ–¹æ³•åˆ›æ–° | â˜…â˜…â˜…â˜…â˜… |
| å®ç°éš¾åº¦ | â˜…â˜…â˜…â˜†â˜† |
| åº”ç”¨ä»·å€¼ | â˜…â˜…â˜…â˜…â˜† |
| è®ºæ–‡è´¨é‡ | â˜…â˜…â˜…â˜…â˜† |

**æ€»åˆ†ï¼šâ˜…â˜…â˜…â˜…â˜† (4.0/5.0)**

---

*æœ¬ç¬”è®°ç”±5-Agentè¾©è®ºåˆ†æç³»ç»Ÿç”Ÿæˆ*
