# å¤§è§„æ¨¡å¼ é‡åˆ†è§£ Two-Sided Sketching

> **è¶…ç²¾è¯»ç¬”è®°** | 5-Agentè¾©è®ºåˆ†æç³»ç»Ÿ
> åˆ†ææ—¶é—´ï¼š2026-02-16
> arXiv: 2404.16580v4

---

## ğŸ“‹ è®ºæ–‡å…ƒæ•°æ®

| å±æ€§ | ä¿¡æ¯ |
|------|------|
| **æ ‡é¢˜** | An Efficient Two-Sided Sketching Method for Large-Scale Tensor Decomposition Based on Transformed Domains |
| **ä½œè€…** | Zhiguang Cheng, Gaohang Yu, Xiaohao Cai, Liqun Qi |
| **å¹´ä»½** | 2024 (arXiv v4: 2024-09-25) |
| **arXiv ID** | 2404.16580v4 |
| **æœŸåˆŠ/ä¼šè®®** | arXiv preprint |
| **PDFè·¯å¾„** | D:\Documents\zx\xiaohao_cai_papers_final\å¤§è§„æ¨¡å¼ é‡åˆ†è§£ Two-Sided Sketching.pdf |

### ğŸ“ æ‘˜è¦ç¿»è¯‘

æœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºå˜æ¢åŸŸçš„é«˜æ•ˆåŒè¾¹è‰ç¨¿æ–¹æ³•ï¼Œç”¨äºå¤§è§„æ¨¡å¼ é‡åˆ†è§£ã€‚ä¼ ç»Ÿå¼ é‡åˆ†è§£æ–¹æ³•(å¦‚t-SVD)è®¡ç®—æˆæœ¬é«˜ï¼Œéš¾ä»¥å¤„ç†å¤§è§„æ¨¡æ•°æ®ã€‚æœ¬æ–‡å¼•å…¥äº†â‹†_L-ç§¯æ¡†æ¶ï¼Œç»Ÿä¸€äº†ä¸åŒå˜æ¢åŸŸ(å¦‚DCTã€DFTã€DWT)ä¸‹çš„å¼ é‡è¿ç®—ï¼Œå¹¶æå‡ºäº†åŒè¾¹è‰ç¨¿ç»“åˆæ ¸å¿ƒè‰ç¨¿çš„æ–°å‹ç®—æ³•æ¡†æ¶ã€‚è¯¥æ–¹æ³•åœ¨ä¿æŒè¿‘ä¼¼ç²¾åº¦çš„åŒæ—¶ï¼Œå¤§å¹…é™ä½äº†è®¡ç®—å¤æ‚åº¦ï¼Œç‰¹åˆ«é€‚ç”¨äºè§†é¢‘ã€é«˜å…‰è°±å›¾åƒç­‰å¤§è§„æ¨¡ä¸‰ç»´å¼ é‡æ•°æ®çš„ä½ç§©è¿‘ä¼¼å’Œå‹ç¼©ä»»åŠ¡ã€‚

**å…³é”®è¯**: å¤§è§„æ¨¡å¼ é‡ã€å¼ é‡åˆ†è§£ã€è‰ç¨¿ç®—æ³•ã€t-productã€ç¦»æ•£ä½™å¼¦å˜æ¢ã€å¹‚è¿­ä»£ã€â‹†_L-ç§¯

---

## ğŸ”¢ 1. æ•°å­¦å®¶Agentï¼šç†è®ºåˆ†æ

### 1.1 æ ¸å¿ƒæ•°å­¦æ¡†æ¶

**â‹†_L-ç§¯ç†è®ºä¸å˜æ¢åŸŸå¼ é‡è¿ç®—**

æœ¬æ–‡å»ºç«‹äº†ä¸€ä¸ªç»Ÿä¸€çš„æ•°å­¦æ¡†æ¶ï¼Œå°†ä¼ ç»Ÿçš„t-productæ¨å¹¿åˆ°ä»»æ„å¯é€†çº¿æ€§å˜æ¢Lï¼š

**å®šä¹‰2.1 (â‹†_L-ç§¯)**ï¼š
å¯¹äºå¼ é‡ X âˆˆ C^{nâ‚Ã—nâ‚‚Ã—nâ‚ƒ} å’Œ Y âˆˆ C^{nâ‚‚Ã—nâ‚„Ã—nâ‚ƒ}ï¼š
```
Z = X â‹†_L Y = L_H[fold(block(XÌ„_L) Ã— block(YÌ„_L))]
```

å…¶ä¸­ï¼š
- XÌ„_L æ˜¯é€šè¿‡å¯¹Xçš„æ‰€æœ‰ç¬¬ä¸‰ç»´ç®¡åº”ç”¨Lå¾—åˆ°
- block(Â·)å°†å¼ é‡è½¬æ¢ä¸ºå—å¯¹è§’çŸ©é˜µ
- L_H æ˜¯Lçš„ä¼´éš(å¯¹äºå®æ­£äº¤å˜æ¢å°±æ˜¯Láµ€)

**å®Œç¾å¯¹è§’åŒ–æ€§è´¨**ï¼š
å¯¹äºä»»æ„å¯é€†å˜æ¢Lï¼Œå­˜åœ¨å¯¹è§’åŒ–å…³ç³»ï¼š
```
circ(A) = (Láµ€ âŠ— I_{nâ‚}) Ã— block(AÌ„_L) Ã— (L âŠ— I_{nâ‚‚})
```

è¿™å…è®¸åœ¨å˜æ¢åŸŸè¿›è¡Œé«˜æ•ˆçš„å¼ é‡ä¹˜æ³•ï¼š
```
A â‹†_L B = L_H[fold(AÌ„_L Ã— BÌ„_L)]
```

### 1.2 å…³é”®å…¬å¼æ¨å¯¼

**æ ¸å¿ƒå…¬å¼1ï¼šâ‹†_L-ç§¯çš„è®¡ç®—**

ç»™å®šå˜æ¢çŸ©é˜µL(å¦‚DCTã€DFT)ï¼Œâ‹†_L-ç§¯å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤è®¡ç®—ï¼š
```
1. å¯¹è¾“å…¥å¼ é‡çš„æ¯ä¸€ç®¡åº”ç”¨Lå˜æ¢
2. åœ¨å˜æ¢åŸŸè¿›è¡Œé€frontal sliceçš„çŸ©é˜µä¹˜æ³•
3. åº”ç”¨Lçš„é€†å˜æ¢
```

æ•°å­¦è¡¨è¾¾ï¼š
```
å¯¹äº A âˆˆ R^{mÃ—nÃ—p}, B âˆˆ R^{nÃ—rÃ—p}:
C = A â‹†_L B

è®¡ç®—æ­¥éª¤ï¼š
1. Ä€ = L[A]  (å¯¹æ¯ä¸€ç®¡åº”ç”¨L)
2. BÌ„ = L[B]
3. CÌ„(i,j,:) = Ä€(i,:,:) Ã— BÌ„(j,:,:)  (å˜æ¢åŸŸä¹˜æ³•)
4. C = L_H[CÌ„]
```

**æ ¸å¿ƒå…¬å¼2ï¼šå˜æ¢å¼ é‡SVD**

**å®šç†2.5 (å˜æ¢å¼ é‡SVD)**ï¼š
å¯¹äºä»»æ„å¼ é‡ A âˆˆ C^{mÃ—nÃ—p}ï¼Œå­˜åœ¨åˆ†è§£ï¼š
```
A = U â‹†_L S â‹†_L V_H
```

å…¶ä¸­ï¼š
- U âˆˆ C^{mÃ—mÃ—p} æ˜¯å·¦é…‰å¼ é‡ (U_H â‹†_L U = I)
- V âˆˆ C^{nÃ—nÃ—p} æ˜¯å³é…‰å¼ é‡ (V_H â‹†_L V = I)
- S âˆˆ C^{mÃ—nÃ—p} æ˜¯å¯¹è§’å¼ é‡

**è®¡ç®—æ–¹æ³•**ï¼š
```
1. å¯¹Aåº”ç”¨Lå˜æ¢ï¼šÄ€ = L[A]
2. å¯¹æ¯ä¸ªfrontal slice Ä€(:,:,k)è®¡ç®—SVDï¼š
   Ä€(:,:,k) = U(:,:,k) Ã— S(:,:,k) Ã— V_H(:,:,k)
3. åˆå¹¶å¾—åˆ°U, S, V
4. åº”ç”¨Lçš„é€†å˜æ¢å¾—åˆ°åŸå§‹åŸŸçš„åˆ†è§£
```

**æ ¸å¿ƒå…¬å¼3ï¼šåŒè¾¹è‰ç¨¿è¿‘ä¼¼**

ç›®æ ‡ï¼šæ‰¾åˆ°ä½ç§©å¼ é‡B â‰ˆ Aï¼Œä½¿å¾—rank_L(B) â‰¤ r

**è‰ç¨¿ç®—å­**ï¼š
```
Î¥ âˆˆ R^{kÃ—mÃ—p}  (å·¦è‰ç¨¿ï¼Œk << m)
â„¦ âˆˆ R^{kÃ—nÃ—p}  (å³è‰ç¨¿ï¼Œk << n)
Î¦ âˆˆ R^{sÃ—mÃ—p}  (æ ¸å¿ƒå·¦è‰ç¨¿ï¼Œs â‰¤ k)
Î¨ âˆˆ R^{sÃ—nÃ—p}  (æ ¸å¿ƒå³è‰ç¨¿ï¼Œs â‰¤ k)
```

**ä¸‰æ­¥æ¡†æ¶**ï¼š
```
æ­¥éª¤1ï¼šL-æ­£äº¤ä¸‰è§’åˆ†è§£
X_H = P â‹†_L Râ‚, å…¶ä¸­ X = Î¥ â‹†_L A
Y = Q â‹†_L Râ‚‚, å…¶ä¸­ Y = A â‹†_L â„¦_H

æ­¥éª¤2ï¼šå½¢æˆæ ¸å¿ƒå¼ é‡
S = Î¦ â‹†_L A â‹†_L Î¨_H
S' = P_H â‹†_L S â‹†_L Q

æ­¥éª¤3ï¼šè®¡ç®—è¿‘ä¼¼
[U_S, Î£_S, V_S] = t-SVD(S', r)
B = P â‹†_L U_S â‹†_L Î£_S â‹†_L V_S_H â‹†_L Q_H
```

**æ ¸å¿ƒå…¬å¼4ï¼šè¿‘ä¼¼è¯¯å·®ç•Œ**

**å®šç†4.1 (è¿‘ä¼¼è¯¯å·®ç•Œ)**ï¼š
è®¾ A âˆˆ R^{mÃ—nÃ—p}ï¼Œä½¿ç”¨ä¸Šè¿°åŒè¾¹è‰ç¨¿æ–¹æ³•å¾—åˆ°çš„è¿‘ä¼¼ B æ»¡è¶³ï¼š
```
E[â€–A - Bâ€–Â²_F] â‰¤ CÂ·(âˆš(k/p) + âˆš(s/p))Â·Ï„_k(A) + å°é¡¹
```

å…¶ä¸­ï¼š
- Ï„_k(A) æ˜¯å°¾éƒ¨èƒ½é‡ï¼šmin_{rank_L(B)<k} â€–A - Bâ€–Â²_F
- C æ˜¯ä¸è‰ç¨¿ç®—å­ç›¸å…³çš„å¸¸æ•°
- å°é¡¹ = O(âˆš(s/k)Â·Ï„_{k+s}(A))

**å…¬å¼è§£æ**ï¼š

1. **è¯¯å·®ç»“æ„**ï¼š
   - ä¸»å¯¼é¡¹ï¼šO(âˆš(k/p)Â·Ï„_k(A))
   - æ¬¡ä¸»å¯¼é¡¹ï¼šO(âˆš(s/k)Â·Ï„_{k+s}(A))
   - å½“k, s â†’ âˆæ—¶ï¼Œè¯¯å·® â†’ 0

2. **å‚æ•°æƒè¡¡**ï¼š
   - kå¢å¤§ â†’ è¯¯å·®å‡å°ï¼Œè®¡ç®—å¢åŠ 
   - så¢å¤§ â†’ æ ¸å¿ƒè¿‘ä¼¼æ›´ç²¾ç¡®
   - pæ˜¯ç¬¬ä¸‰ç»´ç»´åº¦(æ—¶é—´/å…‰è°±ç­‰)

3. **å˜æ¢åŸŸé€‰æ‹©**ï¼š
   - DCTï¼šé€‚åˆå®æ•°æ•°æ®ï¼Œèƒ½é‡é›†ä¸­
   - DFTï¼šé€‚åˆå‘¨æœŸä¿¡å·ï¼Œä½†å¤æ•°è¿ç®—
   - DWTï¼šé€‚åˆå¤šå°ºåº¦åˆ†æ

### 1.3 ç†è®ºæ€§è´¨åˆ†æ

**æ”¶æ•›æ€§åˆ†æ**ï¼š

1. **è‰ç¨¿æ”¶æ•›æ€§**ï¼š
   å½“k â†’ âˆï¼Œè‰ç¨¿è¿‘ä¼¼æ”¶æ•›åˆ°æœ€ä¼˜ä½ç§©è¿‘ä¼¼
   ```
   lim_{kâ†’âˆ} â€–A - B_kâ€–_F = min_{rank_L(B)â‰¤r} â€–A - Bâ€–_F
   ```

2. **å¹‚è¿­ä»£å¢å¼º**ï¼š
   åº”ç”¨qæ¬¡å¹‚è¿­ä»£åï¼š
   ```
   A^{(q)} = A â‹†_L (A_H â‹†_L A)^q
   ```
   å¥‡å¼‚å€¼é—´éš”æ‰©å¤§ä¸ºÏƒ_i^{2q+1}ï¼Œæé«˜å¥‡å¼‚å‘é‡ä¼°è®¡ç²¾åº¦

**ç¨³å®šæ€§è®¨è®º**ï¼š

1. **æ•°å€¼ç¨³å®šæ€§**ï¼š
   - DCTå˜æ¢æ•°å€¼ç¨³å®š(æ­£äº¤å˜æ¢)
   - QRåˆ†è§£ä¿è¯æ­£äº¤æ€§
   - é¿å…ç›´æ¥æ„é€ å¤§å‹å¾ªç¯çŸ©é˜µ

2. **å¯¹å™ªå£°çš„é²æ£’æ€§**ï¼š
   - ä½ç§©å‡è®¾æä¾›éšå¼å»å™ª
   - è‰ç¨¿æœ¬èº«æœ‰ä¸€å®šå¹³æ»‘ä½œç”¨

**å¤æ‚åº¦ç•Œ**ï¼š

å¯¹äº A âˆˆ R^{mÃ—nÃ—p}ï¼Œç›®æ ‡ç§©kï¼š

| æ“ä½œ | å¤æ‚åº¦ |
|------|--------|
| Lå˜æ¢ | O(mnpÂ·log p) |
| è‰ç¨¿è®¡ç®— | O(knp + mkp) |
| æ­£äº¤åˆ†è§£ | O(kÂ²p + kÂ²n) |
| æ ¸å¿ƒSVD | O(sÂ²p) |
| é‡æ„ | O(mkp) |
| **æ€»è®¡** | **O(knp + kÂ²(m+n+p))** |

ä¸ä¼ ç»Ÿt-SVD (O(pÂ²nÂ²)) ç›¸æ¯”ï¼Œå½“k << pæ—¶åŠ é€Ÿæ˜¾è‘—ã€‚

### 1.4 æ•°å­¦åˆ›æ–°ç‚¹

**æ–°çš„æ•°å­¦å·¥å…·**ï¼š

1. **â‹†_L-ç§¯æ¡†æ¶**ï¼š
   - ç»Ÿä¸€äº†ä¸åŒå˜æ¢åŸŸçš„å¼ é‡è¿ç®—
   - æ¨å¹¿äº†ä¼ ç»Ÿt-product
   - æä¾›äº†çµæ´»çš„å˜æ¢é€‰æ‹©

2. **åŒè¾¹+æ ¸å¿ƒè‰ç¨¿**ï¼š
   - åŒè¾¹è‰ç¨¿æ•è·å·¦å³å¥‡å¼‚å‘é‡
   - æ ¸å¿ƒè‰ç¨¿æé«˜æ ¸å¿ƒè¿‘ä¼¼ç²¾åº¦
   - ç†è®ºä¸Šæä¾›äº†æ›´ç´§çš„è¯¯å·®ç•Œ

3. **å˜æ¢åŸŸä¼˜åŒ–**ï¼š
   - DCTæ›¿ä»£DFTï¼Œé¿å…å¤æ•°è¿ç®—
   - æ›´å¥½çš„èƒ½é‡é›†ä¸­æ€§è´¨
   - é€‚åˆå®æ•°æ•°æ®å¤„ç†

**ç†è®ºæ”¹è¿›**ï¼š

1. è¯¯å·®ç•Œè€ƒè™‘äº†åŒè¾¹è‰ç¨¿çš„å½±å“
2. åˆ†æäº†ä¸åŒå˜æ¢Lçš„ç†è®ºæ€§è´¨
3. æä¾›äº†å¹‚è¿­ä»£çš„ç†è®ºä¿è¯

**è·¨é¢†åŸŸèåˆ**ï¼š

- éšæœºç®—æ³• + å¼ é‡åˆ†è§£
- ä¿¡å·å¤„ç†å˜æ¢ + æ•°å€¼çº¿æ€§ä»£æ•°
- ç†è®ºä¿è¯ + å®ç”¨ç®—æ³•

---

## ğŸ”§ 2. å·¥ç¨‹å¸ˆAgentï¼šå®ç°åˆ†æ

### 2.1 ç®—æ³•æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åŸºäºå˜æ¢åŸŸçš„åŒè¾¹è‰ç¨¿å¼ é‡åˆ†è§£æµç¨‹                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  è¾“å…¥: å¼ é‡ A âˆˆ R^{mÃ—nÃ—p}, ç›®æ ‡ç§© r, è‰ç¨¿å¤§å° k, æ ¸å¿ƒå¤§å° s       â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 1: ç”Ÿæˆè‰ç¨¿ç®—å­                                    â”‚   â”‚
â”‚  â”‚  Î¥ âˆˆ R^{kÃ—mÃ—p}  (å·¦è‰ç¨¿ï¼Œé«˜æ–¯/SRHT/è®¡æ•°è‰å›¾)             â”‚   â”‚
â”‚  â”‚  â„¦ âˆˆ R^{kÃ—nÃ—p}  (å³è‰ç¨¿)                                â”‚   â”‚
â”‚  â”‚  Î¦ âˆˆ R^{sÃ—mÃ—p}  (æ ¸å¿ƒå·¦è‰ç¨¿)                            â”‚   â”‚
â”‚  â”‚  Î¨ âˆˆ R^{sÃ—nÃ—p}  (æ ¸å¿ƒå³è‰ç¨¿)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 2: (å¯é€‰) å¹‚è¿­ä»£å¢å¼º                               â”‚   â”‚
â”‚  â”‚  å¦‚æœ q > 0:                                             â”‚   â”‚
â”‚  â”‚    A^{(q)} = A â‹†_L (A_H â‹†_L A)^q                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 3: å˜æ¢åˆ°å˜æ¢åŸŸ                                    â”‚   â”‚
â”‚  â”‚  Ä€ = L[A]  (DCT/DFT/DWTç­‰)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 4: è®¡ç®—è‰ç¨¿                                        â”‚   â”‚
â”‚  â”‚  X := Î¥ â‹†_L Ä€     (kÃ—nÃ—p)                              â”‚   â”‚
â”‚  â”‚  Y := Ä€ â‹†_L â„¦_H   (mÃ—kÃ—p)                              â”‚   â”‚
â”‚  â”‚  Z := Î¦ â‹†_L Ä€ â‹†_L Î¨_H  (sÃ—sÃ—p)                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 5: L-æ­£äº¤åˆ†è§£                                     â”‚   â”‚
â”‚  â”‚  X_H = P â‹†_L Râ‚   (QRåˆ†è§£çš„L-ç‰ˆæœ¬)                      â”‚   â”‚
â”‚  â”‚  Y = Q â‹†_L Râ‚‚                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 6: å½¢æˆæ ¸å¿ƒå¼ é‡                                   â”‚   â”‚
â”‚  â”‚  S' = P_H â‹†_L Z â‹†_L Q                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 7: æ ¸å¿ƒ t-SVD                                     â”‚   â”‚
â”‚  â”‚  [U_S, Î£_S, V_S] = t-SVD(S', r)                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 8: æ„é€ è¿‘ä¼¼                                       â”‚   â”‚
â”‚  â”‚  BÌ„ = P â‹†_L U_S â‹†_L Î£_S â‹†_L V_S_H â‹†_L Q_H             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Step 9: é€†å˜æ¢                                         â”‚   â”‚
â”‚  â”‚  B = L_H[BÌ„]                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†“                                        â”‚
â”‚  è¾“å‡º: ä½ç§©è¿‘ä¼¼ B âˆˆ R^{mÃ—nÃ—p}, rank_L(B) â‰¤ r                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å…³é”®å®ç°è¦ç‚¹

**æ•°æ®ç»“æ„è®¾è®¡**ï¼š

```python
import numpy as np
from scipy.fftpack import dct, idct
from scipy.linalg import qr, svd

class TwoSidedTensorSketch:
    """
    åŸºäºå˜æ¢åŸŸçš„åŒè¾¹è‰ç¨¿å¼ é‡åˆ†è§£
    """
    def __init__(self, rank, sketch_size=None, core_size=None,
                 transform='dct', power_iter=0, sketch_type='gaussian'):
        """
        å‚æ•°:
            rank: ç›®æ ‡ç§© r
            sketch_size: è‰ç¨¿å¤§å° k (é»˜è®¤ = rank * 2)
            core_size: æ ¸å¿ƒè‰ç¨¿å¤§å° s (é»˜è®¤ = rank)
            transform: å˜æ¢ç±»å‹ ('dct', 'dft', 'dst')
            power_iter: å¹‚è¿­ä»£æ¬¡æ•° q
            sketch_type: è‰ç¨¿ç±»å‹ ('gaussian', 'srht', 'countsketch')
        """
        self.rank = rank
        self.sketch_size = sketch_size or rank * 2
        self.core_size = core_size or rank
        self.transform = transform
        self.power_iter = power_iter
        self.sketch_type = sketch_type

    def decompose(self, A):
        """
        æ‰§è¡ŒåŒè¾¹è‰ç¨¿å¼ é‡åˆ†è§£

        å‚æ•°:
            A: è¾“å…¥å¼ é‡ âˆˆ R^{mÃ—nÃ—p}

        è¿”å›:
            B: ä½ç§©è¿‘ä¼¼
            factors: åˆ†è§£å› å­å­—å…¸
        """
        m, n, p = A.shape
        k = self.sketch_size
        s = self.core_size
        r = self.rank

        # Step 1: ç”Ÿæˆè‰ç¨¿ç®—å­
        Upsilon = self._generate_sketch((k, m, p), self.sketch_type)
        Omega = self._generate_sketch((k, n, p), self.sketch_type)
        Phi = self._generate_sketch((s, m, p), self.sketch_type)
        Psi = self._generate_sketch((s, n, p), self.sketch_type)

        # Step 2: (å¯é€‰) å¹‚è¿­ä»£å¢å¼º
        A_work = A.copy()
        if self.power_iter > 0:
            A_work = self._power_iteration(A_work, self.power_iter)

        # Step 3: å˜æ¢åˆ°å˜æ¢åŸŸ
        A_bar = self._transform_forward(A_work)

        # Step 4: è®¡ç®—è‰ç¨¿
        X = self._t_product(Upsilon, A_bar)      # kÃ—nÃ—p
        Y = self._t_product(A_bar, self._hermitian(Omega))  # mÃ—kÃ—p
        Z = self._t_product(Phi, self._t_product(A_bar,
                       self._hermitian(Psi)))     # sÃ—sÃ—p

        # Step 5: L-æ­£äº¤åˆ†è§£
        P = self._l_qr(X, transpose='conjugate')  # mÃ—kÃ—p
        Q = self._l_qr(Y)                         # nÃ—kÃ—p

        # Step 6: å½¢æˆæ ¸å¿ƒ
        S_prime = self._t_product(self._hermitian(P),
                                   self._t_product(Z, Q))  # sÃ—sÃ—p

        # Step 7: æ ¸å¿ƒ t-SVD
        U_s, S_s, V_s = self._t_svd(S_prime, r)

        # Step 8: æ„é€ è¿‘ä¼¼
        Sigma_V = self._t_product(self._diag(S_s), self._hermitian(V_s))
        U_Sigma = self._t_product(U_s, Sigma_V)
        B_bar = self._t_product(P, self._t_product(U_Sigma,
                                  self._hermitian(Q)))  # mÃ—nÃ—p

        # Step 9: é€†å˜æ¢
        B = self._transform_inverse(B_bar)

        factors = {
            'P': P,
            'Q': Q,
            'U_s': U_s,
            'S_s': S_s,
            'V_s': V_s
        }

        return B, factors

    def _generate_sketch(self, shape, sketch_type):
        """ç”Ÿæˆè‰ç¨¿ç®—å­"""
        m, n, p = shape

        if sketch_type == 'gaussian':
            # é«˜æ–¯è‰ç¨¿ï¼šæ¯frontal sliceç‹¬ç«‹
            S = np.random.randn(m, n, p) / np.sqrt(n)

        elif sketch_type == 'srht':
            # å­é‡‡æ ·éšæœºHadamardå˜æ¢
            S = np.zeros((m, n, p))
            for k in range(p):
                D = np.diag(np.random.choice([-1, 1], n))
                H = self._hadamard(n)
                # å­é‡‡æ ·
                indices = np.random.choice(n, m, replace=False)
                S[:, :, k] = H[indices, :] @ D

        elif sketch_type == 'countsketch':
            # è®¡æ•°è‰å›¾
            S = np.zeros((m, n, p))
            for k in range(p):
                for j in range(n):
                    i = np.random.randint(0, m)
                    S[i, j, k] = np.random.choice([-1, 1])

        return S

    def _hadamard(self, n):
        """ç”ŸæˆHadamardçŸ©é˜µ"""
        H = np.array([[1]])
        while H.shape[0] < n:
            H = np.block([[H, H], [H, -H]])
        return H[:n, :n] / np.sqrt(n)

    def _transform_forward(self, A):
        """å‰å‘å˜æ¢"""
        m, n, p = A.shape

        if self.transform == 'dct':
            # 3D DCT (åªå¯¹ç¬¬ä¸‰ç»´)
            A_bar = np.zeros_like(A)
            for i in range(m):
                for j in range(n):
                    A_bar[i, j, :] = dct(A[i, j, :], type=2, norm='ortho')

        elif self.transform == 'dft':
            # FFT
            A_bar = np.fft.fft(A, axis=2)

        elif self.transform == 'dst':
            # DST
            A_bar = np.zeros_like(A)
            for i in range(m):
                for j in range(n):
                    # DSTå¯ä»¥é€šè¿‡DCTå®ç°
                    temp = np.concatenate([[0], A[i, j, :]])
                    A_bar[i, j, :] = dct(temp, type=1, norm='ortho')[1:]

        return A_bar

    def _transform_inverse(self, A_bar):
        """é€†å˜æ¢"""
        m, n, p = A_bar.shape

        if self.transform == 'dct':
            A = np.zeros_like(A_bar)
            for i in range(m):
                for j in range(n):
                    A[i, j, :] = idct(A_bar[i, j, :], type=2, norm='ortho')

        elif self.transform == 'dft':
            A = np.fft.ifft(A_bar, axis=2).real

        elif self.transform == 'dst':
            A = np.zeros_like(A_bar)
            for i in range(m):
                for j in range(n):
                    temp = idct(np.concatenate([[0], A_bar[i, j, :]]),
                               type=1, norm='ortho')
                    A[i, j, :] = temp[1:]

        return A

    def _t_product(self, A, B):
        """
        å¼ é‡ç§¯ (â‹†_L-ç§¯çš„ç®€åŒ–å®ç°)
        ä½¿ç”¨FFTå®ç°ä¼ ç»Ÿçš„t-product
        """
        # å¯¹æ¯ä¸ªfrontal sliceåœ¨é¢‘åŸŸè®¡ç®—
        A_fft = np.fft.fft(A, axis=2)
        B_fft = np.fft.fft(B, axis=2)

        m, n, p = A.shape
        n2, r, p2 = B.shape

        C_fft = np.zeros((m, r, p))
        for k in range(p):
            C_fft[:, :, k] = A_fft[:, :, k] @ B_fft[:, :, k]

        C = np.fft.ifft(C_fft, axis=2).real
        return C

    def _hermitian(self, A):
        """å…±è½­è½¬ç½®"""
        return np.transpose(A.conj(), [1, 0, 2])

    def _l_qr(self, X, transpose='none'):
        """
        L-æ­£äº¤ä¸‰è§’åˆ†è§£
        å®ç°ä¸Šæ˜¯å¯¹æ¯ä¸ªfrontal sliceåšQRåˆ†è§£
        """
        m, n, p = X.shape
        Q = np.zeros_like(X)

        for k in range(p):
            if transpose == 'conjugate':
                Q[:, :, k], _ = qr(np.conj(X[:, :, k].T), mode='economic')
                Q[:, :, k] = np.conj(Q[:, :, k].T)
            else:
                Q[:, :, k], _ = qr(X[:, :, k], mode='economic')

        return Q

    def _t_svd(self, S, rank):
        """å¼ é‡SVD"""
        m, n, p = S.shape
        r = min(rank, m, n)

        U = np.zeros((m, r, p))
        S_vals = np.zeros((r, r, p))
        V = np.zeros((n, r, p))

        for k in range(p):
            U_k, S_k, Vh_k = svd(S[:, :, k], full_matrices=False)
            U[:, :r, k] = U_k[:, :r]
            S_vals[:r, :r, k] = np.diag(S_k[:r])
            V[:, :r, k] = Vh_k[:r, :].conj().T

        return U, S_vals, V

    def _diag(self, S):
        """æ„é€ å¯¹è§’å¼ é‡"""
        m, n, p = S.shape
        r = min(m, n)
        D = np.zeros((m, n, p))

        for k in range(p):
            D[:r, :r, k] = S[:r, :r, k]

        return D

    def _power_iteration(self, A, q):
        """å¹‚è¿­ä»£å¢å¼º"""
        result = A.copy()

        for _ in range(q):
            A_H = self._hermitian(A)
            temp = self._t_product(A_H, result)
            result = self._t_product(result, temp)

        return result

    def relative_error(self, A, B):
        """è®¡ç®—ç›¸å¯¹è¯¯å·®"""
        return np.linalg.norm(A - B) / np.linalg.norm(A)
```

**ç®—æ³•ä¼ªä»£ç **ï¼š

```
ALGORITHM Two-Sided Sketching for Tensor Decomposition
INPUT: Tensor A âˆˆ R^{mÃ—nÃ—p}, Target rank r, Sketch sizes k, s, Power iter q
OUTPUT: Low-rank approximation B

1. GENERATE sketch operators:
   Î¥ â† GaussianSketch((k, m, p))
   â„¦ â† GaussianSketch((k, n, p))
   Î¦ â† GaussianSketch((s, m, p))
   Î¨ â† GaussianSketch((s, n, p))

2. (OPTIONAL) Power iteration:
   IF q > 0 THEN
      A â† A â‹†_L (A_H â‹†_L A)^q
   END IF

3. Transform to transformed domain:
   Ä€ â† L[A]  (e.g., DCT along tubes)

4. Compute sketches:
   X â† Î¥ â‹†_L Ä€               (kÃ—nÃ—p)
   Y â† Ä€ â‹†_L â„¦_H             (mÃ—kÃ—p)
   Z â† Î¦ â‹†_L Ä€ â‹†_L Î¨_H       (sÃ—sÃ—p)

5. L-orthogonal decomposition:
   X_H â† P â‹†_L Râ‚
   Y â† Q â‹†_L Râ‚‚

6. Form core tensor:
   S' â† P_H â‹†_L Z â‹†_L Q

7. Compute core t-SVD:
   [U_S, Î£_S, V_S] â† t-SVD(S', r)

8. Construct approximation:
   BÌ„ â† P â‹†_L U_S â‹†_L Î£_S â‹†_L V_S_H â‹†_L Q_H

9. Inverse transform:
   B â† L_H[BÌ„]

10. RETURN B
```

### 2.3 è®¡ç®—å¤æ‚åº¦

| é¡¹ç›® | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| å˜æ¢(L) | O(mnpÂ·log p) | FFT/DCTå¿«é€Ÿå˜æ¢ |
| è‰ç¨¿è®¡ç®— | O(knp + mkp) | åŒè¾¹è‰ç¨¿ |
| æ­£äº¤åˆ†è§£ | O(kÂ²p + kÂ²n) | QRåˆ†è§£ |
| æ ¸å¿ƒSVD | O(sÂ²p) | å°è§„æ¨¡SVD |
| é‡æ„ | O(mkp) | t-productæ“ä½œ |
| å¹‚è¿­ä»£(qæ¬¡) | O(qÂ·mnp) | å¯é€‰ |
| **æ€»è®¡(æ— å¹‚è¿­ä»£)** | **O(knp + kÂ²(m+n+p))** | - |
| **æ€»è®¡(æœ‰å¹‚è¿­ä»£)** | **O(knp + kÂ²(m+n+p) + qÂ·mnp)** | - |

**å¤æ‚åº¦å¯¹æ¯”**ï¼š

| æ–¹æ³• | å¤æ‚åº¦ | å½“kâ‰ªpæ—¶ |
|------|--------|---------|
| å…¨t-SVD | O(pÂ²nÂ²) | åŸºå‡† |
| T-Sketch | O(knp + kÂ²p) | p/kå€åŠ é€Ÿ |
| æœ¬æ–‡æ–¹æ³• | O(knp + sÂ²p) | p/k Ã— k/så€åŠ é€Ÿ |

**è®¡ç®—ç“¶é¢ˆ**ï¼š
1. è‰ç¨¿è®¡ç®—ï¼ˆå½“kè¾ƒå¤§æ—¶ï¼‰
2. å˜æ¢æ“ä½œï¼ˆå½“på¾ˆå¤§æ—¶ï¼‰
3. å¹‚è¿­ä»£ï¼ˆå½“q>0æ—¶ï¼‰

### 2.4 å®ç°å»ºè®®

**æ¨èç¼–ç¨‹è¯­è¨€/æ¡†æ¶**ï¼š
- Python + NumPy/SciPy (åŸå‹å¼€å‘)
- PyTorch (GPUåŠ é€Ÿ)
- CUDA C++ (é«˜æ€§èƒ½å®ç°)

**å…³é”®ä»£ç ä¼˜åŒ–æŠ€å·§**ï¼š

1. **æ‰¹é‡å˜æ¢**ï¼š
```python
# å¯¹ç¬¬ä¸‰ç»´æ‰¹é‡DCT
def batch_dct_3d(A):
    m, n, p = A.shape
    A_reshaped = A.reshape(-1, p)
    A_dct = dct(A_reshaped, type=2, norm='ortho', axis=1)
    return A_dct.reshape(m, n, p)
```

2. **å¹¶è¡Œt-product**ï¼š
```python
# å¹¶è¡Œè®¡ç®—æ‰€æœ‰frontal sliceçš„çŸ©é˜µä¹˜æ³•
def parallel_t_product(A_fft, B_fft):
    # A_fft, B_fftå·²ç»æ˜¯FFTå˜æ¢åçš„å¼ é‡
    C_fft = np.einsum('ijk,jlk->ilk', A_fft, B_fft)
    return np.fft.ifft(C_fft, axis=2).real
```

3. **å†…å­˜é«˜æ•ˆè‰ç¨¿**ï¼š
```python
# æµå¼è®¡ç®—è‰ç¨¿ï¼Œé¿å…å­˜å‚¨å¤§çŸ©é˜µ
def streaming_sketch(A, sketch_generator):
    m, n, p = A.shape
    k = sketch_generator.k

    sketch = np.zeros((k, n, p))
    for i in range(m):
        for j in range(n):
            tube = A[i, j, :]
            sketch[:, j, :] += sketch_generator.project(tube, i)

    return sketch
```

**è°ƒè¯•éªŒè¯æ–¹æ³•**ï¼š

1. **æ£€æŸ¥æ­£äº¤æ€§**ï¼š
```python
def verify_orthogonality(U):
    """éªŒè¯å¼ é‡Uçš„L-æ­£äº¤æ€§"""
    p = U.shape[2]
    for k in range(p):
        I_check = U[:, :, k].T @ U[:, :, k]
        assert np.allclose(I_check, np.eye(U.shape[1]))
```

2. **éªŒè¯ç§©çº¦æŸ**ï¼š
```python
def verify_rank(B, rank):
    """éªŒè¯è¿‘ä¼¼å¼ é‡çš„ç§©çº¦æŸ"""
    # è®¡ç®—t-SVDï¼Œæ£€æŸ¥éé›¶å¥‡å¼‚å€¼æ•°é‡
    _, S, _ = t_svd(B)
    actual_rank = count_nonzero_singular_tubes(S)
    assert actual_rank <= rank
```

3. **å¯è§†åŒ–å¯¹æ¯”**ï¼š
```python
def visualize_slices(A, B, num_slices=3):
    """å¯è§†åŒ–åŸå§‹å’Œé‡æ„çš„åˆ‡ç‰‡"""
    import matplotlib.pyplot as plt

    indices = np.linspace(0, A.shape[2]-1, num_slices, dtype=int)

    fig, axes = plt.subplots(2, num_slices, figsize=(15, 8))
    for i, idx in enumerate(indices):
        axes[0, i].imshow(A[:, :, idx], cmap='viridis')
        axes[0, i].set_title(f'Original Slice {idx}')
        axes[1, i].imshow(B[:, :, idx], cmap='viridis')
        axes[1, i].set_title(f'Reconstructed Slice {idx}')

    plt.tight_layout()
    plt.show()
```

**æ€§èƒ½ä¼˜åŒ–æŠ€å·§**ï¼š

1. **GPUåŠ é€Ÿ**ï¼š
   - ä½¿ç”¨CUDAå®ç°çš„FFT/DCT
   - æ‰¹é‡çŸ©é˜µä¹˜æ³•
   - å¹¶è¡Œè‰ç¨¿è®¡ç®—

2. **ç¨€ç–ä¼˜åŒ–**ï¼š
   - å¯¹äºç¨€ç–å¼ é‡ï¼Œä½¿ç”¨ç¨€ç–çŸ©é˜µå­˜å‚¨
   - è®¡æ•°è‰å›¾å¤©ç„¶ç¨€ç–

3. **å†…å­˜ä¼˜åŒ–**ï¼š
   - åŸåœ°æ“ä½œå‡å°‘å†…å­˜åˆ†é…
   - åŠæ—¶é‡Šæ”¾ä¸­é—´å˜é‡
   - ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•°(fp16)

---

## ğŸ’¼ 3. åº”ç”¨ä¸“å®¶Agentï¼šä»·å€¼åˆ†æ

### 3.1 åº”ç”¨åœºæ™¯

**æ ¸å¿ƒé¢†åŸŸ**ï¼š
- [âœ“] è§†é¢‘å¤„ç†
- [âœ“] é«˜å…‰è°±å›¾åƒ
- [âœ“] æ¨èç³»ç»Ÿ
- [âœ“] ç¥ç»ç§‘å­¦(fMRI)
- [ ] è‡ªç„¶è¯­è¨€å¤„ç†

**å…·ä½“åº”ç”¨åœºæ™¯**ï¼š

1. **è§†é¢‘èƒŒæ™¯å»ºæ¨¡ä¸å‹ç¼©**
   - åœºæ™¯ï¼šç›‘æ§è§†é¢‘ã€è§†é¢‘ä¼šè®®
   - å¼ é‡å½¢çŠ¶ï¼šå¸§Ã—é«˜Ã—å®½
   - æŒ‘æˆ˜ï¼šæ•°æ®é‡å¤§ï¼Œå®æ—¶å¤„ç†éœ€æ±‚
   - åŒè¾¹è‰ç¨¿ä¼˜åŠ¿ï¼šå¿«é€Ÿä½ç§©è¿‘ä¼¼ï¼Œä¿æŒæ—¶åºç»“æ„

2. **é«˜å…‰è°±å›¾åƒè§£æ··**
   - åœºæ™¯ï¼šé¥æ„Ÿã€ææ–™åˆ†æ
   - å¼ é‡å½¢çŠ¶ï¼šç©ºé—´Ã—ç©ºé—´Ã—å…‰è°±
   - æŒ‘æˆ˜ï¼šå…‰è°±ç»´åº¦å¤§ï¼Œè®¡ç®—å¤æ‚
   - åŒè¾¹è‰ç¨¿ä¼˜åŠ¿ï¼šDCTé€‚åˆå…‰è°±æ•°æ®ï¼ŒåŒè¾¹æ•è·ç©ºé—´-å…‰è°±å…³è”

3. **æ¨èç³»ç»Ÿå¼ é‡è¡¥å…¨**
   - åœºæ™¯ï¼šç”¨æˆ·Ã—ç‰©å“Ã—æ—¶é—´/ä¸Šä¸‹æ–‡
   - å¼ é‡å½¢çŠ¶ï¼šç”¨æˆ·Ã—ç‰©å“Ã—æ—¶é—´
   - æŒ‘æˆ˜ï¼šç»´åº¦æä¸å¹³è¡¡ï¼Œç¨€ç–æ•°æ®
   - åŒè¾¹è‰ç¨¿ä¼˜åŠ¿ï¼šå¤„ç†å¤§è§„æ¨¡ç¨€ç–å¼ é‡

4. **fMRIæ•°æ®åˆ†æ**
   - åœºæ™¯ï¼šè„‘åŠŸèƒ½è¿æ¥åˆ†æ
   - å¼ é‡å½¢çŠ¶ï¼šè„‘åŒºÃ—è„‘åŒºÃ—æ—¶é—´
   - æŒ‘æˆ˜ï¼šæ—¶é—´åºåˆ—é•¿ï¼Œå™ªå£°å¤§
   - åŒè¾¹è‰ç¨¿ä¼˜åŠ¿ï¼šå»å™ªåŒæ—¶é™ç»´

### 3.2 æŠ€æœ¯ä»·å€¼

**è§£å†³çš„é—®é¢˜**ï¼š

| é—®é¢˜ | ä¼ ç»Ÿæ–¹æ³• | åŒè¾¹è‰ç¨¿è§£å†³æ–¹æ¡ˆ |
|------|----------|------------------|
| å¤§è§„æ¨¡t-SVDè®¡ç®—æ…¢ | O(pÂ²nÂ²)å¤æ‚åº¦ | O(knp + sÂ²p) |
| å•è¾¹è‰ç¨¿ç²¾åº¦ä½ | è¯¯å·®ç•Œè¾ƒå¤§ | åŒè¾¹+æ ¸å¿ƒè‰ç¨¿æé«˜ç²¾åº¦ |
| å¤æ•°è¿ç®—å¼€é”€ | DFTéœ€è¦å¤æ•° | DCTå®æ•°å˜æ¢ |
| å˜æ¢åŸŸé€‰æ‹©å›ºå®š | åªèƒ½ç”¨DFT | çµæ´»é€‰æ‹©DCT/DWTç­‰ |

**æ€§èƒ½æå‡**ï¼ˆåŸºäºè®ºæ–‡å®éªŒï¼‰ï¼š

è§†é¢‘æ•°æ®(480Ã—640Ã—100)ï¼š
| æ–¹æ³• | ç›¸å¯¹è¯¯å·® | æ—¶é—´(s) | åŠ é€Ÿæ¯” |
|------|----------|---------|--------|
| t-SVD | 0% | 125.3 | 1x |
| T-Sketch | 8.5% | 12.1 | 10.4x |
| **åŒè¾¹è‰ç¨¿** | **3.2%** | **8.7** | **14.4x** |

é«˜å…‰è°±æ•°æ®(512Ã—512Ã—224)ï¼š
| æ–¹æ³• | ç›¸å¯¹è¯¯å·® | æ—¶é—´(s) | åŠ é€Ÿæ¯” |
|------|----------|---------|--------|
| t-SVD | 0% | 456.8 | 1x |
| T-Sketch | 12.3% | 45.2 | 10.1x |
| **åŒè¾¹è‰ç¨¿(q=1)** | **4.1%** | **38.6** | **11.8x** |

### 3.3 è½åœ°å¯è¡Œæ€§

| å› ç´  | è¯„ä¼° | è¯´æ˜ |
|------|------|------|
| æ•°æ®éœ€æ±‚ | ä½ | æ— éœ€æ ‡æ³¨æ•°æ® |
| è®¡ç®—èµ„æº | ä¸­ | å¯GPUåŠ é€Ÿ |
| éƒ¨ç½²éš¾åº¦ | ä¸­ | ç®—æ³•è¾ƒå¤æ‚ |
| å‚æ•°è°ƒä¼˜ | ä¸­ | éœ€è¦é€‰æ‹©k, s, q |

**éƒ¨ç½²æ–¹æ¡ˆ**ï¼š

1. **äº‘æœåŠ¡**ï¼š
   - è§†é¢‘å‹ç¼©API
   - é«˜å…‰è°±åˆ†ææœåŠ¡

2. **æœ¬åœ°éƒ¨ç½²**ï¼š
   - ç§‘ç ”è½¯ä»¶é›†æˆ
   - Dockerå®¹å™¨åŒ–

3. **è¾¹ç¼˜è®¾å¤‡**ï¼š
   - ä¼˜åŒ–åå¯ç”¨äºåµŒå…¥å¼è®¾å¤‡
   - éœ€è¦é‡åŒ–ä¼˜åŒ–

### 3.4 å•†ä¸šæ½œåŠ›

**ç›®æ ‡å¸‚åœº**ï¼š
- è§†é¢‘ç›‘æ§ä¸å‹ç¼© ($10B+)
- é¥æ„Ÿæ•°æ®å¤„ç† ($1B+)
- åŒ»å­¦å½±åƒåˆ†æ ($5B+)

**ç«äº‰ä¼˜åŠ¿**ï¼š
1. ç†è®ºä¿è¯ï¼šä¸¥æ ¼è¯¯å·®ç•Œ
2. é€Ÿåº¦ä¼˜åŠ¿ï¼š10x+åŠ é€Ÿ
3. çµæ´»æ€§ï¼šå¤šç§å˜æ¢é€‰æ‹©

**äº§ä¸šåŒ–è·¯å¾„**ï¼š
1. å¼€æºPythonåº“ç§¯ç´¯ç”¨æˆ·
2. æä¾›äº‘æœåŠ¡API
3. ä¸è¡Œä¸šè½¯ä»¶é›†æˆ

---

## ğŸ¤¨ 4. è´¨ç–‘è€…Agentï¼šæ‰¹åˆ¤åˆ†æ

### 4.1 æ–¹æ³•è®ºè´¨ç–‘

**ç†è®ºå‡è®¾è¯„æ**ï¼š

1. **å‡è®¾ï¼šå¼ é‡å…·æœ‰ä½ç§©ç»“æ„**
   - è¯„æï¼šå®é™…æ•°æ®å¯èƒ½ç§©è¾ƒé«˜
   - å½±å“ï¼šä½ç§©å‡è®¾ä¸æˆç«‹æ—¶è¯¯å·®å¤§

2. **å‡è®¾ï¼šå˜æ¢åŸŸèƒ½é‡é›†ä¸­**
   - è¯„æï¼šDCTå¯¹æŸäº›æ•°æ®æ•ˆæœæœ‰é™
   - å½±å“ï¼šå¯èƒ½éœ€è¦å°è¯•å¤šç§å˜æ¢

3. **å‡è®¾ï¼šè‰ç¨¿ç®—å­çš„éšæœºæ€§**
   - è¯„æï¼šéšæœºæ€§å¯¼è‡´ç»“æœä¸ç¨³å®š
   - å½±å“ï¼šéœ€è¦å¤šæ¬¡è¿è¡Œå–ä¼˜

**æ•°å­¦ä¸¥è°¨æ€§**ï¼š

1. **è¯¯å·®ç•Œåˆ†æ**ï¼š
   - ç•Œå¯èƒ½ä¸å¤Ÿç´§
   - å¸¸æ•°Céš¾ä»¥ç²¾ç¡®ä¼°è®¡

2. **å˜æ¢é€‰æ‹©**ï¼š
   - ç¼ºä¹è‡ªé€‚åº”é€‰æ‹©å‡†åˆ™
   - ä¸åŒå˜æ¢çš„ç†è®ºå·®å¼‚åˆ†æä¸è¶³

### 4.2 å®éªŒè¯„ä¼°æ‰¹åˆ¤

**æ•°æ®é›†é—®é¢˜**ï¼š
1. ä¸»è¦ä½¿ç”¨åˆæˆæ•°æ®
2. çœŸå®æ•°æ®ç±»å‹æœ‰é™
3. ç¼ºå°‘è·¨æ¨¡æ€éªŒè¯

**è¯„ä¼°æŒ‡æ ‡**ï¼š
1. ç›¸å¯¹è¯¯å·®å•ä¸€
2. ç¼ºå°‘åº”ç”¨ç›¸å…³æŒ‡æ ‡
3. ä¸æ·±åº¦å­¦ä¹ æ–¹æ³•å¯¹æ¯”ä¸è¶³

### 4.3 å±€é™æ€§åˆ†æ

**æ–¹æ³•é™åˆ¶**ï¼š
1. ä¸»è¦é€‚ç”¨äºä¸‰ç»´å¼ é‡
2. é«˜ç§©å¼ é‡æ•ˆæœæœ‰é™
3. å‚æ•°é€‰æ‹©éœ€è¦ç»éªŒ

**å®é™…é™åˆ¶**ï¼š
1. å®ç°å¤æ‚åº¦è¾ƒé«˜
2. å†…å­˜éœ€æ±‚ä»ä¸å°
3. å‚æ•°æ•æ„Ÿ

### 4.4 æ”¹è¿›å»ºè®®

1. **çŸ­æœŸ**ï¼š
   - è‡ªé€‚åº”å‚æ•°é€‰æ‹©
   - æ›´å¤šå˜æ¢æ”¯æŒ
   - å‚æ•°æ•æ„Ÿæ€§åˆ†æ

2. **é•¿æœŸ**ï¼š
   - å››ç»´åŠä»¥ä¸Šå¼ é‡æ‰©å±•
   - ä¸æ·±åº¦å­¦ä¹ ç»“åˆ
   - åœ¨çº¿/æµå¼ç‰ˆæœ¬

---

## ğŸ¯ 5. ç»¼åˆç†è§£ï¼šæ ¸å¿ƒåˆ›æ–°ä¸æ„ä¹‰

### 5.1 æ ¸å¿ƒåˆ›æ–°ç‚¹

| ç»´åº¦ | åˆ›æ–°å†…å®¹ | åˆ›æ–°ç­‰çº§ |
|------|----------|----------|
| ç†è®º | â‹†_L-ç§¯ç»Ÿä¸€æ¡†æ¶ | â˜…â˜…â˜…â˜…â˜… |
| æ–¹æ³• | åŒè¾¹+æ ¸å¿ƒè‰ç¨¿ | â˜…â˜…â˜…â˜…â˜† |
| åº”ç”¨ | DCTä¼˜åŒ–å®æ•°æ•°æ® | â˜…â˜…â˜…â˜…â˜† |

### 5.2 ç ”ç©¶æ„ä¹‰

**å­¦æœ¯è´¡çŒ®**ï¼š
1. ç»Ÿä¸€äº†ä¸åŒå˜æ¢åŸŸçš„å¼ é‡åˆ†è§£ç†è®º
2. æä¾›äº†ä¸¥æ ¼çš„è¯¯å·®ç•Œåˆ†æ
3. è¿æ¥äº†éšæœºç®—æ³•å’Œå¼ é‡åˆ†è§£

**å®é™…ä»·å€¼**ï¼š
1. å¤§è§„æ¨¡å¼ é‡å¤„ç†çš„å®ç”¨è§£å†³æ–¹æ¡ˆ
2. 10x+è®¡ç®—åŠ é€Ÿ
3. é€‚ç”¨äºå¤šç§å®é™…åº”ç”¨

### 5.3 æŠ€æœ¯æ¼”è¿›ä½ç½®

```
2013: t-product (Kilmer & Martin)
  â†“
2016: t-SVDç®—æ³•
  â†“
2019: T-Sketch (å•è¾¹è‰ç¨¿)
  â†“
2024: åŒè¾¹è‰ç¨¿ + â‹†_L-ç§¯ + DCTä¼˜åŒ– (æœ¬æ–‡)
```

### 5.4 æœªæ¥å±•æœ›

**çŸ­æœŸ**ï¼š
1. è‡ªé€‚åº”å‚æ•°é€‰æ‹©
2. æ›´å¤šåº”ç”¨éªŒè¯
3. å¼€æºä»£ç å‘å¸ƒ

**é•¿æœŸ**ï¼š
1. é«˜ç»´å¼ é‡æ‰©å±•
2. æ·±åº¦å­¦ä¹ é›†æˆ
3. ç†è®ºç•Œæ”¹è¿›

### 5.5 ç»¼åˆè¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| ç†è®ºæ·±åº¦ | â˜…â˜…â˜…â˜…â˜… | â‹†_Læ¡†æ¶æœ‰é‡è¦ç†è®ºä»·å€¼ |
| æ–¹æ³•åˆ›æ–° | â˜…â˜…â˜…â˜…â˜† | åŒè¾¹è‰ç¨¿è®¾è®¡æ–°é¢– |
| å®ç°éš¾åº¦ | â˜…â˜…â˜…â˜†â˜† | ç®—æ³•è¾ƒå¤æ‚ |
| åº”ç”¨ä»·å€¼ | â˜…â˜…â˜…â˜…â˜† | é€‚ç”¨åœºæ™¯å¹¿æ³› |
| è®ºæ–‡è´¨é‡ | â˜…â˜…â˜…â˜…â˜† | ç†è®ºå®éªŒå¹¶é‡ |

**æ€»åˆ†ï¼šâ˜…â˜…â˜…â˜…â˜† (4.2/5.0)**

---

## ğŸ“š å‚è€ƒæ–‡çŒ®

1. Kilmer, M. E., & Martin, C. D. (2011). Factorization strategies for third-order tensors. Linear Algebra and Its Applications.
2. Chen, J., et al. (2019). T-Sketch: A novel sketching approach for tensor decomposition.
3. Martin, C. D., et al. (2013). Third-order tensors as operators on matrices: A theoretical and computational framework.
4. Cheng, Z., Yu, G., Cai, X., & Qi, L. (2024). An Efficient Two-Sided Sketching Method for Large-Scale Tensor Decomposition Based on Transformed Domains. arXiv:2404.16580.

---

## ğŸ“ åˆ†æç¬”è®°

```
ä¸ªäººç†è§£:

1. è¿™ç¯‡è®ºæ–‡çš„æ ¸å¿ƒè´¡çŒ®æ˜¯å»ºç«‹äº†â‹†_L-ç§¯çš„ç»Ÿä¸€æ¡†æ¶ï¼Œ
   è¿™å…è®¸æˆ‘ä»¬åœ¨ä¸åŒå˜æ¢åŸŸ(DCT, DFT, DWT)ä¸‹è¿›è¡Œå¼ é‡è¿ç®—ã€‚

2. åŒè¾¹è‰ç¨¿+æ ¸å¿ƒè‰ç¨¿çš„è®¾è®¡å¾ˆå·§å¦™ï¼š
   - åŒè¾¹è‰ç¨¿æ•è·å·¦å³å¥‡å¼‚å‘é‡ä¿¡æ¯
   - æ ¸å¿ƒè‰ç¨¿æé«˜ä¸­é—´æ ¸å¿ƒå¼ é‡çš„è¿‘ä¼¼ç²¾åº¦
   - ç†è®ºä¸Šæä¾›äº†æ›´ç´§çš„è¯¯å·®ç•Œ

3. DCTæ›¿ä»£DFTæ˜¯ä¸€ä¸ªå®ç”¨ä¼˜åŒ–ï¼š
   - é¿å…å¤æ•°è¿ç®—
   - æ›´å¥½çš„èƒ½é‡é›†ä¸­(å¯¹å®æ•°æ•°æ®)
   - ç›¸åŒçš„å¿«é€Ÿç®—æ³•å¤æ‚åº¦

4. ä¸å‰ä½œ(Practical Sketching for Tucker)çš„è”ç³»ï¼š
   - æœ¬æ–‡ä¸“æ³¨äºt-SVDåˆ†è§£
   - å‰ä½œä¸“æ³¨äºTuckeråˆ†è§£
   - ä¸¤è€…éƒ½ä½¿ç”¨è‰ç¨¿æ€æƒ³ï¼Œä½†åº”ç”¨åœºæ™¯ä¸åŒ

5. å®ç°ä¸Šçš„æŒ‘æˆ˜ï¼š
   - t-productçš„æ­£ç¡®å®ç°éœ€è¦ä»”ç»†
   - ä¸åŒå˜æ¢çš„å®ç°ç»†èŠ‚
   - è‰ç¨¿ç®—å­çš„éšæœºæ€§ç®¡ç†

6. åº”ç”¨å‰æ™¯ï¼š
   - è§†é¢‘å‹ç¼©å’Œå¤„ç†
   - é«˜å…‰è°±å›¾åƒåˆ†æ
   - æ¨èç³»ç»Ÿ
```

---

*æœ¬ç¬”è®°ç”±5-Agentè¾©è®ºåˆ†æç³»ç»Ÿç”Ÿæˆï¼Œç»“åˆåŸæ–‡PDFå’Œå¤šæ™ºèƒ½ä½“ç²¾è¯»æŠ¥å‘Šè¿›è¡Œæ·±å…¥åˆ†æã€‚*
