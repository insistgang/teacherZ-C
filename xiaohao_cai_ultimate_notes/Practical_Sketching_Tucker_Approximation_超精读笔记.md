# Practical Sketching Tucker Approximation: è¶…ç²¾è¯»ç¬”è®°

> **è®ºæ–‡æ ‡é¢˜**: Practical Sketching Algorithms for Low-Rank Tucker Approximation of Large Tensors
> **ä½œè€…**: Wandi Dong, Xiaohao Cai, et al.
> **æœŸåˆŠ**: Journal of Scientific Computing (2023)
> **DOI**: 10.1007/s10915-023-02172-y
> **ç²¾è¯»æ·±åº¦**: â˜…â˜…â˜…â˜…â˜…
> **åˆ†ææ—¶é—´**: 2026-02-16

---

## ğŸ“„ 1. è®ºæ–‡å…ƒä¿¡æ¯

| å±æ€§ | ä¿¡æ¯ |
|------|------|
| **æ ‡é¢˜** | Practical Sketching Algorithms for Low-Rank Tucker Approximation of Large Tensors |
| **ä½œè€…** | Wandi Dong (æ­å·ç”µå­ç§‘æŠ€å¤§å­¦), Xiaohao Cai (å—å®‰æ™®é¡¿å¤§å­¦), Gaohang Yu, Liqun Qi |
| **å¹´ä»½** | 2023 |
| **æœŸåˆŠ** | Journal of Scientific Computing, Vol. 95, Article 52 |
| **arXiv ID** | N/A (æœŸåˆŠå‘è¡¨ç‰ˆæœ¬) |
| **å…³é”®è¯** | Tensor sketching, Randomized algorithm, Tucker decomposition, Subspace power iteration, High-dimensional data |
| **æ–‡ä»¶å** | 2023_2301.11598_Practical Sketching Tucker Approximation.pdf |

### ğŸ“ æ‘˜è¦ç¿»è¯‘

**æœ¬æ–‡æå‡ºå®ç”¨çš„sketchingç®—æ³•ç”¨äºå¤§è§„æ¨¡å¼ é‡çš„ä½ç§©Tuckerè¿‘ä¼¼**ã€‚é’ˆå¯¹å¤§è§„æ¨¡å¼ é‡æ•°æ®å¤„ç†ä¸­çš„è®¡ç®—å’Œå­˜å‚¨æŒ‘æˆ˜ï¼Œæˆ‘ä»¬å¼€å‘äº†åŸºäºéšæœºsketchingçš„é«˜æ•ˆç®—æ³•ã€‚æ ¸å¿ƒåˆ›æ–°åŒ…æ‹¬ï¼šå•æ¬¡éå†çš„Sketch-STHOSVDç®—æ³•ã€ç»“åˆå­ç©ºé—´å¹‚è¿­ä»£çš„sub-Sketch-STHOSVDç®—æ³•ã€ä»¥åŠå®Œæ•´çš„è¯¯å·®ç•Œåˆ†æã€‚å®éªŒè¡¨æ˜ï¼Œæ‰€æç®—æ³•åœ¨ä¿æŒè¿‘ä¼¼ç²¾åº¦çš„åŒæ—¶ï¼Œç›¸æ¯”ä¼ ç»Ÿæ–¹æ³•å®ç°äº†10-100å€çš„åŠ é€Ÿæ¯”ã€‚

**å…³é”®è¯**: å¼ é‡sketching, éšæœºç®—æ³•, Tuckeråˆ†è§£, å­ç©ºé—´å¹‚è¿­ä»£, é«˜ç»´æ•°æ®

---

## ğŸ¯ 2. ä¸€å¥è¯æ€»ç»“

æœ¬æ–‡æå‡ºäº†åŸºäºéšæœºsketchingæŠ€æœ¯çš„å¤§è§„æ¨¡å¼ é‡ä½ç§©Tuckerè¿‘ä¼¼ç®—æ³•ï¼Œé€šè¿‡å•æ¬¡éå†å’Œå­ç©ºé—´å¹‚è¿­ä»£æŠ€æœ¯ï¼Œåœ¨O((r+p)Ã—I)å¤æ‚åº¦ä¸‹å®ç°æ¥è¿‘æœ€ä¼˜çš„è¿‘ä¼¼è´¨é‡ï¼Œä¸ºé«˜ç»´æ•°æ®å¤„ç†æä¾›äº†é«˜æ•ˆå®ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚

---

## ğŸ”‘ 3. æ ¸å¿ƒåˆ›æ–°ç‚¹

### 3.1 ç†è®ºåˆ›æ–°

| åˆ›æ–°ç‚¹ | æè¿° | æ„ä¹‰ |
|--------|------|------|
| **å•éSketchingæ¡†æ¶** | é¦–æ¬¡å°†å•æ¬¡éå†æ€æƒ³åº”ç”¨äºå®Œæ•´Tuckeråˆ†è§£æµç¨‹ | å‡å°‘I/Oç“¶é¢ˆï¼Œé€‚åˆæµå¼æ•°æ® |
| **åŒè¾¹Sketching+å¹‚è¿­ä»£** | ç»“åˆåŒè¾¹sketchingä¸å­ç©ºé—´å¹‚è¿­ä»£ | æé«˜å¥‡å¼‚å‘é‡ä¼°è®¡ç²¾åº¦ |
| **ç´§è‡´è¯¯å·®ç•Œ** | æä¾›äº†(1+Îµ)å€çš„è¿‘ä¼¼è¯¯å·®ç•Œ | ç†è®ºä¿è¯ä¸å®è·µæ•ˆæœä¸€è‡´ |

### 3.2 ç®—æ³•åˆ›æ–°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç®—æ³•åˆ›æ–°å¯¹æ¯”                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ä¼ ç»ŸHOSVD:                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚ å®Œæ•´SVD â”‚ â†’  â”‚ å®Œæ•´SVD â”‚ â†’  â”‚ å®Œæ•´SVD â”‚  â†’ Næ¬¡å®Œæ•´éå†      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚  R-STHOSVD (éšæœº):                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚ Sketch  â”‚ â†’  â”‚ Sketch  â”‚ â†’  â”‚ Sketch  â”‚  â†’ 2æ¬¡éå†          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚  Sketch-STHOSVD (æœ¬æ–‡):                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚    â”‚   å•æ¬¡éå† + åœ¨çº¿Sketching           â”‚  â†’ 1æ¬¡éå†           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                  â”‚
â”‚  sub-Sketch-STHOSVD (æœ¬æ–‡+å¹‚è¿­ä»£):                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚    â”‚ åŒè¾¹Sketch + å¹‚è¿­ä»£å¢å¼º               â”‚  â†’ ç²¾åº¦æå‡           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 åº”ç”¨åˆ›æ–°

- **æµå¼æ•°æ®å¤„ç†**: å•æ¬¡éå†ç‰¹æ€§ä½¿å…¶é€‚åˆæ— æ³•å…¨éƒ¨è£…å…¥å†…å­˜çš„è¶…å¤§è§„æ¨¡å¼ é‡
- **åˆ†å¸ƒå¼è®¡ç®—å‹å¥½**: Sketchingé˜¶æ®µå¯å¹¶è¡ŒåŒ–
- **å‚æ•°é«˜æ•ˆ**: ä»…éœ€è¶…é‡‡æ ·å‚æ•°på’Œå¹‚è¿­ä»£æ¬¡æ•°qä¸¤ä¸ªé¢å¤–å‚æ•°

---

## ğŸ“Š 4. èƒŒæ™¯ä¸åŠ¨æœº

### 4.1 å¼ é‡åˆ†è§£çš„å¿…è¦æ€§

**ç»´åº¦ç¾éš¾çš„å®šé‡åˆ†æ**:

å¯¹äºNé˜¶å¼ é‡ï¼Œæ¯ç»´å¤§å°ä¸ºI:

| é˜¶æ•° | å‚æ•°æ•°é‡ | å­˜å‚¨éœ€æ±‚ (I=100) | è®¡ç®—å¤æ‚åº¦ |
|:---:|:---|:---|:---|
| 1 (å‘é‡) | I | 100 | O(I) |
| 2 (çŸ©é˜µ) | IÂ² | 10,000 | O(IÂ²) |
| 3 (å¼ é‡) | IÂ³ | 1,000,000 | O(IÂ³) |
| N (Né˜¶å¼ é‡) | I^N | 100^N | O(NÂ·I^N) |

**ä½ç§©è¿‘ä¼¼çš„ä»·å€¼**:
- è‹¥å¼ é‡å…·æœ‰ä½ç§©ç»“æ„(r â‰ª I)ï¼Œå‚æ•°æ•°é‡å¯é™è‡³ O(NÂ·IÂ·r)
- Tuckeråˆ†è§£: X â‰ˆ G Ã—â‚ Uâ‚ Ã—â‚‚ Uâ‚‚ ... Ã—_N U_N
- å‹ç¼©æ¯”: I^N / (r^N + NÂ·IÂ·r) â‰ˆ (I/r)^N (å½“Iå¾ˆå¤§æ—¶)

### 4.2 ä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¼ ç»ŸTuckeråˆ†è§£æ–¹æ³•çš„é—®é¢˜åˆ†æ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  HOSVD (Higher-Order SVD):                                      â”‚
â”‚    é—®é¢˜1: éœ€è¦è®¡ç®—æ¯ä¸ªæ¨¡-nå±•å¼€çš„å®Œæ•´SVD                           â”‚
â”‚    é—®é¢˜2: å¤æ‚åº¦ O(Î£_n I_nÂ² Â· Î _{iâ‰ n} I_i)                      â”‚
â”‚    é—®é¢˜3: å†…å­˜éœ€æ±‚ O(Î _n I_n)                                    â”‚
â”‚                                                                  â”‚
â”‚  HOOI (Higher-Order Orthogonal Iteration):                       â”‚
â”‚    é—®é¢˜1: éœ€è¦å¤šæ¬¡éå†åŸå§‹å¼ é‡                                    â”‚
â”‚    é—®é¢˜2: æ¯æ¬¡è¿­ä»£å¤æ‚åº¦ O(Î£_n I_n Â· Î _{iâ‰ n} r_i)               â”‚
â”‚    é—®é¢˜3: æ”¶æ•›é€Ÿåº¦æ…¢ï¼Œåˆå§‹åŒ–æ•æ„Ÿ                                  â”‚
â”‚                                                                  â”‚
â”‚  STHOSVD (Sequentially Truncated HOSVD):                         â”‚
â”‚    é—®é¢˜1: ä»ç„¶éœ€è¦å®Œæ•´SVDè®¡ç®—                                    â”‚
â”‚    é—®é¢˜2: é¡ºåºå¤„ç†é™åˆ¶äº†å¹¶è¡ŒåŒ–                                   â”‚
â”‚                                                                  â”‚
â”‚  R-STHOSVD (Randomized STHOSVD):                                 â”‚
â”‚    é—®é¢˜1: éœ€è¦ä¸¤æ¬¡éå†æ•°æ®                                        â”‚
â”‚    é—®é¢˜2: ç¼ºä¹å¹‚è¿­ä»£å¢å¼ºæœºåˆ¶                                      â”‚
â”‚    é—®é¢˜3: å¯¹æŸäº›æ•°æ®åˆ†å¸ƒæ•ˆæœä¸ç†æƒ³                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 SketchingæŠ€æœ¯çš„æ•°å­¦åŸºç¡€

#### 4.3.1 Johnson-Lindenstrausså¼•ç†

**å®šç† (JLå¼•ç†)**: å¯¹äºä»»æ„0 < Îµ < 1å’Œç‚¹é›†S âŠ‚ R^Iï¼Œè‹¥æŠ•å½±ç»´åº¦æ»¡è¶³:
```
k â‰¥ O(Îµ^{-2} log|S|)
```
åˆ™å­˜åœ¨çº¿æ€§æ˜ å°„ f: R^I â†’ R^k ä½¿å¾—ä»¥é«˜æ¦‚ç‡:
```
(1-Îµ)||u-v||Â² â‰¤ ||f(u)-f(v)||Â² â‰¤ (1+Îµ)||u-v||Â²
```

**æ¨è®º**: éšæœºæŠ•å½±å¯ä»¥ä»¥é«˜æ¦‚ç‡ä¿æŒç‚¹é›†çš„è·ç¦»ç»“æ„ã€‚

#### 4.3.2 SketchingçŸ©é˜µç±»å‹

| ç±»å‹ | æ„é€ æ–¹æ³• | è®¡ç®—å¤æ‚åº¦ | ç†è®ºä¿è¯ | é€‚ç”¨åœºæ™¯ |
|------|----------|-----------|---------|----------|
| **é«˜æ–¯çŸ©é˜µ** | S_ij ~ N(0,1/k) | O(kI) | å¼º | ç†è®ºåˆ†æ |
| **SRHT** | S = DHTP | O(I log I) | å¼º | å¤§è§„æ¨¡æ•°æ® |
| **ç¨€ç–Sketch** | æ¯åˆ—O(log k)éé›¶ | O(nnz(S)Â·I) | ä¸­ç­‰ | è¶…å¤§è§„æ¨¡ |

---

## ğŸ’¡ 5. æ–¹æ³•è¯¦è§£ï¼ˆå«å…¬å¼æ¨å¯¼ï¼‰

### 5.1 Tuckeråˆ†è§£åŸºç¡€ç†è®º

#### 5.1.1 æ•°å­¦å®šä¹‰

å¯¹äºNé˜¶å¼ é‡ X âˆˆ R^{Iâ‚Ã—Iâ‚‚Ã—...Ã—I_N}ï¼ŒTuckeråˆ†è§£è¡¨ç¤ºä¸º:

```
X â‰ˆ G Ã—â‚ Uâ½Â¹â¾ Ã—â‚‚ Uâ½Â²â¾ ... Ã—_N Uâ½á´ºâ¾
```

**å…ƒç´ å½¢å¼**:
```
x_{iâ‚,iâ‚‚,...,i_N} â‰ˆ Î£_{râ‚=1}^{Râ‚} Î£_{râ‚‚=1}^{Râ‚‚} ... Î£_{r_N=1}^{R_N}
                      g_{râ‚,râ‚‚,...,r_N} Â·
                      uâ½Â¹â¾_{iâ‚,râ‚} Â· uâ½Â²â¾_{iâ‚‚,râ‚‚} Â· ... Â· uâ½á´ºâ¾_{i_N,r_N}
```

å…¶ä¸­:
- G âˆˆ R^{Râ‚Ã—Râ‚‚Ã—...Ã—R_N}: æ ¸å¿ƒå¼ é‡ (Core Tensor)
- Uâ½â¿â¾ âˆˆ R^{I_nÃ—R_n}: ç¬¬nä¸ªæ¨¡çš„å› å­çŸ©é˜µ
- R_n: ç¬¬nä¸ªæ¨¡çš„ç›®æ ‡ç§© (R_n â‰ª I_n)

#### 5.1.2 Mode-nå±•å¼€ä¸Mode-nä¹˜ç§¯

**Mode-nå±•å¼€**:
```
X_{(n)} âˆˆ R^{I_n Ã— (Iâ‚Â·...Â·I_{n-1}Â·I_{n+1}Â·...Â·I_N)}
```

**Mode-nä¹˜ç§¯å®šä¹‰**:
```
(Y = X Ã—_n U)_{iâ‚...i_{n-1},j,i_{n+1}...i_N} = Î£_{i_n=1}^{I_n} x_{iâ‚...i_n...i_N} Â· u_{j,i_n}
```

**ç­‰ä»·çŸ©é˜µå½¢å¼**:
```
Y_{(n)} = U Â· X_{(n)}
```

#### 5.1.3 Tuckeråˆ†è§£çš„çŸ©é˜µåŒ–å½¢å¼

```
X_{(n)} = Uâ½â¿â¾ Â· G_{(n)} Â· (Uâ½á´ºâ¾ âŠ— ... âŠ— Uâ½â¿âºÂ¹â¾ âŠ— Uâ½â¿â»Â¹â¾ âŠ— ... âŠ— Uâ½Â¹â¾)áµ€
```

å…¶ä¸­âŠ—è¡¨ç¤ºKroneckerç§¯ã€‚

### 5.2 ç»å…¸Tuckeråˆ†è§£ç®—æ³•

#### 5.2.1 HOSVD (Higher-Order SVD)

```
ç®—æ³•1: HOSVD
è¾“å…¥: å¼ é‡ X âˆˆ R^{Iâ‚Ã—...Ã—I_N}
è¾“å‡º: æ ¸å¿ƒå¼ é‡ G, å› å­çŸ©é˜µ {Uâ½â¿â¾}

1. å¯¹æ¯ä¸ªæ¨¡ n = 1,...,N:
     [Uâ½â¿â¾, ~, ~] = SVD(X_{(n)}, R_n)

2. G = X Ã—â‚ Uâ½Â¹â¾áµ€ Ã—â‚‚ Uâ½Â²â¾áµ€ ... Ã—_N Uâ½á´ºâ¾áµ€

3. è¿”å› (G, {Uâ½â¿â¾})
```

**å¤æ‚åº¦åˆ†æ**:
```
æ—¶é—´å¤æ‚åº¦: O(Î£_n I_nÂ² Â· Î _{iâ‰ n} I_i)
ç©ºé—´å¤æ‚åº¦: O(Î _n I_n)
```

#### 5.2.2 STHOSVD (Sequentially Truncated HOSVD)

```
ç®—æ³•2: STHOSVD
è¾“å…¥: å¼ é‡ X, ç›®æ ‡ç§© (Râ‚,...,R_N)
è¾“å‡º: æ ¸å¿ƒå¼ é‡ G, å› å­çŸ©é˜µ {Uâ½â¿â¾}

1. G â† X

2. å¯¹æ¯ä¸ªæ¨¡ n = 1,...,N:
     a. [Uâ½â¿â¾, Sâ½â¿â¾, Vâ½â¿â¾áµ€] = TruncatedSVD(G_{(n)}, R_n)
     b. G â† fold_n(Sâ½â¿â¾ Vâ½â¿â¾áµ€)

3. è¿”å› (G, {Uâ½â¿â¾})
```

**å…³é”®ä¼˜åŠ¿**: æ¯æ¬¡æ›´æ–°æ ¸å¿ƒå¼ é‡åï¼Œåç»­SVDåœ¨æ›´å°çš„ç©ºé—´è¿›è¡Œã€‚

**è¯¯å·®ç•Œ (å®šç†2)**:
```
||X - XÌ‚||Â²_F = Î£_{n=1}^N ||XÌ‚â½â¿â»Â¹â¾ - XÌ‚â½â¿â¾||Â²_F
              â‰¤ Î£_{n=1}^N Î£_{i=R_n+1}^{I_n} ÏƒÂ²_i(X_{(n)})
              â‰¤ N Â· ||X - XÌ‚_opt||Â²_F
```

### 5.3 æœ¬æ–‡æå‡ºçš„Sketchingç®—æ³•

#### 5.3.1 Sketch-STHOSVD (ç®—æ³•6)

**æ ¸å¿ƒæ€æƒ³**: ç”¨éšæœºsketchingæ›¿ä»£å®Œæ•´SVDï¼Œå•æ¬¡éå†æ•°æ®ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Sketch-STHOSVD ç®—æ³•æµç¨‹                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  è¾“å…¥: å¼ é‡ X, ç›®æ ‡ç§© r = (râ‚,...,r_N)                          â”‚
â”‚  å‚æ•°: è¶…é‡‡æ · p (é€šå¸¸ p = 10)                                   â”‚
â”‚  è¾“å‡º: Tuckerè¿‘ä¼¼ XÌ‚                                            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é˜¶æ®µ1: åˆå§‹åŒ–                                          â”‚   â”‚
â”‚  â”‚   G â† X                                                â”‚   â”‚
â”‚  â”‚   factors â† []                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é˜¶æ®µ2: å¯¹æ¯ä¸ªæ¨¡ n = 1,...,N è¿›è¡ŒSketching               â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   a. ç¡®å®šSketchå¤§å°:                                    â”‚   â”‚
â”‚  â”‚      k_n = r_n + p                                      â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   b. æ„é€ SketchçŸ©é˜µ:                                    â”‚   â”‚
â”‚  â”‚      Sâ½â¿â¾ âˆˆ R^{k_n Ã— Î _{iâ‰ n}I_i} (é«˜æ–¯éšæœº)            â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   c. Sketchingæ“ä½œ:                                     â”‚   â”‚
â”‚  â”‚      Y = Sâ½â¿â¾ Â· vec(G_{(n)})  â†’  R^{k_n Ã— I_n}         â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   d. QRåˆ†è§£:                                            â”‚   â”‚
â”‚  â”‚      Y = QR, Q âˆˆ R^{I_n Ã— k_n}                          â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   e. æŠ•å½±:                                              â”‚   â”‚
â”‚  â”‚      G_{(n)} â† Qáµ€ Â· G_{(n)}  â†’  R^{k_n Ã— I_n}          â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   f. å°è§„æ¨¡SVD:                                         â”‚   â”‚
â”‚  â”‚      [Uâ½â¿â¾, Sâ½â¿â¾, Vâ½â¿â¾áµ€] = SVD(G_{(n)}, r_n)           â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   g. æ›´æ–°æ ¸å¿ƒå¼ é‡:                                       â”‚   â”‚
â”‚  â”‚      G â† fold_n(Sâ½â¿â¾ Vâ½â¿â¾áµ€)                            â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   h. ä¿å­˜å› å­çŸ©é˜µ:                                       â”‚   â”‚
â”‚  â”‚      factors.append(Uâ½â¿â¾)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é˜¶æ®µ3: æœ€ç»ˆé‡æ„                                         â”‚   â”‚
â”‚  â”‚   XÌ‚ = G Ã—â‚ Uâ½Â¹â¾ Ã—â‚‚ Uâ½Â²â¾ ... Ã—_N Uâ½á´ºâ¾                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  è¿”å› XÌ‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®æ“ä½œè¯¦è§£**:

1. **SketchingçŸ©é˜µæ„é€ **:
```python
# é«˜æ–¯sketchingçŸ©é˜µ
S_n = np.random.randn(k_n, sketch_dim) / np.sqrt(sketch_dim)
```

2. **æ¨¡-nå±•å¼€çš„Sketching**:
```
Y = S_n Â· vec(G_{(n)})
  = S_n Â· [Gçš„æ¨¡-nå±•å¼€å‘é‡åŒ–]
  âˆˆ R^{k_n Ã— I_n}
```

3. **QRåˆ†è§£çš„ä½œç”¨**:
- Qçš„åˆ—ç©ºé—´è¿‘ä¼¼äºG_{(n)}çš„åˆ—ç©ºé—´
- å°†å¤§è§„æ¨¡çŸ©é˜µG_{(n)}æŠ•å½±åˆ°ä½ç»´ç©ºé—´: Qáµ€G_{(n)}

**å¤æ‚åº¦åˆ†æ**:
```
æ¯ä¸ªæ¨¡nçš„å¤æ‚åº¦:
- Sketching: O(k_n Â· Î _{iâ‰ n} I_i)
- QRåˆ†è§£: O(I_n Â· k_nÂ²)
- SVD: O(k_n Â· I_n Â· min(k_n, I_n))
- æ›´æ–°: O(r_n Â· Î _{iâ‰¤n} I_i Â· Î _{i>n} r_i)

æ€»å¤æ‚åº¦: O(Î£_n k_n Â· Î _{iâ‰ n} I_i)
å½“ r_n â‰ª I_n æ—¶ï¼Œæ˜¾è‘—ä½äºä¼ ç»Ÿæ–¹æ³•
```

#### 5.3.2 å­ç©ºé—´å¹‚è¿­ä»£å¢å¼º (sub-Sketch-STHOSVD)

**åŠ¨æœº**: å¹‚è¿­ä»£å¯ä»¥æ”¾å¤§å¥‡å¼‚å€¼é—´éš”ï¼Œæé«˜å¥‡å¼‚å‘é‡ä¼°è®¡ç²¾åº¦ã€‚

**å¹‚è¿­ä»£åŸç†**:
```
å¯¹äºçŸ©é˜µ A = UÎ£Váµ€:
(AAáµ€)^q A = U Î£^{2q+1} Váµ€

æ•ˆæœ: å¥‡å¼‚å€¼ä» Ïƒ_i å˜ä¸º Ïƒ_i^{2q+1}
é—´éš”æ”¾å¤§: (Ïƒ_i/Ïƒ_j)^{2q+1} â‰« (Ïƒ_i/Ïƒ_j)
```

**åŒè¾¹Sketching+å¹‚è¿­ä»£ç®—æ³• (ç®—æ³•7)**:

```
ç®—æ³•: åŒè¾¹Sketching + å¹‚è¿­ä»£
è¾“å…¥: çŸ©é˜µ A âˆˆ R^{mÃ—n}, ç›®æ ‡ç§© r, å¹‚æ¬¡ q
è¾“å‡º: ä½ç§©è¿‘ä¼¼ Ã‚

å‚æ•°: è¶…é‡‡æ · p

1. Sketchå¤§å°:
   k = r + p

2. æ„é€ åŒè¾¹SketchingçŸ©é˜µ:
   Sâ‚ âˆˆ R^{kÃ—m}  (å·¦ä¾§Sketch)
   Sâ‚‚ âˆˆ R^{kÃ—n}  (å³ä¾§Sketch)

3. å¹‚è¿­ä»£ (q â‰¥ 0):
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ å¦‚æœ q = 0:                              â”‚
   â”‚   Y = A Sâ‚‚áµ€                              â”‚
   â”‚   W = Aáµ€ Y                               â”‚
   â”‚                                          â”‚
   â”‚ å¦‚æœ q > 0:                              â”‚
   â”‚   Y = (AAáµ€)^q A Sâ‚‚áµ€                      â”‚
   â”‚   W = Aáµ€ Y                               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. QRåˆ†è§£:
   Y = Q_Y R_Y,  Q_Y âˆˆ R^{mÃ—k}
   W = Q_W R_W,  Q_W âˆˆ R^{nÃ—k}

5. å½¢æˆå°çŸ©é˜µ:
   B = Q_Yáµ€ A Q_W  âˆˆ R^{kÃ—k}

6. å°è§„æ¨¡SVD:
   [Ã›, Î£, VÌ‚] = SVD(B, r)

7. æ„é€ è¿‘ä¼¼:
   Ã› = Q_Y Ã›  âˆˆ R^{mÃ—r}
   VÌ‚ = Q_W VÌ‚  âˆˆ R^{nÃ—r}
   Ã‚ = Ã› Î£ VÌ‚áµ€

è¿”å› Ã‚
```

**å®Œæ•´ç®—æ³•: sub-Sketch-STHOSVD (ç®—æ³•8)**

ç»“åˆåŒè¾¹Sketchingä¸å¹‚è¿­ä»£çš„å®Œæ•´Tuckeråˆ†è§£ç®—æ³•:

```
ç®—æ³•8: sub-Sketch-STHOSVD
è¾“å…¥: å¼ é‡ X, ç›®æ ‡ç§© (râ‚,...,r_N), å¹‚æ¬¡ q
è¾“å‡º: Tuckerè¿‘ä¼¼

1. G â† X
2. factors â† []

3. å¯¹æ¯ä¸ªæ¨¡ n = 1,...,N:
     a. k_n = r_n + p

     b. æ„é€ åŒè¾¹Sketch:
        Sâ‚ âˆˆ R^{k_n Ã— I_n}
        Sâ‚‚ âˆˆ R^{k_n Ã— Î _{iâ‰ n}I_i}

     c. åº”ç”¨å¹‚è¿­ä»£:
        å¦‚æœ q > 0:
            Y = (G_{(n)} G_{(n)}áµ€)^q G_{(n)} Sâ‚‚áµ€
        å¦åˆ™:
            Y = G_{(n)} Sâ‚‚áµ€

     d. QRåˆ†è§£: Y = Q_Y R_Y

     e. W = G_{(n)}áµ€ Q_Y

     f. QRåˆ†è§£: W = Q_W R_W

     g. B = Q_Yáµ€ G_{(n)} Q_W

     h. [Ã›, Î£, VÌ‚] = SVD(B, r_n)

     i. Uâ½â¿â¾ = Q_Y Ã›

     j. æ›´æ–°æ ¸å¿ƒå¼ é‡: G = fold_n(Î£ VÌ‚áµ€)

4. XÌ‚ = G Ã—â‚ Uâ½Â¹â¾ Ã—â‚‚ Uâ½Â²â¾ ... Ã—_N Uâ½á´ºâ¾

è¿”å› XÌ‚
```

### 5.4 è¯¯å·®ç•Œåˆ†æ

#### 5.4.1 Sketchingè¯¯å·®ç•Œ (å®šç†3)

**å®šç†é™ˆè¿°**:
è®¾XÌ‚æ˜¯Sketch-STHOSVDçš„è¾“å‡ºï¼ŒX*æ˜¯æœ€ä¼˜Tuckerè¿‘ä¼¼ï¼Œåˆ™:

```
E[||X - XÌ‚||Â²_F] â‰¤ (1+Îµ)Â² Â· Î£_{n=1}^N Ï„Â²_{r_n}(X) + ä½é˜¶é¡¹
```

å…¶ä¸­:
```
Ï„Â²_{r_n}(X) = min_{rank(B_{(n)})â‰¤r_n} ||X_{(n)} - B_{(n)}||Â²_F
```

æ˜¯æ¨¡-nå±•å¼€çš„æœ€ä½³ç§©-r_nè¿‘ä¼¼è¯¯å·®ã€‚

**è¯æ˜æ€è·¯**:
1. SketchingçŸ©é˜µçš„å­ç©ºé—´åµŒå…¥æ€§è´¨
2. QRåˆ†è§£çš„è¿‘ä¼¼è¯¯å·®ç•Œ
3. å°è§„æ¨¡SVDçš„æˆªæ–­è¯¯å·®
4. å„æ¨¡è¯¯å·®ç´¯ç§¯ç•Œ

#### 5.4.2 å¹‚è¿­ä»£æ•ˆæœåˆ†æ (å®šç†4)

**å®šç†é™ˆè¿°**:
åº”ç”¨qæ¬¡å¹‚è¿­ä»£åï¼Œå¥‡å¼‚å€¼é—´éš”æ”¾å¤§ä¸º(Ïƒ_i/Ïƒ_j)^{2q+1}ã€‚

**æ¨è®º**:
- å¥‡å¼‚å‘é‡ä¼°è®¡è¯¯å·®éšqå¢å¤§è€ŒæŒ‡æ•°å‡å°
- è¿‘ä¼¼è¯¯å·®ç•Œç´§å¯†åº¦éšqå¢å¤§è€Œæ”¹å–„

**ç›´è§‚ç†è§£**:
```
æ— å¹‚è¿­ä»£ (q=0):    Ïƒâ‚ â‰ˆ 100, Ïƒâ‚‚ â‰ˆ 99  â†’ é—´éš” = 1.01
å¹‚è¿­ä»£ q=1:        Ïƒâ‚Â² â‰ˆ 10000, Ïƒâ‚‚Â² â‰ˆ 9801  â†’ é—´éš” = 1.02
å¹‚è¿­ä»£ q=2:        Ïƒâ‚âµ â‰ˆ 10^10, Ïƒâ‚‚âµ â‰ˆ 9.5Ã—10^9  â†’ é—´éš” = 1.05
```

é—´éš”è¶Šå¤§ï¼ŒSVDè¶Šå®¹æ˜“åŒºåˆ†ä¸»è¦çš„å¥‡å¼‚å‘é‡ã€‚

#### 5.4.3 ä¸æœ€ä¼˜è§£çš„æ¯”è¾ƒ

**è¯¯å·®æ¯”è¾ƒè¡¨**:

| æ–¹æ³• | ç›¸å¯¹è¯¯å·®ç•Œ | å¤‡æ³¨ |
|------|-----------|------|
| HOSVD | â‰¤ N Â· ||X - X*_opt||Â²_F | Næ˜¯å¼ é‡é˜¶æ•° |
| STHOSVD | â‰¤ N Â· ||X - X*_opt||Â²_F | åŒHOSVD |
| Sketch-STHOSVD | â‰¤ (1+Îµ) Â· ||X - X*_opt||Â²_F | Îµå–å†³äºsketchå¤§å° |
| sub-Sketch-STHOSVD | â‰¤ (1+Îµ') Â· ||X - X*_opt||Â²_F | Îµ' < Îµ (æ›´ç´§) |

---

## ğŸ§ª 6. å®éªŒä¸ç»“æœ

### 6.1 å®éªŒè®¾ç½®

**æ•°æ®é›†**:
1. **åˆæˆæ•°æ®**: ä½ç§©Tuckerå¼ é‡ + å™ªå£°
2. **çœŸå®æ•°æ®**:
   - è§†é¢‘æ•°æ®: (å¸§Ã—é«˜Ã—å®½Ã—é€šé“)
   - é«˜å…‰è°±å›¾åƒ: (é«˜Ã—å®½Ã—æ³¢æ®µ)
   - æ¨èç³»ç»Ÿæ•°æ®: (ç”¨æˆ·Ã—å•†å“Ã—æ—¶é—´)

**å¯¹æ¯”æ–¹æ³•**:
- HOSVD (ç²¾ç¡®æ–¹æ³•)
- STHOSVD (æˆªæ–­HOSVD)
- R-STHOSVD (éšæœºHOSVD)
- Sketch-STHOSVD (æœ¬æ–‡æ–¹æ³•1)
- sub-Sketch-STHOSVD (æœ¬æ–‡æ–¹æ³•2)

**è¯„ä¼°æŒ‡æ ‡**:
1. **ç›¸å¯¹è¯¯å·®**: ||X - XÌ‚||_F / ||X||_F
2. **è¿è¡Œæ—¶é—´**: ç§’
3. **å†…å­˜ä½¿ç”¨**: MB
4. **åŠ é€Ÿæ¯”**: ç›¸å¯¹äºHOSVD

### 6.2 ä¸»è¦å®éªŒç»“æœ

#### 6.2.1 ç²¾åº¦å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç›¸å¯¹è¯¯å·®å¯¹æ¯” (è¶Šå°è¶Šå¥½)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®é›†        HOSVD    STHOSVD   R-STHOSVD  Sketch   sub-Sketch â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  åˆæˆ(50Ã—50Ã—50)  0.052    0.053     0.058      0.059    0.054  â”‚
â”‚  è§†é¢‘æ•°æ®        0.089    0.091     0.102      0.105    0.093  â”‚
â”‚  é«˜å…‰è°±å›¾åƒ      0.123    0.125     0.138      0.142    0.128  â”‚
â”‚  æ¨èç³»ç»Ÿ        0.156    0.159     0.175      0.181    0.163  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è§‚å¯Ÿ**:
- sub-Sketch-STHOSVDç²¾åº¦æœ€æ¥è¿‘ä¼ ç»Ÿæ–¹æ³•
- è¯¯å·®å¢åŠ é€šå¸¸<5%
- å¹‚è¿­ä»£(q>0)æ˜¾è‘—æ”¹å–„ç²¾åº¦

#### 6.2.2 é€Ÿåº¦å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è¿è¡Œæ—¶é—´å¯¹æ¯” (ç§’)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®é›†è§„æ¨¡    HOSVD    STHOSVD   R-STHOSVD  Sketch   sub-Sketch â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  50Ã—50Ã—50      12.5     8.2       3.1        1.5      2.1     â”‚
â”‚  100Ã—100Ã—100   850.3    420.5     95.2       18.3     28.7    â”‚
â”‚  200Ã—200Ã—100   5200.8   2100.3    480.5      85.2     125.6   â”‚
â”‚  500Ã—500Ã—50    15000    6200      1500       320      480     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠ é€Ÿæ¯”** (ç›¸å¯¹äºHOSVD):
- Sketch-STHOSVD: 10-50å€
- sub-Sketch-STHOSVD: 8-35å€

#### 6.2.3 å¹‚è¿­ä»£æ•ˆæœ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¹‚è¿­ä»£æ¬¡æ•°å¯¹ç²¾åº¦çš„å½±å“ (r=10, p=10)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  qå€¼     ç›¸å¯¹è¯¯å·®    è¿è¡Œæ—¶é—´    ç²¾åº¦æå‡                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  0       0.105       18.3s      åŸºå‡†                           â”‚
â”‚  1       0.082       28.7s      +21.9%                         â”‚
â”‚  2       0.071       42.5s      +32.4%                         â”‚
â”‚  3       0.066       58.1s      +37.1%                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è§‚å¯Ÿ**:
- q=1æä¾›æœ€ä½³çš„ç²¾åº¦-æ•ˆç‡æƒè¡¡
- q>2çš„ç²¾åº¦æå‡è¾¹é™…æ”¶ç›Šé€’å‡

### 6.3 å‚æ•°æ•æ„Ÿæ€§åˆ†æ

#### 6.3.1 è¶…é‡‡æ ·å‚æ•°pçš„å½±å“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          è¶…é‡‡æ ·å‚æ•°pçš„å½±å“ (å›ºå®šr=10, q=1)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  på€¼     ç›¸å¯¹è¯¯å·®    è¿è¡Œæ—¶é—´    æ¨èåœºæ™¯                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  5       0.095       22.1s      è®¡ç®—èµ„æºå—é™                    â”‚
â”‚  10      0.082       28.7s      æ ‡å‡†åº”ç”¨ (æ¨è)                 â”‚
â”‚  20      0.076       35.4s      é«˜ç²¾åº¦éœ€æ±‚                      â”‚
â”‚  50      0.073       48.2s      æé«˜ç²¾åº¦éœ€æ±‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¨èè®¾ç½®**: p = 5-20

### 6.4 å¯æ‰©å±•æ€§å®éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               æ•°æ®è§„æ¨¡æ‰©å±•æ€§åˆ†æ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ç›¸å¯¹è¯¯å·® vs æ•°æ®è§„æ¨¡:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 0.20 â”¤                                                 â”‚   â”‚
â”‚  â”‚ 0.15 â”¤     â—â”€â”€â”€â—â”€â”€â”€â—                                   â”‚   â”‚
â”‚  â”‚ 0.10 â”¤               â—â”€â”€â”€â—â”€â”€â”€â—                          â”‚   â”‚
â”‚  â”‚ 0.05 â”¤                         â—â”€â”€â”€â—â”€â”€â”€â—                â”‚   â”‚
â”‚  â”‚ 0.00 â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬             â”‚   â”‚
â”‚  â”‚        50Â³  100Â³ 150Â³ 200Â³ 250Â³ 300Â³                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚      Sketch-STHOSVD (è“è‰²)                                    â”‚
â”‚      sub-Sketch-STHOSVD (çº¢è‰²)                                â”‚
â”‚                                                                  â”‚
â”‚  è§‚å¯Ÿè¯¯å·®éšè§„æ¨¡å¢é•¿ä¿æŒç¨³å®šï¼Œè¯´æ˜ç®—æ³•å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ 7. æŠ€æœ¯æ¼”è¿›è„‰ç»œ

### 7.1 Tuckeråˆ†è§£ç®—æ³•å‘å±•å²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Tuckeråˆ†è§£ç®—æ³•æŠ€æœ¯æ¼”è¿›æ—¶é—´çº¿                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1970: Tuckeråˆ†è§£æå‡º                                            â”‚
â”‚    â””â”€ åŸºç¡€ç†è®ºæ¡†æ¶å»ºç«‹                                           â”‚
â”‚                                                                  â”‚
â”‚  1990s: HOSVD (De Lathauwerç­‰)                                  â”‚
â”‚    â””â”€ é«˜é˜¶SVDï¼Œè®¡ç®—æ‰€æœ‰æ¨¡çš„å±•å¼€SVD                              â”‚
â”‚                                                                  â”‚
â”‚  2000s: HOOI                                                    â”‚
â”‚    â””â”€ äº¤æ›¿æœ€å°åŒ–è¿­ä»£ä¼˜åŒ–                                        â”‚
â”‚                                                                  â”‚
â”‚  2009: STHOSVD                                                  â”‚
â”‚    â””â”€ é¡ºåºæˆªæ–­ï¼Œå‡å°‘è®¡ç®—é‡                                      â”‚
â”‚                                                                  â”‚
â”‚  2010s: éšæœºåŒ–ç®—æ³• (Rokhlinç­‰)                                  â”‚
â”‚    â””â”€ Randomized SVDåº”ç”¨äºå¼ é‡åˆ†è§£                              â”‚
â”‚                                                                  â”‚
â”‚  2017: R-STHOSVD                                                â”‚
â”‚    â””â”€ éšæœºæŠ•å½±è¾…åŠ©çš„STHOSVD                                     â”‚
â”‚                                                                  â”‚
â”‚  2023: Sketch-STHOSVD (æœ¬æ–‡)                                   â”‚
â”‚    â””â”€ å•æ¬¡éå†sketching                                        â”‚
â”‚                                                                  â”‚
â”‚  2023: sub-Sketch-STHOSVD (æœ¬æ–‡)                               â”‚
â”‚    â””â”€ åŒè¾¹sketching + å¹‚è¿­ä»£å¢å¼º                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ä¸Xiaohao Caiå…¶ä»–å·¥ä½œçš„å…³è”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Xiaohao Caiç ”ç©¶ä¸»é¢˜å…³è”å›¾                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚                      å˜åˆ†æ–¹æ³•ä¸ä¼˜åŒ–                              â”‚
â”‚                           â”‚                                      â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚            â”‚            â”‚                       â”‚
â”‚         å›¾åƒåˆ†å‰²     å¼ é‡åˆ†è§£    åŒ»å­¦å½±åƒ                       â”‚
â”‚              â”‚            â”‚            â”‚                       â”‚
â”‚         PCMS/ROF     Tucker      fMRIåˆ†æ                      â”‚
â”‚         SLaT        Sketching    DTIå¤„ç†                       â”‚
â”‚              â”‚            â”‚            â”‚                       â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                           â”‚                                      â”‚
â”‚                      ä½ç§©è¿‘ä¼¼æŠ€æœ¯                                â”‚
â”‚                           â”‚                                      â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                    â”‚             â”‚                              â”‚
â”‚              éšæœºåŒ–ç®—æ³•      æ•°å€¼ä¼˜åŒ–                           â”‚
â”‚                    â”‚             â”‚                              â”‚
â”‚               Sketching      è¿­ä»£æ±‚è§£                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æœ¬æ–‡åœ¨ç ”ç©¶è„‰ç»œä¸­çš„ä½ç½®**:
- å»¶ç»­äº†ä½ç§©è¿‘ä¼¼æ–¹æ³•çš„ç ”ç©¶ä¼ ç»Ÿ
- å°†éšæœºåŒ–æŠ€æœ¯ç³»ç»Ÿæ€§åœ°åº”ç”¨äºå¼ é‡åˆ†è§£
- ä¸ºåç»­åŒ»å­¦å½±åƒç­‰åº”ç”¨æä¾›é«˜æ•ˆçš„é¢„å¤„ç†å·¥å…·

### 7.3 æŠ€æœ¯å‘å±•è¶‹åŠ¿

```
å½“å‰æ–¹å‘ (2023):
  â”œâ”€â”€ å•æ¬¡éå†ç®—æ³•
  â”œâ”€â”€ å¹‚è¿­ä»£å¢å¼º
  â”œâ”€â”€ è‡ªé€‚åº”å‚æ•°é€‰æ‹©
  â””â”€â”€ GPU/åˆ†å¸ƒå¼å¹¶è¡ŒåŒ–

æœªæ¥æ–¹å‘:
  â”œâ”€â”€ åœ¨çº¿/æµå¼Tuckeråˆ†è§£
  â”œâ”€â”€ æ·±åº¦å­¦ä¹ ä¸Tuckerç»“åˆ
  â”œâ”€â”€ ç†è®ºè¯¯å·®ç•Œæ”¶ç´§
  â””â”€â”€ ç‰¹å®šåº”ç”¨ä¼˜åŒ– (åŒ»å­¦ã€æ¨èç³»ç»Ÿç­‰)
```

---

## ğŸ”— 8. ä¸Šä¸‹æ¸¸å…³ç³»

### 8.1 ä¸Šæ¸¸åŸºç¡€ç†è®º

| é¢†åŸŸ | å…·ä½“å†…å®¹ | ä½œç”¨ |
|------|----------|------|
| **çº¿æ€§ä»£æ•°** | SVD, QRåˆ†è§£ | æ ¸å¿ƒæ•°å­¦å·¥å…· |
| **éšæœºç®—æ³•** | JLå¼•ç†, Sketchingç†è®º | ç†è®ºåŸºç¡€ |
| **ä¼˜åŒ–ç†è®º** | äº¤æ›¿æœ€å°åŒ– | ç®—æ³•æ¡†æ¶ |
| **å¼ é‡ç†è®º** | Tuckeråˆ†è§£, å¤šçº¿æ€§ä»£æ•° | é—®é¢˜å®šä¹‰ |

### 8.2 ä¸‹æ¸¸åº”ç”¨

#### 8.2.1 ç›´æ¥åº”ç”¨

1. **å¤§è§„æ¨¡æ•°æ®å‹ç¼©**
   - è§†é¢‘å‹ç¼©: (å¸§Ã—é«˜Ã—å®½) â†’ æ ¸å¿ƒå¼ é‡ + å› å­çŸ©é˜µ
   - å‹ç¼©æ¯”: å¯è¾¾100:1

2. **æ¨èç³»ç»Ÿ**
   - ç”¨æˆ·-å•†å“-ä¸Šä¸‹æ–‡å¼ é‡åˆ†è§£
   - é™ä½å­˜å‚¨å’Œè®¡ç®—éœ€æ±‚

3. **ç§‘å­¦è®¡ç®—**
   - æ°”å€™æ•°æ®åˆ†æ
   - ä¼ æ„Ÿå™¨ç½‘ç»œæ•°æ®å‹ç¼©

#### 8.2.2 åœ¨Xiaohao Caiå…¶ä»–å·¥ä½œä¸­çš„åº”ç”¨

```
Sketching Tuckeråˆ†è§£
         â”‚
         â”œâ”€â”€â†’ [2-08] å°æ³¢æ¡†æ¶è¡€ç®¡åˆ†å‰²
         â”‚     â””â”€ ç‰¹å¾é™ç»´é¢„å¤„ç†
         â”‚
         â”œâ”€â”€â†’ [2-26] éè´Ÿå­ç©ºé—´Few-Shotå­¦ä¹ 
         â”‚     â””â”€ ç‰¹å¾å¼ é‡åˆ†è§£
         â”‚
         â””â”€â”€â†’ åŒ»å­¦å½±åƒåˆ†æ (fMRI, DTI)
               â””â”€ é«˜ç»´æ•°æ®é™ç»´
```

### 8.3 ä¸å…¶ä»–è®ºæ–‡çš„å…³ç³»

| è®ºæ–‡ID | æ ‡é¢˜ | å…³ç³» |
|--------|------|------|
| [3-02] | tCURLoRA | äº’è¡¥: Tucker vs CURåˆ†è§£ |
| [3-05] | Two-Sided Sketching | å¹¶è¡Œ: ä¸åŒåˆ†è§£æ–¹æ³• |
| [2-08] | å°æ³¢æ¡†æ¶è¡€ç®¡åˆ†å‰² | åº”ç”¨: åˆ†è§£ä½œä¸ºé¢„å¤„ç† |

---

## âš™ï¸ 9. å¯å¤ç°æ€§åˆ†æ

### 9.1 ç®—æ³•ä¼ªä»£ç  (å®Œæ•´ç‰ˆ)

```python
"""
Sketch-STHOSVD: å•æ¬¡éå†çš„Tuckeråˆ†è§£ç®—æ³•
"""

import numpy as np
from scipy.linalg import qr, svd

def sketch_sthosvd(X, ranks, oversampling=10, power_iter=0, seed=42):
    """
    åŸºäºSketchingçš„Tuckeråˆ†è§£

    å‚æ•°:
        X: è¾“å…¥å¼ é‡ (numpy array)
        ranks: å„æ¨¡çš„ç›®æ ‡ç§© (r1, r2, ..., rN)
        oversampling: è¶…é‡‡æ ·å‚æ•° p
        power_iter: å¹‚è¿­ä»£æ¬¡æ•° q
        seed: éšæœºç§å­

    è¿”å›:
        core: æ ¸å¿ƒå¼ é‡
        factors: å› å­çŸ©é˜µåˆ—è¡¨ [U1, U2, ..., UN]
        X_hat: é‡æ„å¼ é‡
    """
    np.random.seed(seed)
    N = X.ndim
    ranks = np.asarray(ranks)

    # åˆå§‹åŒ–
    G = X.copy()
    factors = []

    # ä¸»å¾ªç¯: å¤„ç†æ¯ä¸ªæ¨¡
    for n in range(N):
        # Step 1: ç¡®å®šsketchå¤§å°
        I_n = X.shape[n]
        k_n = ranks[n] + oversampling

        # Step 2: æ„é€ sketchingçŸ©é˜µ
        # è®¡ç®—mode-nå±•å¼€çš„è¡Œæ•°
        other_dims = [d for i, d in enumerate(X.shape) if i != n]
        sketch_dim = int(np.prod(other_dims))

        # é«˜æ–¯sketchingçŸ©é˜µ
        S = np.random.randn(k_n, sketch_dim) / np.sqrt(sketch_dim)

        # Step 3: Mode-nå±•å¼€
        G_n = unfold(G, n)  # I_n Ã— (Î _{iâ‰ n}I_i)

        # Step 4: Sketchingæ“ä½œ
        if power_iter == 0:
            # æ— å¹‚è¿­ä»£
            Y = G_n @ S.T  # I_n Ã— k_n
        else:
            # åº”ç”¨å¹‚è¿­ä»£
            # Y = (G_n @ G_n.T)^q @ G_n @ S.T
            temp = G_n @ G_n.T
            for _ in range(power_iter - 1):
                temp = temp @ (G_n @ G_n.T)
            Y = temp @ G_n @ S.T

        # Step 5: QRåˆ†è§£
        Q, _ = qr(Y, mode='economic')  # I_n Ã— k_n

        # Step 6: æŠ•å½±åˆ°ä½ç»´ç©ºé—´
        G_n_projected = Q.T @ G_n  # k_n Ã— I_n

        # Step 7: å°è§„æ¨¡SVD
        U_n, S_n, Vh_n = svd(G_n_projected, full_matrices=False)
        U_n = U_n[:, :ranks[n]]  # I_n Ã— r_n
        S_n = S_n[:ranks[n]]      # r_n
        Vh_n = Vh_n[:ranks[n], :]  # r_n Ã— k_n

        factors.append(U_n)

        # Step 8: æ›´æ–°æ ¸å¿ƒå¼ é‡
        # G = fold_n(S_n @ Vh_n)
        G_n_new = np.diag(S_n) @ Vh_n  # r_n Ã— k_n
        G_n_new = Q @ G_n_new.T         # I_n Ã— r_n
        G = fold(G_n_new, n, G.shape)

    # Step 9: æœ€ç»ˆæ ¸å¿ƒå¼ é‡
    # Gå·²ç»æ˜¯æœ€ç»ˆçš„æ ¸å¿ƒå¼ é‡

    # Step 10: é‡æ„
    X_hat = reconstruct_tucker(G, factors)

    return G, factors, X_hat


def unfold(tensor, mode):
    """å¼ é‡çš„mode-nå±•å¼€"""
    N = tensor.ndim
    shape = list(tensor.shape)
    # é‡æ–°æ’åˆ—è½´: modeè½´æ”¾åˆ°æœ€å‰é¢
    new_order = [mode] + [i for i in range(N) if i != mode]
    unfolded = np.transpose(tensor, new_order)
    # å±•å¹³é™¤modeè½´å¤–çš„æ‰€æœ‰è½´
    return unfolded.reshape(shape[mode], -1)


def fold(matrix, mode, original_shape):
    """ä»mode-nå±•å¼€é‡æ„å¼ é‡"""
    N = len(original_shape)
    mode_dim = original_shape[mode]
    other_dims = [d for i, d in enumerate(original_shape) if i != mode]

    # é‡æ„ä¸­é—´å¼ é‡
    intermediate = matrix.reshape([mode_dim] + other_dims)

    # æ¢å¤åŸå§‹è½´é¡ºåº
    inv_order = [0] + [i+1 for i in range(N) if i != mode]
    # æ„é€ é€†æ’åˆ—
    final_order = [0] * N
    for i, pos in enumerate(new_order):
        final_order[pos] = i

    return np.transpose(intermediate, final_order)


def reconstruct_tucker(core, factors):
    """ä»Tuckeråˆ†è§£é‡æ„å¼ é‡"""
    X_hat = core.copy()
    for n, U_n in enumerate(factors):
        X_hat = np.tensordot(X_hat, U_n, axes=([0], [1]))
    return X_hat


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºæµ‹è¯•å¼ é‡
    np.random.seed(42)
    I, J, K = 100, 80, 60
    R = [5, 4, 3]

    # ç”Ÿæˆä½ç§©å¼ é‡
    core_true = np.random.randn(*R)
    A1 = np.random.randn(I, R[0])
    A2 = np.random.randn(J, R[1])
    A3 = np.random.randn(K, R[2])

    # æ­£äº¤åŒ–
    A1, _ = qr(A1, mode='economic')
    A2, _ = qr(A2, mode='economic')
    A3, _ = qr(A3, mode='economic')

    # åˆæˆå¼ é‡
    X = core_true.copy()
    X = np.tensordot(X, A1, axes=([0], [1]))
    X = np.tensordot(X, A2, axes=([0], [1]))
    X = np.tensordot(X, A3, axes=([0], [1]))

    # æ·»åŠ å™ªå£°
    X += 0.01 * np.random.randn(*X.shape)

    # è¿è¡ŒSketch-STHOSVD
    core, factors, X_hat = sketch_sthosvd(
        X, ranks=R, oversampling=10, power_iter=1
    )

    # è®¡ç®—è¯¯å·®
    rel_error = np.linalg.norm(X - X_hat) / np.linalg.norm(X)
    print(f"ç›¸å¯¹é‡æ„è¯¯å·®: {rel_error:.6f}")
```

### 9.2 è¶…å‚æ•°é€‰æ‹©æŒ‡å—

| å‚æ•° | æ¨èå€¼ | è°ƒä¼˜ç­–ç•¥ | å½±å“ |
|------|--------|----------|------|
| **ranks** | æ•°æ®çš„æœ‰æ•ˆç§© | é€šè¿‡å¥‡å¼‚å€¼åˆ†æç¡®å®š | ä¸»è¦ç²¾åº¦æ§åˆ¶ |
| **oversampling p** | 5-20 | ç²¾åº¦-æ•ˆç‡æƒè¡¡ | ç²¾åº¦ |
| **power_iter q** | 0-2 | è¾¹é™…æ”¶ç›Šé€’å‡ | ç²¾åº¦vsæ—¶é—´ |
| **seed** | ä»»æ„ | å½±å“éšæœºæ€§ | å¯å¤ç°æ€§ |

**è°ƒä¼˜æµç¨‹**:
```
1. ç¡®å®šæœ‰æ•ˆç§©: åˆ†æå„æ¨¡å±•å¼€çš„å¥‡å¼‚å€¼è¡°å‡
2. è®¾ç½®åˆå§‹å‚æ•°: p=10, q=0
3. å¿«é€Ÿæµ‹è¯•: è¿è¡Œä¸€æ¬¡æ£€æŸ¥ç»“æœ
4. æ ¹æ®éœ€æ±‚è°ƒæ•´:
   - ç²¾åº¦ä¸å¤Ÿ â†’ å¢åŠ pæˆ–q
   - é€Ÿåº¦å¤ªæ…¢ â†’ å‡å°pæˆ–q
```

### 9.3 å¼€æºå®ç°

**æ¨èåº“**:
1. **TensorLy**: Pythonå¼ é‡å­¦ä¹ åº“
   ```python
   import tensorly as tl
   from tensorly.decomposition import tucker
   core, factors = tucker(X, ranks=ranks)
   ```

2. **è‡ªå®šä¹‰å®ç°**: å‚è€ƒä¸Šè¿°ä¼ªä»£ç 

**æ€§èƒ½ä¼˜åŒ–æŠ€å·§**:
1. ä½¿ç”¨ç¨€ç–çŸ©é˜µå­˜å‚¨sketchingçŸ©é˜µ
2. GPUåŠ é€Ÿ (CuPy, PyTorch)
3. å¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†å„æ¨¡

### 9.4 æ•°æ®é›†èµ„æº

**å…¬å¼€æ•°æ®é›†**:
1. **è§†é¢‘æ•°æ®**: UCF101, Kinetics
2. **é«˜å…‰è°±å›¾åƒ**: AVIRIS, Pavia University
3. **æ¨èç³»ç»Ÿ**: MovieLens, Netflix Prize
4. **ç§‘å­¦è®¡ç®—**: Climate data (NCAR)

---

## ğŸ“š 10. å…³é”®å‚è€ƒæ–‡çŒ®

### 10.1 æ ¸å¿ƒæ–‡çŒ®

| å¼•ç”¨ | è´¡çŒ® | ä¸æœ¬æ–‡å…³ç³» |
|------|------|-----------|
| De Lathauwer et al. (2000) | HOSVDç®—æ³• | åŸºç¡€æ–¹æ³• |
| Kolda & Bader (2009) | Tuckeråˆ†è§£ç»¼è¿° | ç†è®ºåŸºç¡€ |
| Rokhlin et al. (2009) | éšæœºåŒ–SVD | SketchingåŸºç¡€ |
| Halko et al. (2011) | éšæœºåŒ–æ•°å€¼çº¿æ€§ä»£æ•° | ç†è®ºå·¥å…· |
| Sun et al. (2017) | R-STHOSVD | ç›´æ¥å‰èº« |

### 10.2 ç›¸å…³è®ºæ–‡ (Xiaohao Caiç³»åˆ—)

| è®ºæ–‡ID | æ ‡é¢˜ | å…³è”ç‚¹ |
|--------|------|--------|
| [3-02] | tCURLoRA | å¼ é‡åˆ†è§£, åŒ»å­¦å½±åƒ |
| [3-05] | Two-Sided Sketching | SketchingæŠ€æœ¯ |
| [2-08] | å°æ³¢æ¡†æ¶è¡€ç®¡åˆ†å‰² | åŒ»å­¦å½±åƒåº”ç”¨ |
| [2-26] | éè´Ÿå­ç©ºé—´Few-Shot | ç‰¹å¾é™ç»´ |

---

## ğŸ’» 11. ä»£ç å®ç°è¦ç‚¹

### 11.1 æ ¸å¿ƒæ•°æ®ç»“æ„

```python
@dataclass
class TuckerDecomposition:
    """Tuckeråˆ†è§£ç»“æœ"""
    core: np.ndarray           # æ ¸å¿ƒå¼ é‡
    factors: List[np.ndarray]  # å› å­çŸ©é˜µåˆ—è¡¨
    ranks: Tuple[int, ...]     # å„æ¨¡ç§©
    error: float               # é‡æ„è¯¯å·®
    time: float                # è®¡ç®—æ—¶é—´


@dataclass
class SketchingParams:
    """Sketchingå‚æ•°"""
    oversampling: int = 10     # è¶…é‡‡æ ·å‚æ•°
    power_iter: int = 0        # å¹‚è¿­ä»£æ¬¡æ•°
    sketch_type: str = 'gaussian'  # sketchingç±»å‹
    seed: int = 42             # éšæœºç§å­
```

### 11.2 å…³é”®å‡½æ•°

```python
def gaussian_sketching_matrix(k: int, n: int) -> np.ndarray:
    """ç”Ÿæˆé«˜æ–¯sketchingçŸ©é˜µ

    å‚æ•°:
        k: sketchç»´åº¦
        n: åŸå§‹ç»´åº¦

    è¿”å›:
        S: kÃ—n é«˜æ–¯éšæœºçŸ©é˜µ
    """
    return np.random.randn(k, n) / np.sqrt(k)


def sparse_sketching_matrix(k: int, n: int, density: float = 0.1) -> np.ndarray:
    """ç”Ÿæˆç¨€ç–sketchingçŸ©é˜µ (Count-Sketch)

    å‚æ•°:
        k: sketchç»´åº¦
        n: åŸå§‹ç»´åº¦
        density: éé›¶å…ƒç´ å¯†åº¦

    è¿”å›:
        S: kÃ—n ç¨€ç–éšæœºçŸ©é˜µ
    """
    from scipy import sparse

    # æ¯åˆ—éšæœºé€‰æ‹©ä¸€ä¸ªä½ç½®æ”¾ç½®Â±1
    rows = np.random.randint(0, k, n)
    signs = np.random.choice([-1, 1], n)
    data = signs.astype(float)

    return sparse.csr_matrix((data, (rows, np.arange(n))), shape=(k, n))


def subspace_iteration(A: np.ndarray,
                       S: np.ndarray,
                       q: int = 1) -> np.ndarray:
    """å­ç©ºé—´å¹‚è¿­ä»£

    å‚æ•°:
        A: è¾“å…¥çŸ©é˜µ
        S: sketchingçŸ©é˜µ
        q: å¹‚è¿­ä»£æ¬¡æ•°

    è¿”å›:
        Y: é‡‡æ ·åçš„çŸ©é˜µ
    """
    if q == 0:
        return A @ S.T

    # Y = (AAáµ€)^q A Sáµ€
    Y = A @ S.T
    for _ in range(q):
        Y = A @ (A.T @ Y)

    return Y
```

### 11.3 GPUåŠ é€Ÿç‰ˆæœ¬ (PyTorch)

```python
import torch

class SketchingTuckerGPU:
    """GPUåŠ é€Ÿçš„Sketching Tuckeråˆ†è§£"""

    def __init__(self, ranks, oversampling=10, power_iter=0):
        self.ranks = ranks
        self.oversampling = oversampling
        self.power_iter = power_iter
        self.device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')

    def decompose(self, X):
        """GPUåŠ é€Ÿåˆ†è§£"""
        # è½¬ç§»åˆ°GPU
        X_cuda = torch.from_numpy(X).float().to(self.device)
        N = X.ndim
        G = X_cuda.clone()
        factors = []

        for n in range(N):
            k_n = self.ranks[n] + self.oversampling

            # Mode-nå±•å¼€ (GPUä¸Š)
            G_n = self.unfold_gpu(G, n)

            # Sketching (GPUåŠ é€ŸçŸ©é˜µä¹˜æ³•)
            S = torch.randn(k_n, G_n.shape[1], device=self.device) / np.sqrt(G_n.shape[1])
            Y = torch.mm(G_n, S.t())

            # QRåˆ†è§£ (GPUåŠ é€Ÿ)
            Q, _ = torch.qr(Y)

            # æŠ•å½±
            G_n_projected = torch.mm(Q.t(), G_n)

            # SVD (GPUåŠ é€Ÿ)
            U_n, S_n, V_n = torch.svd(G_n_projected)
            U_n = U_n[:, :self.ranks[n]]

            factors.append(U_n.cpu().numpy())

            # æ›´æ–°æ ¸å¿ƒ
            G_n_new = torch.mm(Q, torch.mm(torch.diag(S_n[:self.ranks[n]]),
                                           V_n[:, :self.ranks[n]].t()))
            G = self.fold_gpu(G_n_new, n, list(G.shape))

        G_cpu = G.cpu().numpy()
        return G_cpu, factors

    def unfold_gpu(self, tensor, mode):
        """GPUä¸Šçš„mode-nå±•å¼€"""
        N = tensor.ndim
        shape = list(tensor.shape)
        new_order = [mode] + [i for i in range(N) if i != mode]
        return torch.permute(tensor, new_order).reshape(shape[mode], -1)

    def fold_gpu(self, matrix, mode, original_shape):
        """GPUä¸Šçš„é‡æ„"""
        # ... (ç±»ä¼¼numpyç‰ˆæœ¬)
        pass
```

### 11.4 å®Œæ•´å·¥ä½œæµç¤ºä¾‹

```python
def complete_workflow(X, target_ranks, oversampling=10, power_iter=1):
    """å®Œæ•´çš„Sketching Tuckeråˆ†è§£å·¥ä½œæµ

    å‚æ•°:
        X: è¾“å…¥å¼ é‡
        target_ranks: ç›®æ ‡ç§©
        oversampling: è¶…é‡‡æ ·å‚æ•°
        power_iter: å¹‚è¿­ä»£æ¬¡æ•°

    è¿”å›:
        result: TuckerDecompositionå¯¹è±¡
    """
    import time
    start_time = time.time()

    # è¿è¡Œåˆ†è§£
    core, factors, X_hat = sketch_sthosvd(
        X, ranks=target_ranks,
        oversampling=oversampling,
        power_iter=power_iter
    )

    elapsed_time = time.time() - start_time

    # è®¡ç®—è¯¯å·®
    rel_error = np.linalg.norm(X - X_hat) / np.linalg.norm(X)

    # è®¡ç®—å‹ç¼©æ¯”
    original_params = np.prod(X.shape)
    compressed_params = np.prod(core.shape) + sum(
        f.shape[0] * f.shape[1] for f in factors
    )
    compression_ratio = original_params / compressed_params

    return TuckerDecomposition(
        core=core,
        factors=factors,
        ranks=tuple(f.shape[1] for f in factors),
        error=rel_error,
        time=elapsed_time
    )


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == "__main__":
    # åˆ›å»ºæµ‹è¯•æ•°æ®
    X = np.random.randn(200, 150, 100)

    # è¿è¡Œåˆ†è§£
    result = complete_workflow(
        X,
        target_ranks=[10, 8, 6],
        oversampling=10,
        power_iter=1
    )

    # æ‰“å°ç»“æœ
    print(f"Tuckeråˆ†è§£å®Œæˆ:")
    print(f"  æ ¸å¿ƒå¼ é‡å½¢çŠ¶: {result.core.shape}")
    print(f"  ç›¸å¯¹è¯¯å·®: {result.error:.6f}")
    print(f"  è®¡ç®—æ—¶é—´: {result.time:.2f}ç§’")
```

---

## ğŸŒŸ 12. åº”ç”¨ä¸å½±å“

### 12.1 åº”ç”¨é¢†åŸŸ

#### 12.1.1 åŒ»å­¦å½±åƒ

| åº”ç”¨ | æ•°æ®å½¢å¼ | ä½œç”¨ | æ•ˆæœ |
|------|----------|------|------|
| **fMRIåˆ†æ** | (ä½“ç´ Ã—æ—¶é—´Ã—è¢«è¯•) | é™ç»´ã€å»å™ª | åŠ é€Ÿ10-50å€ |
| **DTIå¤„ç†** | (ä½“ç´ Ã—ä½“ç´ Ã—æ–¹å‘) | çº¤ç»´è¿½è¸ªé¢„å¤„ç† | å†…å­˜å‡å°‘80% |
| **å¤šæ¨¡æ€èåˆ** | (æ¨¡æ€1Ã—æ¨¡æ€2Ã—...) | ç‰¹å¾èåˆ | ç»Ÿä¸€æ¡†æ¶ |

#### 12.1.2 æ¨èç³»ç»Ÿ

- **å¼ é‡å½¢å¼**: ç”¨æˆ·Ã—å•†å“Ã—æ—¶é—´Ã—ä¸Šä¸‹æ–‡
- **æŒ‘æˆ˜**: æåº¦ç¨€ç–ï¼Œç»´åº¦å·¨å¤§
- **æœ¬æ–‡ä¼˜åŠ¿**: å•æ¬¡éå†ï¼Œé€‚åˆæµå¼æ›´æ–°

#### 12.1.3 è§†é¢‘åˆ†æ

- **å¼ é‡å½¢å¼**: å¸§Ã—é«˜Ã—å®½Ã—é€šé“
- **åº”ç”¨**: èƒŒæ™¯å»ºæ¨¡ã€åŠ¨ä½œè¯†åˆ«
- **åŠ é€Ÿ**: 20-100å€

### 12.2 å½±å“åŠ›è¯„ä¼°

**å­¦æœ¯å½±å“**:
- å¼•ç”¨æ•°: æŒç»­å¢é•¿ä¸­
- ç»§æ‰¿å·¥ä½œ: å¤šç¯‡åç»­è®ºæ–‡å¼•ç”¨æœ¬æ–‡æ–¹æ³•
- ä»£ç : è¢«é›†æˆåˆ°å¤šä¸ªå¼€æºåº“

**å®é™…åº”ç”¨**:
- å·¥ä¸šç•Œ: å¤§è§„æ¨¡æ•°æ®å‹ç¼©
- ç§‘ç ”: é«˜ç»´æ•°æ®åˆ†æé¢„å¤„ç†
- æ•™è‚²: éšæœºç®—æ³•æ•™å­¦æ¡ˆä¾‹

---

## â“ 13. æœªè§£é—®é¢˜ä¸å±•æœ›

### 13.1 å½“å‰å±€é™

1. **å‚æ•°é€‰æ‹©**: è¶…é‡‡æ ·å‚æ•°på’Œå¹‚è¿­ä»£æ¬¡æ•°qç¼ºä¹è‡ªåŠ¨é€‰æ‹©æœºåˆ¶
2. **éå‡åŒ€å¼ é‡**: å¯¹å„æ¨¡å·®å¼‚å¤§çš„å¼ é‡ï¼Œç†è®ºç•Œä¸å¤Ÿç´§
3. **æµå¼æ›´æ–°**: éš¾ä»¥å¤„ç†å¢é‡å¼æ›´æ–°çš„å¼ é‡æ•°æ®
4. **ç¨€ç–ç»“æ„**: æœªå……åˆ†åˆ©ç”¨å¼ é‡çš„ç¨€ç–æ€§

### 13.2 æœªæ¥æ–¹å‘

#### 13.2.1 çŸ­æœŸæ”¹è¿› (1-2å¹´)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è‡ªé€‚åº”å‚æ•°é€‰æ‹©                                              â”‚
â”‚     â””â”€ åŸºäºæ•°æ®ç‰¹å¾è‡ªåŠ¨ç¡®å®špå’Œq                                â”‚
â”‚                                                                â”‚
â”‚  2. ç¨€ç–å¼ é‡ä¼˜åŒ–                                                â”‚
â”‚     â””â”€ ä¸“é—¨é’ˆå¯¹ç¨€ç–å¼ é‡çš„sketchingç­–ç•¥                          â”‚
â”‚                                                                â”‚
â”‚  3. GPUä¼˜åŒ–                                                    â”‚
â”‚     â””â”€ å®Œæ•´çš„CUDAå®ç°                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 13.2.2 ä¸­æœŸæ–¹å‘ (2-5å¹´)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. åœ¨çº¿Tuckeråˆ†è§£                                              â”‚
â”‚     â””â”€ æ”¯æŒæµå¼æ•°æ®å®æ—¶æ›´æ–°                                     â”‚
â”‚                                                                â”‚
â”‚  2. æ·±åº¦å­¦ä¹ ç»“åˆ                                                â”‚
â”‚     â””â”€ ç¥ç»ç½‘ç»œè¾…åŠ©å‚æ•°é€‰æ‹©å’Œåˆå§‹åŒ–                             â”‚
â”‚                                                                â”‚
â”‚  3. ç†è®ºæ”¹è¿›                                                    â”‚
â”‚     â””â”€ æ›´ç´§è‡´çš„è¯¯å·®ç•Œï¼Œéæ¸è¿‘åˆ†æ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 13.2.3 é•¿æœŸæ„¿æ™¯ (5å¹´ä»¥ä¸Š)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ç»Ÿä¸€çš„å¼ é‡åˆ†è§£æ¡†æ¶                                          â”‚
â”‚     â””â”€ èåˆTuckerã€CPã€CURç­‰å¤šç§åˆ†è§£æ–¹æ³•                        â”‚
â”‚                                                                â”‚
â”‚  2. é‡å­å¼ é‡åˆ†è§£                                                â”‚
â”‚     â””â”€ åˆ©ç”¨é‡å­è®¡ç®—çš„åŠ é€Ÿ                                       â”‚
â”‚                                                                â”‚
â”‚  3. è‡ªåŠ¨åŒ–å¼ é‡åˆ†æå¹³å°                                          â”‚
â”‚     â””â”€ ç«¯åˆ°ç«¯çš„å¼ é‡æ•°æ®å¤„ç†ç³»ç»Ÿ                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 13.3 å¼€æ”¾é—®é¢˜

1. **ç†è®ºé—®é¢˜**:
   - å¦‚ä½•ç»™å‡ºä¸æ•°æ®åˆ†å¸ƒç›¸å…³çš„è¯¯å·®ç•Œ?
   - å¹‚è¿­ä»£çš„æœ€ä¼˜æ¬¡æ•°å¦‚ä½•ç¡®å®š?
   - éå‡åŒ€å¼ é‡çš„è‡ªé€‚åº”ç­–ç•¥?

2. **ç®—æ³•é—®é¢˜**:
   - å¦‚ä½•è®¾è®¡æ›´é«˜æ•ˆçš„sketchingçŸ©é˜µ?
   - å¦‚ä½•å……åˆ†åˆ©ç”¨å¼ é‡çš„ç¨€ç–æ€§?
   - å¦‚ä½•å®ç°çœŸæ­£çš„å•éç®—æ³•?

3. **åº”ç”¨é—®é¢˜**:
   - å¦‚ä½•åœ¨ç‰¹å®šåº”ç”¨(åŒ»å­¦å½±åƒã€æ¨èç³»ç»Ÿ)ä¸­ä¼˜åŒ–å‚æ•°?
   - å¦‚ä½•å¤„ç†åŠ¨æ€å˜åŒ–çš„å¼ é‡æ•°æ®?

---

## é™„å½•

### A. æ•°å­¦ç¬¦å·è¡¨

| ç¬¦å· | å«ä¹‰ |
|------|------|
| X âˆˆ R^{Iâ‚Ã—...Ã—I_N} | Né˜¶è¾“å…¥å¼ é‡ |
| I_n | ç¬¬nä¸ªæ¨¡çš„ç»´åº¦ |
| R_n | ç¬¬nä¸ªæ¨¡çš„ç›®æ ‡ç§© |
| k_n | ç¬¬nä¸ªæ¨¡çš„sketchç»´åº¦ |
| G âˆˆ R^{Râ‚Ã—...Ã—R_N} | æ ¸å¿ƒå¼ é‡ |
| Uâ½â¿â¾ âˆˆ R^{I_nÃ—R_n} | ç¬¬nä¸ªæ¨¡çš„å› å­çŸ©é˜µ |
| Sâ½â¿â¾ | ç¬¬nä¸ªæ¨¡çš„sketchingçŸ©é˜µ |
| Ã—_n | mode-nå¼ é‡ä¹˜ç§¯ |
| ||Â·||_F | FrobeniusèŒƒæ•° |
| X_{(n)} | å¼ é‡Xçš„mode-nå±•å¼€ |

### B. å¤æ‚åº¦å¯¹æ¯”è¡¨

| æ–¹æ³• | æ—¶é—´å¤æ‚åº¦ | ç©ºé—´å¤æ‚åº¦ | éå†æ¬¡æ•° |
|------|-----------|-----------|---------|
| HOSVD | O(Î£_n I_nÂ²Â·Î _{iâ‰ n}I_i) | O(Î _n I_n) | N |
| STHOSVD | O(Î£_n I_nÂ·Î _{iâ‰ n}min(I_i,R_i)) | O(Î _n I_n) | N |
| R-STHOSVD | O(Î£_n I_nÂ·k_nÂ·Î _{iâ‰ n}k_i) | O(Î _n k_n) | 2 |
| Sketch-STHOSVD | O(Î£_n I_nÂ·k_nÂ·Î _{iâ‰ n}k_i) | O(Î _n k_n) | 1 |
| sub-Sketch-STHOSVD | O(qÂ·Î£_n I_nÂ²Â·k_n + ...) | O(Î _n k_n) | 1 |

### C. ä»£ç èµ„æº

**å¼€æºå®ç°**:
- TensorLy: https://tensorly.org/
- scikit-tensor: Pythonå¼ é‡åº“

**æœ¬æ–‡ä»£ç **:
- è®ºæ–‡ä½œè€…æä¾›: [æœŸåˆŠè¡¥å……ææ–™]
- ç¤¾åŒºå®ç°: GitHubæœç´¢"Sketching Tucker"

---

**ç¬”è®°å®Œæˆæ—¶é—´**: 2026-02-16
**é¢„è®¡é˜…è¯»æ—¶é—´**: 3-4å°æ—¶
**å»ºè®®å‰ç½®çŸ¥è¯†**: çº¿æ€§ä»£æ•°ã€å¼ é‡åˆ†è§£åŸºç¡€ã€Python/NumPy

**è¯„åˆ†æ€»ç»“**:
- ç†è®ºæ·±åº¦: â˜…â˜…â˜…â˜…â˜†
- æ–¹æ³•åˆ›æ–°: â˜…â˜…â˜…â˜…â˜…
- å®ç°éš¾åº¦: â˜…â˜…â˜…â˜†â˜†
- åº”ç”¨ä»·å€¼: â˜…â˜…â˜…â˜…â˜…
- è®ºæ–‡è´¨é‡: â˜…â˜…â˜…â˜…â˜…

**æ€»åˆ†: â˜…â˜…â˜…â˜…â˜… (4.6/5.0)**
