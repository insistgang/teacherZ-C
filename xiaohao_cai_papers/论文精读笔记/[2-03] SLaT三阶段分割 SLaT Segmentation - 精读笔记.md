# [2-03] SLaTä¸‰é˜¶æ®µåˆ†å‰² SLaT Segmentation - ç²¾è¯»ç¬”è®°

> **è®ºæ–‡æ ‡é¢˜**: A Three-Stage Approach for Segmenting Degraded Color Images: Smoothing, Lifting and Thresholding (SLaT)
> **ä½œè€…**: Xiaohao Cai, Raymond Chan, Mila Nikolova, Tieyong Zeng
> **å‡ºå¤„**: Journal of Scientific Computing (J Sci Comput)
> **å¹´ä»½**: 2017
> **å·æœŸ**: Vol. 72, pp. 1313-1332
> **DOI**: 10.1007/s10915-017-0402-2
> **ç±»å‹**: æ–¹æ³•åˆ›æ–°è®ºæ–‡
> **ç²¾è¯»æ—¥æœŸ**: 2026å¹´2æœˆ9æ—¥

---

## ğŸ“‹ è®ºæ–‡åŸºæœ¬ä¿¡æ¯

### å…ƒæ•°æ®
| é¡¹ç›® | å†…å®¹ |
|:---|:---|
| **ç±»å‹** | æ–¹æ³•åˆ›æ–° (Method Innovation) |
| **é¢†åŸŸ** | å›¾åƒåˆ†å‰² + å˜åˆ†æ³• |
| **èŒƒå›´** | é€€åŒ–å½©è‰²å›¾åƒåˆ†å‰² |
| **é‡è¦æ€§** | â˜…â˜…â˜…â˜…â˜† (æ¡†æ¶çº§åˆ›æ–°) |
| **ç‰¹ç‚¹** | ä¸‰é˜¶æ®µè®¾è®¡ã€é²æ£’æ€§å¼ºã€å‚æ•°çµæ´» |

### å…³é”®è¯
- **SLaT** - Smoothing, Lifting and Thresholding (å¹³æ»‘ã€æå‡ã€é˜ˆå€¼)
- **Degraded Color Images** - é€€åŒ–å½©è‰²å›¾åƒ
- **Mumford-Shah Model** - Mumford-Shahæ¨¡å‹
- **Convex Relaxation** - å‡¸æ¾å¼›
- **Multi-channel Segmentation** - å¤šé€šé“åˆ†å‰²
- **Color Spaces** - é¢œè‰²ç©ºé—´

---

## ğŸ¯ ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

### 1.1 è®ºæ–‡å®šä½

**è¿™æ˜¯ä»€ä¹ˆï¼Ÿ**
- ä¸€ç¯‡**æ–¹æ³•åˆ›æ–°è®ºæ–‡**ï¼Œæå‡ºå…¨æ–°çš„ä¸‰é˜¶æ®µåˆ†å‰²æ¡†æ¶
- é’ˆå¯¹**é€€åŒ–å½©è‰²å›¾åƒ**ï¼ˆå™ªå£°ã€æ¨¡ç³Šã€ä¿¡æ¯ä¸¢å¤±ï¼‰çš„ä¸“ç”¨æ–¹æ³•
- åœ¨Journal of Scientific Computingå‘è¡¨çš„å˜åˆ†æ³•æ–¹æ³•è®ºæ–‡

**ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ**
```
é€€åŒ–å½©è‰²å›¾åƒåˆ†å‰²æŒ‘æˆ˜:
â”œâ”€â”€ å™ªå£°å¹²æ‰°
â”œâ”€â”€ æ¨¡ç³Šå¤±çœŸ
â”œâ”€â”€ ä¿¡æ¯ä¸¢å¤±
â”œâ”€â”€ é¢œè‰²é€šé“ç›¸å…³æ€§é«˜
â””â”€â”€ ä¼ ç»Ÿæ–¹æ³•æ•ˆæœå·®

SLaTæ–¹æ³•è´¡çŒ®:
â”œâ”€â”€ ä¸‰é˜¶æ®µåˆ†ç¦»è®¾è®¡
â”œâ”€â”€ å¯¹é€€åŒ–é²æ£’
â”œâ”€â”€ ç›¸ä½æ•°çµæ´»å¯è°ƒ
â””â”€â”€ è®¡ç®—æ•ˆç‡é«˜
```

### 1.2 SLaTçš„å«ä¹‰

**SLaT = Smoothing + Lifting + Thresholding**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SLaT ä¸‰é˜¶æ®µæ¡†æ¶                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  Stage 1: Smoothing (å¹³æ»‘)                      â”‚
â”‚  â””â”€ å¯¹æ¯ä¸ªé¢œè‰²é€šé“åº”ç”¨Mumford-Shahå‡¸å˜ä½“         â”‚
â”‚                                                 â”‚
â”‚  Stage 2: Lifting (æå‡)                        â”‚
â”‚  â””â”€ æ„å»ºå‘é‡å€¼å›¾åƒï¼Œå¼•å…¥æ¬¡çº§é¢œè‰²ç©ºé—´ä¿¡æ¯         â”‚
â”‚                                                 â”‚
â”‚  Stage 3: Thresholding (é˜ˆå€¼)                   â”‚
â”‚  â””â”€ å¤šé€šé“é˜ˆå€¼åˆ†å‰²ï¼Œä»…åœ¨æ­¤é˜¶æ®µæŒ‡å®šç›¸ä½æ•°         â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç†å¿µ**: å°†å¤æ‚çš„åˆ†å‰²ä»»åŠ¡åˆ†è§£ä¸ºä¸‰ä¸ªç‹¬ç«‹çš„å­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡ä¸“æ³¨è§£å†³ä¸€ä¸ªé—®é¢˜

---

## ğŸ”¬ æ–¹æ³•è®ºæ¡†æ¶

### 2.1 æ•´ä½“æ¶æ„

```
è¾“å…¥é€€åŒ–å½©è‰²å›¾åƒ f = (fÂ¹, fÂ², fÂ³)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Stage 1: Smoothing                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å¯¹æ¯ä¸ªé€šé“ c = 1,2,3:               â”‚   â”‚
â”‚  â”‚ min E_MS(u^c) = âˆ«|âˆ‡u^c|Â² +        â”‚   â”‚
â”‚  â”‚               Î»âˆ«(u^c - f^c)Â²       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  è¾“å‡º: å¹³æ»‘å›¾åƒ g = (gÂ¹, gÂ², gÂ³)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Stage 2: Lifting                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ„å»ºå‘é‡å€¼å›¾åƒ:                     â”‚   â”‚
â”‚  â”‚ F(x) = (gÂ¹(x), gÂ²(x), gÂ³(x),       â”‚   â”‚
â”‚  â”‚        TÂ¹(g)(x), TÂ²(g)(x), TÂ³(g)(x))â”‚   â”‚
â”‚  â”‚                                     â”‚   â”‚
â”‚  â”‚ T^c(g) æ˜¯æ¬¡çº§é¢œè‰²ç©ºé—´çš„å˜æ¢          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  è¾“å‡º: æå‡åå‘é‡å€¼å›¾åƒ F                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Stage 3: Thresholding                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ å¤šé€šé“é˜ˆå€¼åˆ†å‰²:                     â”‚   â”‚
â”‚  â”‚ å°† F åˆ†å‰²ä¸º K ä¸ªç›¸ä½                â”‚   â”‚
â”‚  â”‚                                     â”‚   â”‚
â”‚  â”‚ u(x) = arg min ||F(x) - c_k||      â”‚   â”‚
â”‚  â”‚        k                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  è¾“å‡º: æœ€ç»ˆåˆ†å‰²ç»“æœ u                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ ¸å¿ƒæ€æƒ³

#### ä¸ºä»€ä¹ˆéœ€è¦ä¸‰é˜¶æ®µï¼Ÿ

```
å•é˜¶æ®µæ–¹æ³•çš„å±€é™:
â”œâ”€â”€ ä¼˜åŒ–é—®é¢˜å¤æ‚ï¼Œéš¾ä»¥æ±‚è§£
â”œâ”€â”€ å¯¹åˆå§‹åŒ–æ•æ„Ÿ
â”œâ”€â”€ ç›¸ä½æ•°éœ€è¦é¢„å…ˆå›ºå®š
â””â”€â”€ éš¾ä»¥å¤„ç†é€€åŒ–

ä¸‰é˜¶æ®µçš„ä¼˜åŠ¿:
âœ“ åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œæ¯ä¸ªé˜¶æ®µç‹¬ç«‹ä¼˜åŒ–
âœ“ å‰ä¸¤é˜¶æ®µä¸ç›¸ä½æ•°æ— å…³
âœ“ ç”¨æˆ·å¯çµæ´»è°ƒæ•´åˆ†å‰²ç±»åˆ«æ•°
âœ“ å¯¹é€€åŒ–æ•°æ®é²æ£’
```

---

## ğŸ’¡ æ ¸å¿ƒåˆ›æ–°ç‚¹

### 3.1 åˆ›æ–°ä¸€ï¼šä¸‰é˜¶æ®µåˆ†ç¦»è®¾è®¡

#### Stage 1: Smoothing (å¹³æ»‘)

**æ•°å­¦æ¨¡å‹**:
```
å¯¹äºæ¯ä¸ªé¢œè‰²é€šé“ c âˆˆ {1,2,3}:

E_MS(u^c) = âˆ«_Î© |âˆ‡u^c(x)|Â² dx + Î» âˆ«_Î© (u^c(x) - f^c(x))Â² dx

å…¶ä¸­:
â”œâ”€â”€ u^c: å¾…æ±‚è§£çš„å¹³æ»‘å›¾åƒ
â”œâ”€â”€ f^c: è¾“å…¥çš„é€€åŒ–å›¾åƒ
â”œâ”€â”€ Î»: å¹³è¡¡å‚æ•°
â”œâ”€â”€ ç¬¬ä¸€é¡¹: æ­£åˆ™é¡¹ (å…¨å˜å·®)
â””â”€â”€ ç¬¬äºŒé¡¹: æ•°æ®ä¿çœŸé¡¹
```

**å‡¸æ¾å¼›ä¿è¯**:
```
åŸMumford-Shahæ¨¡å‹:
  - éå‡¸ä¼˜åŒ–é—®é¢˜
  - å±€éƒ¨æœ€ä¼˜è§£
  - å¯¹åˆå§‹åŒ–æ•æ„Ÿ

å‡¸å˜ä½“ (æœ¬æ–‡):
  - å‡¸ä¼˜åŒ–é—®é¢˜
  - å…¨å±€å”¯ä¸€è§£
  - åˆå§‹åŒ–ç‹¬ç«‹
```

#### Stage 2: Lifting (æå‡)

**åŠ¨æœº**: è§£å†³é¢œè‰²é€šé“é«˜åº¦ç›¸å…³çš„é—®é¢˜

```
é—®é¢˜: RGBä¸‰ä¸ªé€šé“é«˜åº¦ç›¸å…³
     R â‰ˆ G â‰ˆ B æ—¶ï¼Œå•é€šé“ä¿¡æ¯ä¸è¶³

è§£å†³æ–¹æ¡ˆ: å¼•å…¥æ¬¡çº§é¢œè‰²ç©ºé—´
â”œâ”€â”€ åŸå§‹ç©ºé—´: (gÂ¹, gÂ², gÂ³) - RGBå¹³æ»‘ç»“æœ
â”œâ”€â”€ æ¬¡çº§ç©ºé—´: (TÂ¹(g), TÂ²(g), TÂ³(g)) - å˜æ¢ç©ºé—´
â””â”€â”€ ç»„åˆ: 6ç»´å‘é‡å€¼å›¾åƒ

å¸¸ç”¨æ¬¡çº§ç©ºé—´å˜æ¢:
â”œâ”€â”€ å·®åˆ†: gÂ² - gÂ¹, gÂ³ - gÂ²
â”œâ”€â”€ HSI/HSVè½¬æ¢
â”œâ”€â”€ Labè½¬æ¢
â””â”€â”€ è‡ªé€‚åº”çº¿æ€§ç»„åˆ
```

**æ•°å­¦è¡¨è¾¾**:
```
æå‡æ“ä½œ L: RÂ³ â†’ Râ¶

F(x) = L(g(x))
     = (gÂ¹(x), gÂ²(x), gÂ³(x), TÂ¹(g)(x), TÂ²(g)(x), TÂ³(g)(x))

å…¶ä¸­ T^c æ˜¯ç¬¬cä¸ªæ¬¡çº§å˜æ¢
```

#### Stage 3: Thresholding (é˜ˆå€¼)

**å¤šé€šé“æœ€è¿‘é‚»åˆ†ç±»**:
```python
def threshold(F, K):
    """
    å¯¹æå‡åçš„å‘é‡å€¼å›¾åƒè¿›è¡Œé˜ˆå€¼åˆ†å‰²

    å‚æ•°:
        F: æå‡åçš„å‘é‡å€¼å›¾åƒ (HÃ—WÃ—D)
        K: ç›¸ä½æ•° (åˆ†å‰²ç±»åˆ«æ•°)

    è¿”å›:
        u: åˆ†å‰²ç»“æœ (HÃ—W)
    """
    # 1. èšç±»è·å–ç±»åˆ«ä¸­å¿ƒ
    centers = kmeans(F, K)  # (K, D)

    # 2. æœ€è¿‘é‚»åˆ†ç±»
    u = np.zeros(F.shape[:2])
    for i in range(F.shape[0]):
        for j in range(F.shape[1]):
            # æ‰¾åˆ°æœ€è¿‘çš„ä¸­å¿ƒ
            distances = np.linalg.norm(centers - F[i,j], axis=1)
            u[i,j] = np.argmin(distances)

    return u
```

### 3.2 åˆ›æ–°äºŒï¼šçµæ´»çš„ç›¸ä½æ•°è®¾ç½®

```
ä¼ ç»Ÿæ–¹æ³•:
  - ç›¸ä½æ•°Kå¿…é¡»åœ¨ä¼˜åŒ–å‰ç¡®å®š
  - ä¿®æ”¹Kéœ€è¦é‡æ–°è¿è¡Œæ•´ä¸ªç®—æ³•
  - è¯•é”™æˆæœ¬é«˜

SLaTæ–¹æ³•:
  - Stage 1-2 ä¸Kæ— å…³
  - ä»…Stage 3éœ€è¦K
  - ä¿®æ”¹Kåªéœ€é‡æ–°è¿è¡Œé˜ˆå€¼æ­¥éª¤
  - å¿«é€Ÿè¿­ä»£ä¸åŒKå€¼
```

### 3.3 åˆ›æ–°ä¸‰ï¼šé€€åŒ–é²æ£’æ€§

```
é€€åŒ–ç±»å‹        ä¼ ç»Ÿæ–¹æ³•    SLaTæ–¹æ³•
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
é«˜æ–¯å™ªå£°        âœ— æ•ˆæœå·®    âœ“ é²æ£’
æ¨¡ç³Š            âœ— æ•ˆæœå·®    âœ“ é²æ£’
ä¿¡æ¯ä¸¢å¤±        âœ— æ•ˆæœå·®    âœ“ é²æ£’
æ··åˆé€€åŒ–        âœ— æ•ˆæœå·®    âœ“ é²æ£’
```

---

## ğŸ“Š å®éªŒä¸ç»“æœ

### 4.1 å®éªŒè®¾ç½®

#### æ•°æ®é›†

| æ•°æ®é›† | ç±»å‹ | ç”¨é€” |
|:---|:---|:---|
| **åˆæˆå›¾åƒ** | äººå·¥ç”Ÿæˆ | éªŒè¯ç†è®º |
| **è‡ªç„¶å›¾åƒ** | çœŸå®å›¾åƒ | éªŒè¯å®ç”¨æ€§ |
| **é€€åŒ–å›¾åƒ** | å™ªå£°/æ¨¡ç³Š | éªŒè¯é²æ£’æ€§ |

#### å¯¹æ¯”æ–¹æ³•

```
å¯¹æ¯”æ–¹æ³•:
â”œâ”€â”€ Chan-Veseæ¨¡å‹
â”œâ”€â”€ åŸå§‹Mumford-Shah
â”œâ”€â”€ å›¾å‰² (Graph Cut)
â”œâ”€â”€ å±€éƒ¨äºŒå€¼æ‹Ÿåˆ (LBF)
â””â”€â”€ æœ¬æ–‡SLaTæ–¹æ³•
```

### 4.2 ä¸»è¦ç»“æœ

#### åˆ†å‰²è´¨é‡å¯¹æ¯”

| æ–¹æ³• | åˆæˆå›¾åƒ | è‡ªç„¶å›¾åƒ | é€€åŒ–å›¾åƒ |
|:---|:---:|:---:|:---:|
| Chan-Vese | 0.82 | 0.75 | 0.68 |
| Mumford-Shah | 0.85 | 0.78 | 0.71 |
| Graph Cut | 0.87 | 0.81 | 0.74 |
| LBF | 0.88 | 0.82 | 0.73 |
| **SLaT** | **0.92** | **0.86** | **0.81** |

#### è®¡ç®—æ—¶é—´å¯¹æ¯”

| æ–¹æ³• | CPUæ—¶é—´ (ç§’) | ç›¸å¯¹é€Ÿåº¦ |
|:---|:---:|:---:|
| Mumford-Shah | 45.2 | 1.0x |
| Graph Cut | 12.8 | 3.5x |
| **SLaT (Stage1-2)** | 8.5 | 5.3x |
| **SLaT (Stage3, K=4)** | 0.3 | 150x |
| **SLaT (æ€»è®¡)** | **8.8** | **5.1x** |

**å…³é”®å‘ç°**:
- âœ“ åˆ†å‰²è´¨é‡æœ€ä¼˜
- âœ“ è®¡ç®—æ•ˆç‡é«˜
- âœ“ Stage 3éå¸¸å¿«ï¼Œæ”¯æŒå¿«é€Ÿè°ƒæ•´Kå€¼
- âœ“ å¯¹é€€åŒ–å›¾åƒé²æ£’æ€§æœ€å¼º

---

## ğŸ”¬ æ•°å­¦åŸºç¡€

### 5.1 Mumford-Shahæ¨¡å‹å›é¡¾

#### åŸå§‹æ¨¡å‹ (1989)

```
E_MS(u, Î“) = âˆ«_Î©\Î“ |âˆ‡u|Â² dx + Î¼Â·Length(Î“) + Î»âˆ«_Î© (u-f)Â² dx

å…¶ä¸­:
â”œâ”€â”€ u: åˆ†ç‰‡å…‰æ»‘è¿‘ä¼¼å›¾åƒ
â”œâ”€â”€ Î“: è¾¹ç¼˜é›†åˆ
â”œâ”€â”€ f: è¾“å…¥å›¾åƒ
â”œâ”€â”€ ç¬¬ä¸€é¡¹: å…‰æ»‘æ€§çº¦æŸ
â”œâ”€â”€ ç¬¬äºŒé¡¹: è¾¹ç¼˜é•¿åº¦æƒ©ç½š
â””â”€â”€ ç¬¬ä¸‰é¡¹: æ•°æ®ä¿çœŸåº¦

é—®é¢˜: éå‡¸ä¼˜åŒ–ï¼Œéš¾ä»¥æ±‚è§£
```

#### å‡¸æ¾å¼›å˜ä½“

```
E_CV(u) = âˆ«_Î© |âˆ‡u|Â² dx + Î»âˆ«_Î© (u-f)Â² dx

ç®€åŒ–:
â”œâ”€â”€ ç§»é™¤è¾¹ç¼˜å˜é‡Î“
â”œâ”€â”€ åªä¿ç•™u
â”œâ”€â”€ å‡¸ä¼˜åŒ–é—®é¢˜
â””â”€â”€ æœ‰å”¯ä¸€å…¨å±€æœ€ä¼˜è§£
```

### 5.2 å¤šé€šé“æ‰©å±•

#### å‘é‡å€¼Mumford-Shah

```
å¯¹äºå½©è‰²å›¾åƒ f = (fÂ¹, fÂ², fÂ³):

E_MS(u) = Î£_{c=1}^3 [âˆ« |âˆ‡u^c|Â² + Î»âˆ« (u^c - f^c)Â²]

ç­‰ä»·äº:
E_MS(u) = âˆ« ||âˆ‡u||Â² + Î»âˆ« ||u - f||Â²

å…¶ä¸­ ||Â·|| æ˜¯å‘é‡èŒƒæ•°
```

---

## ğŸ’» å¯å¤ç”¨ä»£ç ç»„ä»¶

### ç»„ä»¶1: SLaTå®Œæ•´å®ç°

```python
import numpy as np
from scipy import ndimage
from sklearn.cluster import KMeans

class SLaTSegmentation:
    """
    SLaT (Smoothing, Lifting, Thresholding) ä¸‰é˜¶æ®µåˆ†å‰²
    """

    def __init__(self, lambda_smooth=0.1, n_phases=4):
        """
        å‚æ•°:
            lambda_smooth: å¹³æ»‘å‚æ•°
            n_phases: åˆ†å‰²ç›¸ä½æ•°
        """
        self.lambda_smooth = lambda_smooth
        self.n_phases = n_phases
        self.smoothed = None
        self.lifted = None
        self.centers = None

    def stage1_smoothing(self, f):
        """
        Stage 1: Smoothing - å¯¹æ¯ä¸ªé€šé“åº”ç”¨å¹³æ»‘

        ä½¿ç”¨ç®€åŒ–çš„ROFæ¨¡å‹ (å…¨å˜å·®å¹³æ»‘)
        """
        smoothed = np.zeros_like(f)

        for c in range(f.shape[2]):
            # ä½¿ç”¨å…¨å˜å·®å»å™ª
            smoothed[:,:,c] = self._tv_denoise(f[:,:,c])

        self.smoothed = smoothed
        return smoothed

    def _tv_denoise(self, channel, n_iter=100, dt=0.1):
        """
        å…¨å˜å·®å»å™ª (Chambolleç®—æ³•ç®€åŒ–ç‰ˆ)

        E(u) = âˆ«|âˆ‡u| + Î»/2 âˆ«(u-f)Â²
        """
        u = channel.copy()

        for _ in range(n_iter):
            # è®¡ç®—æ¢¯åº¦
            grad_u = np.gradient(u)

            # è®¡ç®—æ•£åº¦
            div_p = (np.gradient(grad_u[0], axis=0) +
                    np.gradient(grad_u[1], axis=1))

            # æ›´æ–°
            u = u + dt * (div_p + self.lambda_smooth * (channel - u))

        return u

    def stage2_lifting(self, g):
        """
        Stage 2: Lifting - æ„å»ºæå‡çš„å‘é‡å€¼å›¾åƒ

        è¾“å…¥:
            g: å¹³æ»‘åçš„RGBå›¾åƒ (HÃ—WÃ—3)

        è¾“å‡º:
            F: æå‡åçš„å‘é‡å€¼å›¾åƒ (HÃ—WÃ—6)
        """
        h, w, c = g.shape
        F = np.zeros((h, w, 6))

        # åŸå§‹RGB
        F[:,:,:3] = g

        # æ¬¡çº§å˜æ¢: å·®åˆ†å’Œç»„åˆ
        F[:,:,3] = g[:,:,1] - g[:,:,0]  # G - R
        F[:,:,4] = g[:,:,2] - g[:,:,1]  # B - G
        F[:,:,5] = (g[:,:,0] + g[:,:,1] + g[:,:,2]) / 3  # å¹³å‡å€¼

        self.lifted = F
        return F

    def stage3_thresholding(self, F, K=None):
        """
        Stage 3: Thresholding - å¤šé€šé“é˜ˆå€¼åˆ†å‰²

        ä½¿ç”¨K-meansèšç±»è¿›è¡Œåˆ†å‰²
        """
        if K is None:
            K = self.n_phases

        # é‡å¡‘ä¸º (H*W, D)
        h, w, d = F.shape
        F_flat = F.reshape(-1, d)

        # K-meansèšç±»
        kmeans = KMeans(n_clusters=K, random_state=42)
        labels = kmeans.fit_predict(F_flat)

        # ä¿å­˜èšç±»ä¸­å¿ƒ
        self.centers = kmeans.cluster_centers_

        # é‡å¡‘å›å›¾åƒå°ºå¯¸
        segmentation = labels.reshape(h, w)

        return segmentation

    def segment(self, f, K=None):
        """
        å®Œæ•´çš„ä¸‰é˜¶æ®µåˆ†å‰²

        å‚æ•°:
            f: è¾“å…¥RGBå›¾åƒ (HÃ—WÃ—3)
            K: åˆ†å‰²ç›¸ä½æ•° (å¯é€‰)

        è¿”å›:
            segmentation: åˆ†å‰²ç»“æœ (HÃ—W)
        """
        # Stage 1: Smoothing
        g = self.stage1_smoothing(f)
        print(f"Stage 1 (Smoothing) å®Œæˆ")

        # Stage 2: Lifting
        F = self.stage2_lifting(g)
        print(f"Stage 2 (Lifting) å®Œæˆ")

        # Stage 3: Thresholding
        segmentation = self.stage3_thresholding(F, K)
        print(f"Stage 3 (Thresholding) å®Œæˆ, K={K or self.n_phases}")

        return segmentation

    def change_phases(self, new_K):
        """
        å¿«é€Ÿä¿®æ”¹ç›¸ä½æ•° (åªéœ€é‡æ–°è¿è¡ŒStage 3)
        """
        if self.lifted is None:
            raise ValueError("è¯·å…ˆè¿è¡Œsegment()æ–¹æ³•")

        return self.stage3_thresholding(self.lifted, new_K)
```

### ç»„ä»¶2: é«˜çº§æå‡å˜æ¢

```python
class AdvancedLifting:
    """
    é«˜çº§æå‡å˜æ¢ç­–ç•¥
    """

    @staticmethod
    def color_space_lifting(g, target_space='HSV'):
        """
        åŸºäºé¢œè‰²ç©ºé—´è½¬æ¢çš„æå‡
        """
        from skimage.color import rgb2hsv, rgb2lab

        h, w = g.shape[:2]
        F = np.zeros((h, w, 6))

        if target_space == 'HSV':
            # RGB + HSV
            F[:,:,:3] = g
            F[:,:,3:6] = rgb2hsv(g)

        elif target_space == 'Lab':
            # RGB + Lab
            F[:,:,:3] = g
            F[:,:,3:6] = rgb2lab(g)

        return F

    @staticmethod
    def gradient_lifting(g):
        """
        åŸºäºæ¢¯åº¦çš„æå‡
        """
        h, w = g.shape[:2]
        F = np.zeros((h, w, 6))

        F[:,:,:3] = g

        # è®¡ç®—æ¢¯åº¦
        for c in range(3):
            grad_x = np.gradient(g[:,:,c], axis=1)
            grad_y = np.gradient(g[:,:,c], axis=0)
            grad_mag = np.sqrt(grad_x**2 + grad_y**2)

            if c == 0:
                F[:,:,3] = grad_mag
            elif c == 1:
                F[:,:,4] = grad_mag
            else:
                F[:,:,5] = grad_mag

        return F

    @staticmethod
    def multi_scale_lifting(g, scales=[1, 2, 4]):
        """
        å¤šå°ºåº¦æå‡
        """
        from skimage.transform import resize

        h, w = g.shape[:2]
        F = []

        # åŸå§‹å°ºåº¦
        F.append(g)

        # å¤šå°ºåº¦
        for scale in scales:
            # ä¸‹é‡‡æ ·
            g_small = resize(g, (h//scale, w//scale), anti_aliasing=True)
            # ä¸Šé‡‡æ ·å›åŸå°ºå¯¸
            g_upscaled = resize(g_small, (h, w), order=0)
            F.append(g_upscaled)

        return np.concatenate(F, axis=2)
```

### ç»„ä»¶3: ä½¿ç”¨ç¤ºä¾‹

```python
# ä½¿ç”¨ç¤ºä¾‹
def example_usage():
    """
    SLaTæ–¹æ³•ä½¿ç”¨ç¤ºä¾‹
    """
    import cv2

    # è¯»å–å›¾åƒ
    image = cv2.imread('degraded_image.jpg')
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB) / 255.0

    # åˆ›å»ºSLaTåˆ†å‰²å™¨
    segmenter = SLaTSegmentation(lambda_smooth=0.1, n_phases=4)

    # æ‰§è¡Œåˆ†å‰²
    result = segmenter.segment(image, K=4)

    # å¯è§†åŒ–
    import matplotlib.pyplot as plt
    plt.imshow(result, cmap='jet')
    plt.title('SLaT Segmentation (K=4)')
    plt.show()

    # å¿«é€Ÿå°è¯•ä¸åŒçš„Kå€¼
    for K in [2, 3, 5, 6]:
        result_new = segmenter.change_phases(K)
        plt.imshow(result_new, cmap='jet')
        plt.title(f'SLaT Segmentation (K={K})')
        plt.show()

# æ·»åŠ å™ªå£°çš„ç¤ºä¾‹
def add_noise_and_segment():
    """
    æ·»åŠ å™ªå£°ååˆ†å‰²ï¼Œå±•ç¤ºé²æ£’æ€§
    """
    import cv2

    image = cv2.imread('clean_image.jpg')
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB) / 255.0

    # æ·»åŠ é«˜æ–¯å™ªå£°
    noisy = image + np.random.normal(0, 0.1, image.shape)
    noisy = np.clip(noisy, 0, 1)

    # åˆ†å‰²
    segmenter = SLaTSegmentation(lambda_smooth=0.2)
    result = segmenter.segment(noisy)

    return result
```

---

## ğŸ”— ä¸å…¶ä»–å·¥ä½œçš„å…³ç³»

### 6.1 Xiaohao Caiç ”ç©¶è„‰ç»œ

```
å˜åˆ†æ³•æ–¹æ³•æ¼”è¿›:

[1-04] å˜åˆ†æ³•åŸºç¡€ (Mumford-Shahä¸ROF)
    â†“ ç†è®ºåŸºç¡€
    â†“
[2-01] å‡¸ä¼˜åŒ–åˆ†å‰²
    â†“ å‡¸æ¾å¼›æŠ€æœ¯
    â†“
[2-03] SLaTä¸‰é˜¶æ®µ â† æœ¬ç¯‡
    â†“ ä¸‰é˜¶æ®µè®¾è®¡æ¨¡å¼
    â†“
[2-05] è¯­ä¹‰æ¯”ä¾‹åˆ†å‰²
    â†“ æ‰©å±•åº”ç”¨
```

### 6.2 ä¸æ ¸å¿ƒè®ºæ–‡çš„å…³ç³»

| è®ºæ–‡ | å…³ç³» | è¯´æ˜ |
|:---|:---|:---|
| [1-04] å˜åˆ†æ³•åŸºç¡€ | **ç†è®ºåŸºçŸ³** | Mumford-Shahæ¨¡å‹åŸºç¡€ |
| [2-01] å‡¸ä¼˜åŒ–åˆ†å‰² | **æ–¹æ³•å…³è”** | éƒ½ä½¿ç”¨å‡¸æ¾å¼›æŠ€æœ¯ |
| [2-05] è¯­ä¹‰æ¯”ä¾‹åˆ†å‰² | **æ–¹æ³•å»¶ä¼¸** | éƒ½å¤„ç†å¤šé€šé“é—®é¢˜ |
| [2-12] Neural Varifolds | **èŒƒå¼å¯¹æ¯”** | ä¼ ç»Ÿ vs ç¥ç»æ–¹æ³• |

### 6.3 åœ¨SaTæ–¹æ³•è®ºä¸­çš„ä½ç½®

```
SaTæ–¹æ³•è®ºæ¡†æ¶:

ç†è®ºåŸºç¡€å±‚
â”œâ”€â”€ [1-04] å˜åˆ†æ³•åŸºç¡€
â””â”€â”€ [2-01] å‡¸ä¼˜åŒ–åˆ†å‰²

æ–¹æ³•åˆ›æ–°å±‚
â”œâ”€â”€ [2-03] SLaTä¸‰é˜¶æ®µ â† æœ¬ç¯‡
â”œâ”€â”€ [2-05] è¯­ä¹‰æ¯”ä¾‹åˆ†å‰²
â””â”€â”€ [2-09] æ¡†æ¶åˆ†å‰²

åº”ç”¨æ‹“å±•å±‚
â”œâ”€â”€ [2-15] 3Dæ ‘æœ¨åˆ†å‰²
â”œâ”€â”€ [2-20] æ”¾ç–—ç›´è‚ åˆ†å‰²
â””â”€â”€ [2-29] ä¸­å¿ƒä½“åˆ†å‰²ç½‘ç»œ
```

---

## ğŸ“ ä¸ªäººæ€è€ƒä¸æ€»ç»“

### 7.1 æ ¸å¿ƒæ”¶è·

#### æ”¶è·1: åˆ†è€Œæ²»ä¹‹çš„è®¾è®¡æ™ºæ…§

```
ä¸‰é˜¶æ®µè®¾è®¡çš„å¯ç¤º:
â”œâ”€â”€ å¤æ‚é—®é¢˜åˆ†è§£ä¸ºç®€å•å­é—®é¢˜
â”œâ”€â”€ æ¯ä¸ªé˜¶æ®µä¸“æ³¨å•ä¸€ç›®æ ‡
â”œâ”€â”€ é˜¶æ®µé—´è§£è€¦æé«˜çµæ´»æ€§
â””â”€â”€ æ•´ä½“æ€§èƒ½ä¼˜äºå•é˜¶æ®µæ–¹æ³•
```

#### æ”¶è·2: å‡¸ä¼˜åŒ–çš„ä»·å€¼

```
å‡¸ä¼˜åŒ– vs éå‡¸ä¼˜åŒ–:
â”œâ”€â”€ å”¯ä¸€å…¨å±€æœ€ä¼˜è§£
â”œâ”€â”€ ä¸ä¾èµ–åˆå§‹åŒ–
â”œâ”€â”€ æ”¶æ•›æ€§æœ‰ä¿è¯
â””â”€â”€ ç®—æ³•è®¾è®¡æ›´ç®€å•
```

#### æ”¶è·3: æå‡æ“ä½œçš„å·§å¦™

```
ä¸ºä»€ä¹ˆéœ€è¦æå‡:
â”œâ”€â”€ è¡¥å……ä¿¡æ¯
â”œâ”€â”€ è§£é™¤ç›¸å…³æ€§
â”œâ”€â”€ å¢å¼ºåˆ¤åˆ«æ€§
â””â”€â”€ æé«˜åˆ†å‰²è´¨é‡
```

### 7.2 æ–¹æ³•è®ºä»·å€¼

| ä»·å€¼ç»´åº¦ | è¯´æ˜ |
|:---|:---|
| **ç†è®º** | å‡¸æ¾å¼›ç†è®ºçš„åº”ç”¨å…¸èŒƒ |
| **æ–¹æ³•** | ä¸‰é˜¶æ®µè®¾è®¡æ¨¡å¼å¯æ¨å¹¿ |
| **åº”ç”¨** | é€€åŒ–å›¾åƒå¤„ç†çš„æœ‰æ•ˆå·¥å…· |
| **å·¥ç¨‹** | æ¨¡å—åŒ–å®ç°ï¼Œæ˜“äºç»´æŠ¤ |

### 7.3 å±€é™æ€§ä¸æ”¹è¿›æ–¹å‘

| å±€é™ | æ”¹è¿›æ–¹å‘ |
|:---|:---|
| **æ‰‹å·¥æå‡å˜æ¢** | å­¦ä¹ æœ€ä¼˜æå‡å˜æ¢ |
| **å‚æ•°Î»éœ€è°ƒä¼˜** | è‡ªé€‚åº”å‚æ•°é€‰æ‹© |
| **è®¡ç®—æ•ˆç‡** | å¹¶è¡ŒåŠ é€Ÿ |
| **ä»…å¤„ç†é¢œè‰²** | æ‰©å±•åˆ°çº¹ç†+æ·±åº¦ |

---

## ğŸ¯ å®è·µæŒ‡å¯¼

### 8.1 å‚æ•°é€‰æ‹©æŒ‡å—

#### Î»å‚æ•°

```python
def choose_lambda(noise_level):
    """
    æ ¹æ®å™ªå£°æ°´å¹³é€‰æ‹©Î»

    å™ªå£°è¶Šé«˜ â†’ Î»è¶Šå¤§ (æ›´å¼ºå¹³æ»‘)
    """
    if noise_level == 'low':
        return 0.05
    elif noise_level == 'medium':
        return 0.1
    elif noise_level == 'high':
        return 0.2
    else:
        return 0.1  # é»˜è®¤å€¼
```

#### Kå€¼é€‰æ‹©

```python
def choose_K(image_complexity):
    """
    æ ¹æ®å›¾åƒå¤æ‚åº¦é€‰æ‹©ç›¸ä½æ•°K
    """
    if image_complexity == 'simple':
        return 2  # äºŒå€¼åˆ†å‰²
    elif image_complexity == 'medium':
        return 4  # å››ç›¸ä½
    elif image_complexity == 'complex':
        return 6  # å…­ç›¸ä½
    else:
        return 4  # é»˜è®¤å€¼
```

### 8.2 è°ƒè¯•æŠ€å·§

```python
def visualize_stages(segmenter, image):
    """
    å¯è§†åŒ–æ¯ä¸ªé˜¶æ®µçš„ç»“æœ
    """
    import matplotlib.pyplot as plt

    fig, axes = plt.subplots(1, 4, figsize=(16, 4))

    # åŸå›¾
    axes[0].imshow(image)
    axes[0].set_title('Input')

    # Stage 1
    axes[1].imshow(segmenter.smoothed)
    axes[1].set_title('Stage 1: Smoothed')

    # Stage 2 (å¯è§†åŒ–å‰3ç»´)
    axes[2].imshow(segmenter.lifted[:,:,:3])
    axes[2].set_title('Stage 2: Lifted (RGB)')

    # Stage 3
    axes[3].imshow(segmenter.segment(image), cmap='jet')
    axes[3].set_title('Stage 3: Segmentation')

    plt.show()
```

---

## ğŸ”— ç›¸å…³è®ºæ–‡æ¨è

### å¿…è¯»å…³è”è®ºæ–‡

1. **[1-04] å˜åˆ†æ³•åŸºç¡€ Mumford-Shahä¸ROF** - ç†è®ºåŸºç¡€
2. **[2-01] å‡¸ä¼˜åŒ–åˆ†å‰² Convex Mumford-Shah** - å‡¸æ¾å¼›æŠ€æœ¯
3. **[2-05] è¯­ä¹‰æ¯”ä¾‹åˆ†å‰² Semantic Proportions** - å¤šé€šé“åˆ†å‰²

### å»¶ä¼¸é˜…è¯»

1. **Chan & Vese (2001)** - æ´»åŠ¨è½®å»“æ¨¡å‹
2. **Bresson et al. (2007)** - å…¨å˜å·®å½©è‰²å›¾åƒå¤„ç†
3. **Goldstein et al. (2009)** - Split Bregmanç®—æ³•

---

## âœ… ç²¾è¯»æ£€æŸ¥æ¸…å•

### ç†è§£ç¨‹åº¦è‡ªè¯„

- [x] **æ¡†æ¶ç†è§£**: ä¸‰é˜¶æ®µè®¾è®¡çš„æ ¸å¿ƒæ€æƒ³
- [x] **æ•°å­¦åŸºç¡€**: Mumford-Shahæ¨¡å‹å’Œå‡¸æ¾å¼›
- [x] **ä»£ç å®ç°**: èƒ½å¤Ÿå®ç°SLaTæ–¹æ³•
- [x] **å‚æ•°è°ƒä¼˜**: ç†è§£Î»å’ŒKçš„é€‰æ‹©
- [x] **åº”ç”¨è¿ç§»**: èƒ½åº”ç”¨åˆ°ç±»ä¼¼é—®é¢˜

### å…³é”®é—®é¢˜

1. **ä¸ºä»€ä¹ˆéœ€è¦ä¸‰é˜¶æ®µï¼Ÿ**
   - åˆ†ç¦»å…³æ³¨ç‚¹
   - æé«˜çµæ´»æ€§
   - å¢å¼ºé²æ£’æ€§

2. **æå‡æ“ä½œçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ**
   - è¡¥å……ä¿¡æ¯
   - è§£é™¤ç›¸å…³æ€§
   - å¢å¼ºåˆ¤åˆ«æ€§

3. **å¦‚ä½•é€‰æ‹©å‚æ•°Î»å’ŒKï¼Ÿ**
   - Î»: æ ¹æ®å™ªå£°æ°´å¹³
   - K: æ ¹æ®å›¾åƒå¤æ‚åº¦
   - æ”¯æŒå¿«é€Ÿè¿­ä»£è°ƒæ•´

---

**ç²¾è¯»å®Œæˆæ—¶é—´**: 2026å¹´2æœˆ9æ—¥
**è®ºæ–‡ç±»å‹**: æ–¹æ³•åˆ›æ–°
**åç»­è·Ÿè¿›**: [2-05] è¯­ä¹‰æ¯”ä¾‹åˆ†å‰²

---

*æœ¬ç²¾è¯»ç¬”è®°åŸºäºXiaohao Caiç­‰äººçš„Journal of Scientific Computing 2017è®ºæ–‡*
*é‡ç‚¹å…³æ³¨: SLaTä¸‰é˜¶æ®µæ¡†æ¶ã€å‡¸æ¾å¼›æŠ€æœ¯ã€é€€åŒ–å›¾åƒå¤„ç†*
