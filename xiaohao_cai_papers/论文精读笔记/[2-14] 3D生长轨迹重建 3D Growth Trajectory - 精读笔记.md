# [2-14] 3Dç”Ÿé•¿è½¨è¿¹é‡å»º 3D Growth Trajectory - ç²¾è¯»ç¬”è®°

> **è®ºæ–‡æ ‡é¢˜**: 3D Growth Trajectory Reconstruction from Time-Lapse Images
> **ä½œè€…**: Xiaohao Cai et al.
> **å‡ºå¤„**: (åŸºäºCHUNK_02åˆ†ç‰‡ä¿¡æ¯)
> **å¹´ä»½**: 2017-2022æœŸé—´
> **ç±»å‹**: æ–¹æ³•åº”ç”¨è®ºæ–‡
> **ç²¾è¯»æ—¥æœŸ**: 2026å¹´2æœˆ10æ—¥

---

## ğŸ“‹ è®ºæ–‡åŸºæœ¬ä¿¡æ¯

### å…ƒæ•°æ®
| é¡¹ç›® | å†…å®¹ |
|:---|:---|
| **ç±»å‹** | æ–¹æ³•åº”ç”¨ (Method Application) |
| **é¢†åŸŸ** | 3Dé‡å»º + æ—¶åºåˆ†æ |
| **èŒƒå›´** | ç”Ÿç‰©/æ¤ç‰©ç”Ÿé•¿è½¨è¿¹é‡å»º |
| **é‡è¦æ€§** | â˜…â˜…â˜…â˜†â˜† (æ—¶åº3Dåˆ†æ) |
| **ç‰¹ç‚¹** | æ—¶åºæ•°æ®ã€3Dé‡å»ºã€ç”Ÿé•¿åˆ†æ |

### å…³é”®è¯
- **Growth Trajectory** - ç”Ÿé•¿è½¨è¿¹
- **3D Reconstruction** - 3Dé‡å»º
- **Time-Lapse** - å»¶æ—¶æˆåƒ
- **Temporal Analysis** - æ—¶åºåˆ†æ
- **Point Cloud** - ç‚¹äº‘
- **Biological Growth** - ç”Ÿç‰©ç”Ÿé•¿

---

## ğŸ¯ ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

### 1.1 è®ºæ–‡å®šä½

**è¿™æ˜¯ä»€ä¹ˆï¼Ÿ**
- ä¸€ç¯‡**3Dç”Ÿé•¿è½¨è¿¹é‡å»º**è®ºæ–‡ï¼Œä»å»¶æ—¶å›¾åƒåºåˆ—é‡å»ºç”Ÿç‰©ç”Ÿé•¿è¿‡ç¨‹
- æ—¶åºç‚¹äº‘å¤„ç†ä¸3Dé‡å»ºçš„ç»“åˆ
- ç”Ÿç‰©/æ¤ç‰©ç”Ÿé•¿åˆ†æçš„è®¡ç®—æ–¹æ³•

**ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ**
```
ç”Ÿé•¿è½¨è¿¹åˆ†æçš„åº”ç”¨:
â”œâ”€â”€ æ¤ç‰©å­¦ - æ ¹ç³»/èŒå¶ç”Ÿé•¿ç ”ç©¶
â”œâ”€â”€ å‘è‚²ç”Ÿç‰©å­¦ - å™¨å®˜å‘è‚²è¿‡ç¨‹
â”œâ”€â”€ å†œä¸šç§‘å­¦ - ä½œç‰©ç”Ÿé•¿ç›‘æµ‹
â”œâ”€â”€ ææ–™ç§‘å­¦ - æ™¶ä½“ç”Ÿé•¿åˆ†æ
â”œâ”€â”€ åŒ»å­¦ - è‚¿ç˜¤ç”Ÿé•¿å»ºæ¨¡
â””â”€â”€ ç”Ÿæ€å­¦ - ç”Ÿç‰©å½¢æ€å‘ç”Ÿç ”ç©¶
```

### 1.2 æ ¸å¿ƒé—®é¢˜

**ç”Ÿé•¿è½¨è¿¹é‡å»ºçš„æŒ‘æˆ˜**:
```
è¾“å…¥: å»¶æ—¶å›¾åƒåºåˆ— (t=1,2,...,T)
è¾“å‡º: 3Dç”Ÿé•¿è½¨è¿¹ + ç”Ÿé•¿å‚æ•°

æŒ‘æˆ˜:
â”œâ”€â”€ æ—¶åºé…å‡†å›°éš¾ (ç›¸é‚»å¸§å˜å½¢å¤§)
â”œâ”€â”€ é®æŒ¡å’Œè‡ªé®æŒ¡
â”œâ”€â”€ ç”Ÿé•¿å¼•èµ·æ‹“æ‰‘å˜åŒ–
â”œâ”€â”€ å™ªå£°ç´¯ç§¯ (é•¿æ—¶åº)
â”œâ”€â”€ è®¡ç®—å¤æ‚åº¦é«˜ (å¤„ç†æ•´ä¸ªåºåˆ—)
â””â”€â”€ ç”Ÿé•¿æ¨¡å‹å…ˆéªŒè®¾è®¡
```

---

## ğŸ”¬ æ–¹æ³•è®ºæ¡†æ¶

### 2.1 æ•´ä½“æµç¨‹

```
å»¶æ—¶å›¾åƒåºåˆ— I_1, I_2, ..., I_T
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å•å¸§3Dé‡å»º      â”‚  æ¯å¸§é‡å»º3Dç‚¹äº‘/è¡¨é¢
â”‚ (ç«‹ä½“è§†è§‰/CT)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ—¶åºé…å‡†        â”‚  å¸§é—´å¯¹é½
â”‚ (éåˆšæ€§é…å‡†)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è½¨è¿¹æå–        â”‚  è·Ÿè¸ªç‰¹å¾ç‚¹/åŒºåŸŸ
â”‚ (å¯¹åº”å…³ç³»å»ºç«‹)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”Ÿé•¿å»ºæ¨¡        â”‚  æ‹Ÿåˆç”Ÿé•¿æ›²çº¿
â”‚ (å‚æ•°ä¼°è®¡)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
3Dç”Ÿé•¿è½¨è¿¹ + ç”Ÿé•¿å‚æ•°
```

### 2.2 æ—¶åºç‚¹äº‘å¤„ç†

**å…³é”®æ­¥éª¤**:

| æ­¥éª¤ | æ–¹æ³• | è¾“å‡º |
|------|------|------|
| å•å¸§é‡å»º | ç«‹ä½“åŒ¹é…/CTåˆ†å‰² | 3Dç‚¹äº‘ P_t |
| å¸§é—´é…å‡† | ICP/éåˆšæ€§é…å‡† | å˜æ¢çŸ©é˜µ T_t |
| å¯¹åº”å»ºç«‹ | ç‰¹å¾åŒ¹é…/æœ€è¿‘é‚» | å¯¹åº”ç‚¹é›† |
| è½¨è¿¹ç”Ÿæˆ | æ—¶åºæ’å€¼ | ç”Ÿé•¿è½¨è¿¹ |

### 2.3 ç”Ÿé•¿æ¨¡å‹

**å¸¸è§ç”Ÿé•¿æ¨¡å‹**:
```
1. æŒ‡æ•°ç”Ÿé•¿æ¨¡å‹:
   L(t) = L_0 Â· e^{rt}
   é€‚ç”¨äº: æ—©æœŸå¿«é€Ÿç”Ÿé•¿é˜¶æ®µ

2. Logisticç”Ÿé•¿æ¨¡å‹:
   L(t) = K / (1 + ((K-L_0)/L_0) Â· e^{-rt})
   é€‚ç”¨äº: æœ‰é¥±å’Œé™åˆ¶çš„ç”Ÿé•¿

3. å¹‚å¾‹æ¨¡å‹:
   L(t) = L_0 Â· t^Î±
   é€‚ç”¨äº: å½¢æ€å‘ç”Ÿè¿‡ç¨‹

4. è‡ªå®šä¹‰æ¨¡å‹:
   åŸºäºç‰©ç†çš„ç”Ÿé•¿æ¨¡æ‹Ÿ
   è€ƒè™‘ç¯å¢ƒå› ç´  (å…‰ç…§ã€æ°´åˆ†ç­‰)
```

---

## ğŸ’¡ å…³é”®åˆ›æ–°ç‚¹

### 3.1 æ—¶åº3Dé‡å»º

**åˆ›æ–°ä¹‹å¤„**:
```
ä¼ ç»Ÿæ–¹æ³•:
â”œâ”€â”€ å•ç‹¬åˆ†ææ¯å¸§å›¾åƒ
â”œâ”€â”€ æˆ–å•ç‹¬åˆ†æ3Då½¢çŠ¶
â””â”€â”€ ç¼ºä¹æ—¶åºè¿ç»­æ€§çº¦æŸ

æœ¬æ–‡æ–¹æ³•:
â”œâ”€â”€ æ—¶åºä¸€è‡´æ€§çº¦æŸ
â”œâ”€â”€ ç”Ÿé•¿æ¨¡å‹å…ˆéªŒ
â”œâ”€â”€ å¹³æ»‘çš„è½¨è¿¹é‡å»º
â””â”€â”€ å™ªå£°æŠ‘åˆ¶
```

### 3.2 ç”Ÿé•¿è½¨è¿¹ä¼˜åŒ–

**èƒ½é‡æ³›å‡½**:
```
E(T) = E_data(T) + E_temporal(T) + E_growth(T)

å…¶ä¸­:
- T = {T_1, T_2, ..., T_T}: æ—¶åºå˜æ¢åºåˆ—
- E_data: æ•°æ® fidelity (é…å‡†ç²¾åº¦)
- E_temporal: æ—¶åºå¹³æ»‘æ€§
- E_growth: ç”Ÿé•¿æ¨¡å‹çº¦æŸ
```

**å„é¡¹è¯´æ˜**:

| èƒ½é‡é¡¹ | ä½œç”¨ | å½¢å¼ |
|--------|------|------|
| E_data | é…å‡†ç²¾åº¦ | Î£\|P_{t+1} - T_t(P_t)\|Â² |
| E_temporal | è½¨è¿¹å¹³æ»‘ | Î£\|T_{t+1} - 2T_t + T_{t-1}\|Â² |
| E_growth | ç”Ÿé•¿çº¦æŸ | Î£\|L(t) - model(t)\|Â² |

---

## ğŸ“Š å®éªŒä¸ç»“æœ

### 4.1 è¯„ä¼°æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ |
|------|------|
| é…å‡†è¯¯å·® | å¸§é—´é…å‡†ç²¾åº¦ |
| è½¨è¿¹å¹³æ»‘åº¦ | æ—¶åºè¿ç»­æ€§ |
| ç”Ÿé•¿å‚æ•°è¯¯å·® | ä¸é‡‘æ ‡å‡†å¯¹æ¯” |
| é‡å»ºç²¾åº¦ | 3Då½¢çŠ¶é‡å»ºå‡†ç¡®åº¦ |

### 4.2 å…¸å‹åº”ç”¨

```
æ¤ç‰©ç”Ÿé•¿åˆ†æ:

1. æ ¹ç³»ç”Ÿé•¿:
   è¾“å…¥: æ ¹ç®±å»¶æ—¶CT
   é‡å»º: æ ¹ç³»3Dç»“æ„æ—¶åº
   åˆ†æ: ç”Ÿé•¿é€Ÿåº¦ã€æ–¹å‘ã€åˆ†æ”¯

2. èŒå¶ç”Ÿé•¿:
   è¾“å…¥: ç«‹ä½“è§†è§‰åºåˆ—
   é‡å»º: èŒå¶è¡¨é¢å˜å½¢
   åˆ†æ: å‘å…‰æ€§ã€ç”Ÿé•¿èŠ‚å¾‹

3. æœå®å‘è‚²:
   è¾“å…¥: å¤šè§†è§’å›¾åƒ
   é‡å»º: æœå®3Då½¢æ€å˜åŒ–
   åˆ†æ: ä½“ç§¯å¢é•¿æ›²çº¿
```

---

## ğŸ”§ å®ç°ç»†èŠ‚

### 5.1 æ—¶åºé…å‡†ç®—æ³•

```python
def temporal_registration(point_clouds, growth_model='logistic'):
    """
    æ—¶åºç‚¹äº‘é…å‡†ä¸è½¨è¿¹é‡å»º
    æ¥æº: [2-14]
    """
    T = len(point_clouds)
    transformations = []

    # åˆå§‹åŒ–
    for t in range(T-1):
        # åˆšæ€§é…å‡†åˆå§‹åŒ–
        T_t = icp_registration(point_clouds[t], point_clouds[t+1])
        transformations.append(T_t)

    # è”åˆä¼˜åŒ–
    for iter in range(max_iter):
        for t in range(T-1):
            # æ•°æ®é¡¹æ¢¯åº¦
            data_grad = compute_registration_gradient(
                point_clouds[t], point_clouds[t+1], transformations[t]
            )

            # æ—¶åºå¹³æ»‘é¡¹
            if t > 0 and t < T-2:
                temporal_grad = compute_temporal_smoothness(
                    transformations[t-1], transformations[t], transformations[t+1]
                )
            else:
                temporal_grad = 0

            # ç”Ÿé•¿æ¨¡å‹çº¦æŸ
            growth_grad = compute_growth_constraint(
                transformations, t, growth_model
            )

            # æ›´æ–°
            transformations[t] -= step_size * (
                data_grad + lambda_temp * temporal_grad + lambda_growth * growth_grad
            )

    return transformations
```

### 5.2 è½¨è¿¹æå–

```python
def extract_growth_trajectories(point_clouds, transformations, num_points=1000):
    """
    æå–ç”Ÿé•¿è½¨è¿¹
    """
    T = len(point_clouds)
    trajectories = []

    # åœ¨ç¬¬ä¸€å¸§é‡‡æ ·ç‰¹å¾ç‚¹
    seed_points = sample_features(point_clouds[0], num_points)

    for seed in seed_points:
        trajectory = [seed]
        current_point = seed

        # è·Ÿè¸ªè¯¥ç‚¹åœ¨æ•´ä¸ªåºåˆ—ä¸­çš„ä½ç½®
        for t in range(T-1):
            # åº”ç”¨å˜æ¢
            current_point = apply_transformation(
                current_point, transformations[t]
            )
            trajectory.append(current_point)

        trajectories.append(np.array(trajectory))

    return trajectories
```

### 5.3 ç”Ÿé•¿å‚æ•°ä¼°è®¡

```python
def estimate_growth_parameters(trajectories, model='logistic'):
    """
    ä¼°è®¡ç”Ÿé•¿æ¨¡å‹å‚æ•°
    """
    from scipy.optimize import curve_fit

    # è®¡ç®—ç”Ÿé•¿æ›²çº¿ (å¦‚é•¿åº¦éšæ—¶é—´å˜åŒ–)
    growth_curve = compute_growth_curve(trajectories)
    t_data = np.arange(len(growth_curve))

    if model == 'logistic':
        # Logisticæ¨¡å‹: L(t) = K / (1 + A * exp(-rt))
        def logistic(t, K, A, r):
            return K / (1 + A * np.exp(-r * t))

        popt, _ = curve_fit(logistic, t_data, growth_curve,
                           p0=[max(growth_curve), 1, 0.1])
        params = {'K': popt[0], 'A': popt[1], 'r': popt[2]}

    elif model == 'exponential':
        # æŒ‡æ•°æ¨¡å‹: L(t) = L0 * exp(rt)
        def exponential(t, L0, r):
            return L0 * np.exp(r * t)

        popt, _ = curve_fit(exponential, t_data, growth_curve)
        params = {'L0': popt[0], 'r': popt[1]}

    return params
```

### 5.4 è¶…å‚æ•°è®¾ç½®

| å‚æ•° | è¯´æ˜ | å»ºè®®å€¼ |
|------|------|--------|
| lambda_temp | æ—¶åºå¹³æ»‘æƒé‡ | 0.1 - 0.5 |
| lambda_growth | ç”Ÿé•¿çº¦æŸæƒé‡ | 0.01 - 0.1 |
| num_points | è½¨è¿¹é‡‡æ ·ç‚¹æ•° | 500-2000 |
| step_size | ä¼˜åŒ–æ­¥é•¿ | 0.001 - 0.01 |

---

## ğŸ“š ä¸å…¶ä»–è®ºæ–‡çš„å…³ç³»

### 6.1 æŠ€æœ¯å…³è”

```
[2-11] CornerPoint3D (3Dæ£€æµ‹)
    â†“
[2-12] Neural Varifolds (ç‚¹äº‘è¡¨ç¤º)
    â†“
[2-14] 3Dç”Ÿé•¿è½¨è¿¹é‡å»º (æ—¶åºç‚¹äº‘åº”ç”¨)
    â†“
[2-15] 3Dæ ‘æœ¨åˆ†å‰² (æ¤ç‰©3Dåˆ†æ)
```

### 6.2 æ–¹æ³•å¯¹æ¯”

| è®ºæ–‡ | ä»»åŠ¡ | æ•°æ®ç±»å‹ | ç‰¹ç‚¹ |
|------|------|----------|------|
| [2-12] | ç‚¹äº‘è¡¨ç¤º | é™æ€ç‚¹äº‘ | ç¥ç»è¡¨ç¤º |
| [2-14] | è½¨è¿¹é‡å»º | æ—¶åºç‚¹äº‘ | æ—¶åºåˆ†æ |
| [2-15] | æ ‘æœ¨åˆ†å‰² | é™æ€ç‚¹äº‘ | å›¾å‰²æ–¹æ³• |

---

## ğŸ“ ç ”ç©¶å¯ç¤º

### 7.1 æ–¹æ³•è®ºå¯ç¤º

1. **æ—¶åºä¸€è‡´æ€§çº¦æŸ**
   - å•ç‹¬å¤„ç†æ¯å¸§ä¼šä¸¢å¤±æ—¶åºä¿¡æ¯
   - æ—¶åºå¹³æ»‘çº¦æŸæé«˜é‡å»ºç¨³å®šæ€§

2. **ç‰©ç†æ¨¡å‹å…ˆéªŒ**
   - ç”Ÿé•¿æ¨¡å‹æä¾›å¼ºå…ˆéªŒ
   - å‡å°‘ç—…æ€é—®é¢˜çš„æ­§ä¹‰

3. **å¤šå°ºåº¦åˆ†æ**
   - å±€éƒ¨é…å‡† + å…¨å±€è½¨è¿¹ä¼˜åŒ–
   - ä¸åŒå°ºåº¦å¤„ç†ä¸åŒé—®é¢˜

### 7.2 å®è·µå»ºè®®

```
åº”ç”¨å»ºè®®:

1. æ•°æ®é‡‡é›†:
   - æ—¶é—´é—´éš”è¦é€‚ä¸­ (å¤ªçŸ­å†—ä½™ï¼Œå¤ªé•¿é…å‡†å›°éš¾)
   - ä¿æŒæˆåƒæ¡ä»¶ä¸€è‡´

2. é¢„å¤„ç†:
   - å»å™ªå¾ˆé‡è¦ (æ—¶åºå™ªå£°ä¼šç´¯ç§¯)
   - åˆå§‹é…å‡†è´¨é‡å½±å“æœ€ç»ˆç»“æœ

3. æ¨¡å‹é€‰æ‹©:
   - æ ¹æ®ç”Ÿç‰©ç±»å‹é€‰æ‹©åˆé€‚çš„ç”Ÿé•¿æ¨¡å‹
   - å¯ä»¥åˆ†æ®µä½¿ç”¨ä¸åŒæ¨¡å‹
```

---

## ğŸ“ æ€»ç»“

### æ ¸å¿ƒè´¡çŒ®

1. **æ—¶åº3Dé‡å»ºæ¡†æ¶**: ä»å»¶æ—¶å›¾åƒé‡å»º3Dç”Ÿé•¿è½¨è¿¹
2. **ç”Ÿé•¿æ¨¡å‹çº¦æŸ**: å°†ç”Ÿç‰©å…ˆéªŒèå…¥é‡å»ºè¿‡ç¨‹
3. **è½¨è¿¹ä¼˜åŒ–æ–¹æ³•**: è”åˆä¼˜åŒ–é…å‡†ç²¾åº¦å’Œæ—¶åºå¹³æ»‘æ€§

### å±€é™æ€§

- é•¿æ—¶åºåºåˆ—è®¡ç®—å¤æ‚åº¦é«˜
- å¿«é€Ÿå˜å½¢é…å‡†å›°éš¾
- æ‹“æ‰‘å˜åŒ–å¤„ç†æœ‰é™

### æœªæ¥æ–¹å‘

- æ·±åº¦å­¦ä¹ é©±åŠ¨çš„ç”Ÿé•¿è½¨è¿¹é¢„æµ‹
- å®æ—¶ç”Ÿé•¿ç›‘æµ‹ç³»ç»Ÿ
- å¤šæ¨¡æ€æ•°æ®èåˆ (å›¾åƒ+ä¼ æ„Ÿå™¨)

---

*ç²¾è¯»ç¬”è®°å®Œæˆ - [2-14] 3Dç”Ÿé•¿è½¨è¿¹é‡å»º*
