# [4-17] è„‘å¯å‘ä¸ªæ€§æ£€æµ‹ - ç²¾è¯»ç¬”è®°

> **è®ºæ–‡æ ‡é¢˜**: Hippd: Brain-Inspired Personality Detection
> **é˜…è¯»æ—¥æœŸ**: 2026å¹´2æœˆ10æ—¥
> **éš¾åº¦è¯„çº§**: â­â­â­ (ä¸­ç­‰)
> **é‡è¦æ€§**: â­â­â­ (ç¥ç»å¯å‘)

---

## ğŸ“‹ è®ºæ–‡åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|:---|:---|
| **æ ‡é¢˜** | Hippd: Brain-Inspired Personality Detection |
| **ä½œè€…** | Xiaohao Cai ç­‰äºº |
| **å‘è¡¨æœŸåˆŠ** | Neural Networks |
| **å‘è¡¨å¹´ä»½** | 2021 |
| **æ–‡ç« ç±»å‹** | å…¨æ–‡è®ºæ–‡ |
| **å…³é”®è¯** | Brain-Inspired, Hippocampus, Personality Detection, Neural Architecture |
| **å½±å“å› å­** | Neural Networks (2021) ~9.0 |

---

## ğŸ¯ ç ”ç©¶é—®é¢˜

### è„‘å¯å‘è®¡ç®—æŒ‘æˆ˜

**æ ¸å¿ƒé—®é¢˜**: å¦‚ä½•ä»æµ·é©¬ä½“ç»“æ„ä¸­è·å¾—å¯å‘è®¾è®¡ç¥ç»ç½‘ç»œ

**æµ·é©¬ä½“åŠŸèƒ½**:
```
æµ·é©¬ä½“ (Hippocampus):
â”œâ”€â”€ è®°å¿†å½¢æˆ
â”œâ”€â”€ ç©ºé—´å¯¼èˆª
â”œâ”€â”€ æ¨¡å¼åˆ†ç¦»
â””â”€â”€ æ¨¡å¼å®Œæˆ
```

---

## ğŸ”¬ æ–¹æ³•è®ºè¯¦è§£

### æ ¸å¿ƒç»„ä»¶: æµ·é©¬ä½“å¯å‘ç½‘ç»œ

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class HippocampalCell(nn.Module):
    """
    æµ·é©¬ä½“å¯å‘ç¥ç»å…ƒ

    æ¨¡æ‹ŸCA1/CA3åŒºåŸŸåŠŸèƒ½
    """
    def __init__(self, input_dim, hidden_dim):
        super().__init__()
        self.hidden_dim = hidden_dim

        # æ¨¡å¼åˆ†ç¦» (Pattern Separation)
        self.pattern_separation = nn.Sequential(
            nn.Linear(input_dim, hidden_dim * 2),
            nn.ReLU(),
            nn.Linear(hidden_dim * 2, hidden_dim)
        )

        # æ¨¡å¼å®Œæˆ (Pattern Completion)
        self.pattern_completion = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim * 2),
            nn.ReLU(),
            nn.Linear(hidden_dim * 2, hidden_dim)
        )

        # é—¨æ§æœºåˆ¶
        self.gate = nn.Linear(input_dim + hidden_dim, hidden_dim)

    def forward(self, x, prev_state=None):
        """
        å‰å‘ä¼ æ’­

        Args:
            x: è¾“å…¥
            prev_state: å‰ä¸€çŠ¶æ€
        """
        if prev_state is None:
            prev_state = torch.zeros(x.size(0), self.hidden_dim)

        # æ¨¡å¼åˆ†ç¦»
        separated = self.pattern_separation(x)

        # é—¨æ§
        gate_input = torch.cat([x, prev_state], dim=1)
        g = torch.sigmoid(self.gate(gate_input))

        # çŠ¶æ€æ›´æ–°
        new_state = g * separated + (1 - g) * prev_state

        # æ¨¡å¼å®Œæˆ
        output = self.pattern_completion(new_state)

        return output, new_state


class Hippd(nn.Module):
    """
    Hippd: è„‘å¯å‘ä¸ªæ€§æ£€æµ‹
    """
    def __init__(self, input_dim=512, hidden_dim=256, num_traits=5):
        super().__init__()

        # æµ·é©¬ä½“å±‚
        self.hippocampus = HippocampalCell(input_dim, hidden_dim)

        # çš®å±‚å¤„ç†
        self.cortex = nn.Sequential(
            nn.Linear(hidden_dim, 128),
            nn.ReLU(),
            nn.Dropout(0.3),
            nn.Linear(128, 64),
            nn.ReLU()
        )

        # ä¸ªæ€§è¾“å‡º
        self.personality = nn.Sequential(
            nn.Linear(64, num_traits),
            nn.Sigmoid()
        )

    def forward(self, features_sequence):
        """
        å¤„ç†åºåˆ—ç‰¹å¾

        Args:
            features_sequence: (B, T, D) æ—¶åºç‰¹å¾
        """
        batch_size, seq_len, _ = features_sequence.shape

        state = None
        for t in range(seq_len):
            output, state = self.hippocampus(features_sequence[:, t], state)

        # çš®å±‚å¤„ç†
        cortex_out = self.cortex(output)

        # ä¸ªæ€§é¢„æµ‹
        traits = self.personality(cortex_out)

        return traits
```

---

## ğŸ’¡ å¯¹è¿å»ºæ£€æµ‹çš„è¿ç§»

```python
class HippocampalChangeDetection(nn.Module):
    """
    æµ·é©¬ä½“å¯å‘å˜åŒ–æ£€æµ‹ - åŸºäº[4-17]æ€æƒ³

    åˆ©ç”¨æ—¶åºè®°å¿†æ£€æµ‹å˜åŒ–
    """
    def __init__(self, feature_dim=128):
        super().__init__()

        # æµ·é©¬ä½“è®°å¿†
        self.hippocampus = HippocampalCell(feature_dim, feature_dim)

        # å˜åŒ–æ£€æµ‹
        self.change_detector = nn.Sequential(
            nn.Linear(feature_dim * 2, 128),
            nn.ReLU(),
            nn.Linear(128, 1),
            nn.Sigmoid()
        )

    def forward(self, feature_sequence):
        """
        å¤„ç†æ—¶åºç‰¹å¾åºåˆ—

        Args:
            feature_sequence: å¤šæ—¶ç›¸ç‰¹å¾ [(B, D), ...]
        """
        states = []
        state = None

        for features in feature_sequence:
            output, state = self.hippocampus(features, state)
            states.append(output)

        return states

    def detect_change(self, feat_t1, feat_t2):
        """æ£€æµ‹ä¸¤æ—¶ç›¸é—´å˜åŒ–"""
        # ç¼–ç æ—¶åº
        states = self.forward([feat_t1, feat_t2])

        # æ¯”è¾ƒçŠ¶æ€
        combined = torch.cat([states[0], states[1]], dim=1)
        change_prob = self.change_detector(combined)

        return change_prob
```

---

**ç¬”è®°åˆ›å»ºæ—¶é—´**: 2026å¹´2æœˆ10æ—¥
**çŠ¶æ€**: å·²å®Œæˆç²¾è¯» âœ…
